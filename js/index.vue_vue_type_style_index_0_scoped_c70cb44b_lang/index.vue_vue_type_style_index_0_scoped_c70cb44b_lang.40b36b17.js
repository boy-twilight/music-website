import{m as e,A as o,B as a}from"../element-plus/element-plus.93eaa55f.js";import{G as s,ax as l,u as t,o as n,M as r,O as i,S as d,T as c,ay as p,az as u,a as g,d as m,i as f,e as h,R as v,U as w,a2 as b,I as C,c as y,P as S,V as M,aq as k}from"../@vue/@vue.7ad02ad1.js";import{u as x,a as I,_,a1 as z,j,a2 as H,y as L,a3 as B,h as A}from"../../static/index-5203d642.js";import{s as D}from"../pinia/pinia.07d51cb2.js";import{o as P}from"../vue-router/vue-router.53ff932e.js";const T=(e=>(p("data-v-8047c136"),e=e(),u(),e))((()=>g("span",{class:"iconfont"},"",-1))),q=_(s({__name:"index",props:{songs:null,name:{default:"播放全部"}},setup(o){l((e=>({"5bb2d8c8":t(s),"29cdf209":t(a)})));const{boxShadow:a,themeColor:s}=x(),{playAllMusic:p}=I();return(a,l)=>{const u=e;return n(),r(u,{onClick:l[0]||(l[0]=e=>t(p)(o.songs)),color:t(s),round:""},{icon:i((()=>[T])),default:i((()=>[d(c(o.name),1)])),_:1},8,["color"])}}}),[["__scopeId","data-v-8047c136"]]),G=["onMousedown","textContent"],R={key:0,class:"iconfont vip"},$=["onClick"],E=["onClick"],O=["onClick"],U=s({__name:"index",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},pageSize:{default:0}},setup(e,{expose:s}){const p=e;l((e=>({"6e7f6cbe":t(u),"53d4fae4":t(U),"5f5f8204":t(_),"9e0494b0":t(T),"6411a820":t(q)})));const{fontColor:u,background:_,fontGray:T,themeColor:q,tableHover:U,bgMode:V}=x(),F=z(),{songList:J,current:K,isPlay:N}=D(F),Q=j(),W=m(),X=f((()=>p.showSelect)),Y=f((()=>p.showSelect?55:0)),Z=()=>{W.value.clearSelection()};h(X,(e=>{e||Z()}));const ee=f((()=>p.sort?p.sort:[!1,!1,!1,!1])),oe=f((()=>p.isCancelSort)),ae=(e,o)=>e.name.localeCompare(o.name),se=(e,o)=>e.singer.localeCompare(o.singer),le=(e,o)=>e.album.localeCompare(o.album),te=(e,o)=>+e.time-+o.time;h(oe,(e=>{e&&W.value.clearSort()}));const ne=()=>document.querySelectorAll(`.operation${p.showHeader}`),re=e=>{let o=0;if(p.pageSize>0){const a=Math.floor(p.songIdMapper.get(e.id)/p.pageSize);o=p.songIdMapper.get(e.id)-a*p.pageSize}else o=p.songIdMapper.get(e.id);const a=ne()[o];a&&(a.style.opacity="1")},ie=e=>{let o=0;if(p.pageSize>0){const a=Math.floor(p.songIdMapper.get(e.id)/p.pageSize);o=p.songIdMapper.get(e.id)-a*p.pageSize}else o=p.songIdMapper.get(e.id);const a=ne()[o];a&&(a.style.opacity="0")},{playMusic:de}=I();let ce=0,pe=!1;const ue=()=>{if(pe)return pe=!1,clearTimeout(ce);ce=setTimeout((()=>{if(p.songs.length>0){const e=p.songs.findIndex((e=>e.id==J.value[K.value].id));A(p.songs,e)}ue()}),3e5)};return ue(),P((()=>{pe=!0})),s({clearSelect:Z,getSelectItems:()=>{var e;return null==(e=W.value)?void 0:e.getSelectionRows()}}),(s,l)=>{const p=a,u=k("prevent");return n(),r(t(o),{onCellDblclick:t(de),onCellMouseEnter:re,onCellMouseLeave:ie,data:e.songs,"max-height":e.height,"show-header":e.showHeader,ref_key:"tableContainer",ref:W,style:{width:"80vw"},class:C(["songs-table",{"skin-table":"skin"==t(V)}])},{default:i((()=>[t(X)?(n(),r(p,{key:0,type:"selection",width:t(Y)},null,8,["width"])):v("",!0),w(p,{sortable:t(ee)[0],"sort-method":ae,label:"歌曲",width:500-t(Y)},{default:i((o=>[g("div",null,[g("span",{onMousedown:b((e=>t(Q).addLove(o.row,t(Q).loveSongs,t(Q).loveMusicId)),["prevent"]),class:C(["iconfont love",{"is-love":o.row.isLove}]),textContent:c(o.row.isLove?"󰅅":"")},null,42,G),g("span",null,c(o.row.name),1),"1"==o.row.available||"10"==o.row.available?(n(),y("span",R,"")):v("",!0),S((n(),y("span",{class:"iconfont playmv",onClick:e=>{return a=o.row,void B(a,(()=>{}));var a}},[d("")],8,$)),[[u]]),g("div",{class:C(`operation-area operation${e.showHeader}`)},[S((n(),y("span",{onClick:e=>t(de)(o.row),class:"iconfont"},[d("")],8,E)),[[M,!t(N)||t(K)!=t(J).findIndex((e=>e.id==o.row.id))],[u]]),S((n(),y("span",{onClick:l[0]||(l[0]=e=>N.value=!1),class:"iconfont"},[d(" ")])),[[M,t(N)&&t(K)==t(J).findIndex((e=>e.id==o.row.id))],[u]]),S((n(),y("span",{class:"iconfont",onClick:e=>t(Q).addMuiscDownload(o.row)},[d("󰌄")],8,O)),[[u]]),w(t(H),{song:o.row,play:t(de)},null,8,["song","play"])],2)])])),_:1},8,["sortable","width"]),w(p,{sortable:t(ee)[1],"sort-method":se,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),w(p,{sortable:t(ee)[2],"sort-method":le,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),w(p,{sortable:t(ee)[3],"sort-method":te,label:"时长"},{default:i((e=>[g("span",null,c(t(L)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["onCellDblclick","data","max-height","show-header","class"])}}});export{q as P,U as _};
