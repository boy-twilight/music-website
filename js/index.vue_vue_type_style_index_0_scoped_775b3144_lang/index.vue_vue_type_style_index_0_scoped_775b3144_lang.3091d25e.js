import{m as e,z as a,A as o}from"../element-plus/element-plus.d1c0be0b.js";import{G as s,ax as l,u as t,o as n,M as i,O as r,S as d,T as c,ay as u,az as p,a as g,z as v,r as m,i as h,e as f,R as w,U as b,a2 as C,I as S,c as y,P as I,V as k,n as M,aq as _}from"../@vue/@vue.59fec093.js";import{s as x}from"../pinia/pinia.81428a33.js";import{g as z,u as L,j,k as H,_ as N,t as O,a as P,a2 as R,A as T,a3 as A,i as B}from"../../static/index-9031b76e.js";import{o as E}from"../vue-router/vue-router.10a7fca4.js";const F=(e=>(u("data-v-c2fd1c21"),e=e(),p(),e))((()=>g("span",{class:"iconfont"},"",-1))),q=N(s({__name:"index",props:{songs:null,name:{default:"播放全部"}},setup(a){const o=a;l((e=>({"4bb1e264":t(u),"4b184897":t(s)})));const s=z().get("shadow"),u=z().get("themeColor"),p=L(),{songList:g,current:v,songNum:m,songListId:h}=x(p),f=()=>{if(o.songs.length>0){const e=m.value;o.songs.forEach((e=>{null!=h.value.get(e.id)||"0"!=e.available&&"8"!=e.available||g.value.push(e)})),v.value=e,j(H.SUCCESS,"已经添加到播放列表")}else j(H.INFO,"请添加歌曲")};return(o,s)=>{const l=e;return n(),i(l,{onClick:f,color:t(u)},{default:r((()=>[F,d(c(a.name),1)])),_:1},8,["color"])}}}),[["__scopeId","data-v-c2fd1c21"]]),D=["onMousedown","textContent"],G={key:0,class:"iconfont vip"},U=["onClick"],$=["onClick"],V=["onClick"],J=s({__name:"index",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},pageSize:{default:0}},emits:["getSelectItems"],setup(e,{emit:s}){const u=e;l((e=>({"05e76949":t(F),"98bd2e9e":t(q),e9f6ae20:t(J),"20a30886":t(K),"238ec0c5":t(Q)})));const p=O(),{bgMode:N}=x(p),F=z().get("fontColor"),q=z().get("tableHover"),J=z().get("background"),K=v("fontGray"),Q=z().get("themeColor"),W=v("hideScroll"),X=L(),{songList:Y,current:Z,isPlay:ee,playProcess:ae,playTime:oe,songListId:se}=x(X),le=P(),te=m(),ne=h((()=>u.showSelect)),ie=h((()=>u.showSelect?55:0)),re=e=>{s("getSelectItems",e)};f(ne,(e=>{e||te.value.clearSelection()}));const de=h((()=>u.sort?u.sort:[!1,!1,!1,!1])),ce=h((()=>u.isCancelSort)),ue=(e,a)=>e.name.localeCompare(a.name),pe=(e,a)=>e.singer.localeCompare(a.singer),ge=(e,a)=>e.album.localeCompare(a.album),ve=(e,a)=>+e.time-+a.time;f(ce,(e=>{e&&te.value.clearSort()}));const me=()=>document.querySelectorAll(`.operation${u.showHeader}`),he=e=>{let a=0;if(u.pageSize>0){const o=Math.floor(u.songIdMapper.get(e.id)/u.pageSize);a=u.songIdMapper.get(e.id)-o*u.pageSize}else a=u.songIdMapper.get(e.id);const o=me()[a];o&&(o.style.opacity="1")},fe=e=>{let a=0;if(u.pageSize>0){const o=Math.floor(u.songIdMapper.get(e.id)/u.pageSize);a=u.songIdMapper.get(e.id)-o*u.pageSize}else a=u.songIdMapper.get(e.id);const o=me()[a];o&&(o.style.opacity="0")},we=async e=>{if("0"==e.available||"8"==e.available){const a=se.value.get(e.id);null==a?(le.addRecord(e,le.songRecord,le.songRecordId),0==Z.value?(ee&&(ee.value=!1),ae.value=0,oe.value=0,Y.value.unshift(e),await M(),ee.value=!0):(Y.value.unshift(e),Z.value=0)):Z.value!=a?Z.value=a:ee.value=!0}else"1"==e.available?j(H.INFO,"此歌曲为vip专属"):"10"==e.available&&j(H.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let be=0,Ce=!1;const Se=()=>{if(Ce)return Ce=!1,clearTimeout(be);be=setTimeout((()=>{if(u.songs.length>0){const e=u.songs.findIndex((e=>e.id==Y.value[Z.value].id));B(u.songs,e)}Se()}),3e5)};return Se(),E((()=>{Ce=!0})),(s,l)=>{const u=o,p=_("prevent");return n(),i(t(a),{onCellDblclick:we,onCellMouseEnter:he,onCellMouseLeave:fe,onSelectionChange:re,data:e.songs,"max-height":e.height,"show-header":e.showHeader,ref_key:"tableContainer",ref:te,style:{width:"80vw"},class:S(["songs-table",{"skin-table":"skin"==t(N)}])},{default:r((()=>[t(ne)?(n(),i(u,{key:0,type:"selection",width:t(ie)},null,8,["width"])):w("",!0),b(u,{sortable:t(de)[0],"sort-method":ue,label:"歌曲",width:500-t(ie)},{default:r((a=>[g("div",null,[g("span",{onMousedown:C((e=>t(le).addLove(a.row,t(le).loveSongs,t(le).loveMusicId)),["prevent"]),class:S(["iconfont love",{"is-love":a.row.isLove}]),textContent:c(a.row.isLove?"󰅅":"")},null,42,D),g("span",null,c(a.row.name),1),"1"==a.row.available||"10"==a.row.available?(n(),y("span",G,"")):w("",!0),I((n(),y("span",{class:"iconfont playmv",onClick:e=>{return o=a.row,void A(o,(()=>{W()}));var o}},[d("")],8,U)),[[p]]),g("div",{class:S(`operation-area operation${e.showHeader}`)},[I((n(),y("span",{onClick:e=>we(a.row),class:"iconfont"},[d("")],8,$)),[[k,!t(ee)||t(Z)!=t(Y).findIndex((e=>e.id==a.row.id))],[p]]),I((n(),y("span",{onClick:l[0]||(l[0]=e=>ee.value=!1),class:"iconfont"},[d(" ")])),[[k,t(ee)&&t(Z)==t(Y).findIndex((e=>e.id==a.row.id))],[p]]),I((n(),y("span",{class:"iconfont",onClick:e=>t(le).addMuiscDownload(a.row)},[d("󰌄")],8,V)),[[p]]),b(t(R),{song:a.row,play:we},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),b(u,{sortable:t(de)[1],"sort-method":pe,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),b(u,{sortable:t(de)[2],"sort-method":ge,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),b(u,{sortable:t(de)[3],"sort-method":ve,label:"时长"},{default:r((e=>[g("span",null,c(t(T)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header","class"])}}});export{q as P,J as _};
