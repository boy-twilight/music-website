import{m as e,A as a,B as o}from"../element-plus/element-plus.79622da4.js";import{G as s,ax as l,u as t,o as n,M as i,O as r,S as c,T as d,ay as u,az as p,a as v,d as m,i as f,e as g,R as h,U as w,a2 as b,I as C,c as y,P as S,V as k,aq as x}from"../@vue/@vue.7ad02ad1.js";import{u as M,a as _,_ as z,a4 as I,h as j,a5 as B,w as H,a6 as L,f as A}from"../../static/index-3843a64e.js";import{s as D}from"../pinia/pinia.07d51cb2.js";import{o as P}from"../vue-router/vue-router.53ff932e.js";const T=(e=>(u("data-v-0f17246b"),e=e(),p(),e))((()=>v("span",{class:"iconfont"},"",-1))),q=z(s({__name:"index",props:{songs:null,name:{default:"播放全部"}},setup(a){l((e=>({"4b2fe29a":t(s),"56ffcb4b":t(o)})));const{boxShadow:o,themeColor:s}=M(),{playAllMusic:u}=_();return(o,l)=>{const p=e;return n(),i(p,{onClick:l[0]||(l[0]=e=>t(u)(a.songs)),color:t(s),round:""},{icon:r((()=>[T])),default:r((()=>[c(d(a.name),1)])),_:1},8,["color"])}}}),[["__scopeId","data-v-0f17246b"]]),G=["onMousedown","textContent"],R={key:0,class:"iconfont vip"},$=["onClick"],E=["onClick"],O=["onClick"],U=s({__name:"index",props:{songs:null,height:null,sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},pageSize:{default:0}},setup(e,{expose:s}){const u=e;l((e=>({"0e241b54":t(p),"1737284c":t(U),"22c1af6c":t(z),"525c1d10":t(T),dd4d4d50:t(q)})));const{fontColor:p,background:z,fontGray:T,themeColor:q,tableHover:U,bgMode:V}=M(),F=I(),{songList:J,current:K,isPlay:N}=D(F),Q=j(),W=m(),X=f((()=>new Map(u.songs.map(((e,a)=>[e.id,a]))))),Y=m(!1),Z=f((()=>Y.value?55:0)),ee=()=>{W.value.clearSelection()},ae=f((()=>u.sort?u.sort:[!1,!1,!1,!1])),oe=f((()=>u.isCancelSort)),se=(e,a)=>e.name.localeCompare(a.name),le=(e,a)=>e.singer.localeCompare(a.singer),te=(e,a)=>e.album.localeCompare(a.album),ne=(e,a)=>+e.time-+a.time;g(oe,(e=>{e&&W.value.clearSort()}));const ie=()=>document.querySelectorAll(`.operation${u.showHeader}`),re=e=>{let a=0;if(u.pageSize>0){const o=Math.floor(X.value.get(e.id)/u.pageSize);a=X.value.get(e.id)-o*u.pageSize}else a=X.value.get(e.id);const o=ie()[a];o&&(o.style.opacity="1")},ce=e=>{let a=0;if(u.pageSize>0){const o=Math.floor(X.value.get(e.id)/u.pageSize);a=X.value.get(e.id)-o*u.pageSize}else a=X.value.get(e.id);const o=ie()[a];o&&(o.style.opacity="0")},{playMusic:de}=_();let ue=0,pe=!1;const ve=()=>{if(pe)return pe=!1,clearTimeout(ue);ue=setTimeout((()=>{if(u.songs.length>0){const e=u.songs.findIndex((e=>e.id==J.value[K.value].id));A(u.songs,e)}ve()}),3e5)};return ve(),P((()=>{pe=!0})),s({clearSelect:ee,getSelectItems:()=>{var e;return null==(e=W.value)?void 0:e.getSelectionRows()},openSelectBox:()=>{Y.value=!0},closeSelectBox:()=>{Y.value=!1,ee()}}),(s,l)=>{const u=o,p=x("prevent");return n(),i(t(a),{onCellDblclick:t(de),onCellMouseEnter:re,onCellMouseLeave:ce,data:e.songs,"max-height":e.height,"show-header":e.showHeader,ref_key:"tableContainer",ref:W,style:{width:"80vw"},class:C(["songs-table",{"skin-table":"skin"==t(V)}])},{default:r((()=>[Y.value?(n(),i(u,{key:0,type:"selection",width:t(Z)},null,8,["width"])):h("",!0),w(u,{sortable:t(ae)[0],"sort-method":se,label:"歌曲",width:500-t(Z)},{default:r((a=>[v("div",null,[v("span",{onMousedown:b((e=>t(Q).addLove(a.row,t(Q).loveSongs,t(Q).loveMusicId)),["prevent"]),class:C(["iconfont love",{"is-love":a.row.isLove}]),textContent:d(a.row.isLove?"󰅅":"")},null,42,G),v("span",null,d(a.row.name),1),"1"==a.row.available||"10"==a.row.available?(n(),y("span",R,"")):h("",!0),S((n(),y("span",{class:"iconfont playmv",onClick:e=>{return o=a.row,void L(o);var o}},[c("")],8,$)),[[p]]),v("div",{class:C(`operation-area operation${e.showHeader}`)},[S((n(),y("span",{onClick:e=>t(de)(a.row),class:"iconfont"},[c("")],8,E)),[[k,!t(N)||t(K)!=t(J).findIndex((e=>e.id==a.row.id))],[p]]),S((n(),y("span",{onClick:l[0]||(l[0]=e=>N.value=!1),class:"iconfont"},[c(" ")])),[[k,t(N)&&t(K)==t(J).findIndex((e=>e.id==a.row.id))],[p]]),S((n(),y("span",{class:"iconfont",onClick:e=>t(Q).addMuiscDownload(a.row)},[c("󰌄")],8,O)),[[p]]),w(t(B),{song:a.row,play:t(de)},null,8,["song","play"])],2)])])),_:1},8,["sortable","width"]),w(u,{sortable:t(ae)[1],"sort-method":le,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),w(u,{sortable:t(ae)[2],"sort-method":te,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),w(u,{sortable:t(ae)[3],"sort-method":ne,label:"时长"},{default:r((e=>[v("span",null,d(t(H)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["onCellDblclick","data","max-height","show-header","class"])}}});export{q as P,U as _};
