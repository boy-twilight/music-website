import{g as e,u as o,e as t,c as a,_ as n,t as l,a as u,a2 as s,x as r,a3 as i,k as c}from"../../static/index-a47c3a7a.js";const d=(e=>(Vue.pushScopeId("data-v-5946d337"),e=e(),Vue.popScopeId(),e))((()=>Vue.createElementVNode("span",{class:"iconfont"},"",-1))),V=n(Vue.defineComponent({__name:"index",props:{songs:null,name:{default:"播放全部"}},setup(n){const l=n;Vue.useCssVars((e=>({"5456da69":Vue.unref(s),"36431d9c":Vue.unref(u)})));const u=e().get("shadow"),s=e().get("themeColor"),r=o(),{songList:i,current:c,songNum:V,songListId:p}=Pinia.storeToRefs(r),f=()=>{if(l.songs.length>0){const e=V.value;l.songs.forEach((e=>{null!=p.value.get(e.id)||"0"!=e.available&&"8"!=e.available||i.value.push(e)})),c.value=e,t(a.SUCCESS,"已经添加到播放列表")}else t(a.INFO,"请添加歌曲")};return(e,o)=>{const t=Vue.resolveComponent("el-button");return Vue.openBlock(),Vue.createBlock(t,{onClick:f,color:Vue.unref(s)},{default:Vue.withCtx((()=>[d,Vue.createTextVNode(Vue.toDisplayString(n.name),1)])),_:1},8,["color"])}}}),[["__scopeId","data-v-5946d337"]]),p=["onMousedown","textContent"],f={key:0,class:"iconfont vip"},g=["onClick"],v=["onClick"],m=["onClick"],h=Vue.defineComponent({__name:"index",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},pageSize:{default:0}},emits:["getSelectItems"],setup(n,{emit:d}){const V=n;Vue.useCssVars((e=>({"318da72a":Vue.unref(C),"39e881dc":Vue.unref(b),"06cbd62f":Vue.unref(k),"916f0488":Vue.unref(S),"6cb03f04":Vue.unref(y)})));const h=l(),{bgMode:w}=Pinia.storeToRefs(h),C=e().get("fontColor"),b=e().get("tableHover"),k=e().get("background"),S=Vue.inject("fontGray"),y=e().get("themeColor"),I=Vue.inject("hideScroll"),x=o(),{songList:N,current:B,isPlay:M,playProcess:E,playTime:_,songListId:D}=Pinia.storeToRefs(x),T=u(),z=Vue.ref(),L=Vue.computed((()=>V.showSelect)),R=Vue.computed((()=>V.showSelect?55:0)),P=e=>{d("getSelectItems",e)};Vue.watch(L,(e=>{e||z.value.clearSelection()}));const H=Vue.computed((()=>V.sort?V.sort:[!1,!1,!1,!1])),j=Vue.computed((()=>V.isCancelSort)),F=(e,o)=>e.name.localeCompare(o.name),O=(e,o)=>e.singer.localeCompare(o.singer),$=(e,o)=>e.album.localeCompare(o.album),q=(e,o)=>+e.time-+o.time;Vue.watch(j,(e=>{e&&z.value.clearSort()}));const A=()=>document.querySelectorAll(`.operation${V.showHeader}`),G=e=>{let o=0;if(V.pageSize>0){const t=Math.floor(V.songIdMapper.get(e.id)/V.pageSize);o=V.songIdMapper.get(e.id)-t*V.pageSize}else o=V.songIdMapper.get(e.id);const t=A()[o];t&&(t.style.opacity="1")},U=e=>{let o=0;if(V.pageSize>0){const t=Math.floor(V.songIdMapper.get(e.id)/V.pageSize);o=V.songIdMapper.get(e.id)-t*V.pageSize}else o=V.songIdMapper.get(e.id);const t=A()[o];t&&(t.style.opacity="0")},J=async e=>{if("0"==e.available||"8"==e.available){const o=D.value.get(e.id);null==o?(T.addRecord(e,T.songRecord,T.songRecordId),0==B.value?(M&&(M.value=!1),E.value=0,_.value=0,N.value.unshift(e),await Vue.nextTick(),M.value=!0):(N.value.unshift(e),B.value=0)):B.value!=o?B.value=o:M.value=!0}else"1"==e.available?t(a.INFO,"此歌曲为vip专属"):"10"==e.available&&t(a.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")};let K=0;return K=setInterval((()=>{if(V.songs.length>0){const e=V.songs.map((e=>e.id)),o=V.songs.findIndex((e=>e.id==N.value[B.value].id));e.length>0&&c(e.join(","),V.songs,"",o)}}),3e5),VueRouter.onBeforeRouteLeave((()=>{clearInterval(K)})),(e,o)=>{const t=Vue.resolveComponent("el-table-column"),a=Vue.resolveDirective("prevent");return Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElTable),{onCellDblclick:J,onCellMouseEnter:G,onCellMouseLeave:U,onSelectionChange:P,data:n.songs,"max-height":n.height,"show-header":n.showHeader,ref_key:"tableContainer",ref:z,style:{width:"80vw"},class:Vue.normalizeClass(["songs-table",{"skin-table":"skin"==Vue.unref(w)}])},{default:Vue.withCtx((()=>[Vue.unref(L)?(Vue.openBlock(),Vue.createBlock(t,{key:0,type:"selection",width:Vue.unref(R)},null,8,["width"])):Vue.createCommentVNode("",!0),Vue.createVNode(t,{sortable:Vue.unref(H)[0],"sort-method":F,label:"歌曲",width:500-Vue.unref(R)},{default:Vue.withCtx((e=>[Vue.createElementVNode("div",null,[Vue.createElementVNode("span",{onMousedown:Vue.withModifiers((o=>Vue.unref(T).addLove(e.row,Vue.unref(T).loveSongs,Vue.unref(T).loveMusicId)),["prevent"]),class:Vue.normalizeClass(["iconfont love",{"is-love":e.row.isLove}]),textContent:Vue.toDisplayString(e.row.isLove?"󰅅":"")},null,42,p),Vue.createElementVNode("span",null,Vue.toDisplayString(e.row.name),1),"1"==e.row.available||"10"==e.row.available?(Vue.openBlock(),Vue.createElementBlock("span",f,"")):Vue.createCommentVNode("",!0),Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{class:"iconfont playmv",onClick:o=>{return t=e.row,void i(t,(()=>{I()}));var t}},[Vue.createTextVNode("")],8,g)),[[a]]),Vue.createElementVNode("div",{class:Vue.normalizeClass(`operation-area operation${n.showHeader}`)},[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{onClick:o=>J(e.row),class:"iconfont"},[Vue.createTextVNode("")],8,v)),[[Vue.vShow,!Vue.unref(M)||Vue.unref(B)!=Vue.unref(N).findIndex((o=>o.id==e.row.id))],[a]]),Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{onClick:o[0]||(o[0]=e=>M.value=!1),class:"iconfont"},[Vue.createTextVNode(" ")])),[[Vue.vShow,Vue.unref(M)&&Vue.unref(B)==Vue.unref(N).findIndex((o=>o.id==e.row.id))],[a]]),Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{class:"iconfont",onClick:o=>Vue.unref(T).addMuiscDownload(e.row)},[Vue.createTextVNode("󰌄")],8,m)),[[a]]),Vue.createVNode(Vue.unref(s),{song:e.row,play:J},null,8,["song"])],2)])])),_:1},8,["sortable","width"]),Vue.createVNode(t,{sortable:Vue.unref(H)[1],"sort-method":O,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),Vue.createVNode(t,{sortable:Vue.unref(H)[2],"sort-method":$,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),Vue.createVNode(t,{sortable:Vue.unref(H)[3],"sort-method":q,label:"时长"},{default:Vue.withCtx((e=>[Vue.createElementVNode("span",null,Vue.toDisplayString(Vue.unref(r)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["data","max-height","show-header","class"])}}});export{V as P,h as _};
