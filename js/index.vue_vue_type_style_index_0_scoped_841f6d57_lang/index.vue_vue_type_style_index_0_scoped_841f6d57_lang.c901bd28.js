import{m as e,z as o,A as a}from"../element-plus/element-plus.70abbed3.js";import{G as s,ax as l,u as t,o as n,M as r,O as i,S as c,T as d,ay as p,az as u,a as g,d as m,i as f,e as h,R as v,U as w,a2 as b,I as C,c as S,P as y,V as M,z as k,aq as x}from"../@vue/@vue.7ad02ad1.js";import{u as I,a as _,_ as z,a2 as j,j as H,a3 as L,z as A,a4 as B,h as D}from"../../static/index-487e9f37.js";import{s as P}from"../pinia/pinia.07d51cb2.js";import{o as T}from"../vue-router/vue-router.53ff932e.js";const q=(e=>(p("data-v-5d7e5644"),e=e(),u(),e))((()=>g("span",{class:"iconfont"},"",-1))),G=z(s({__name:"index",props:{songs:null,name:{default:"播放全部"}},setup(o){l((e=>({bc9c46e4:t(s),b7c67a52:t(a)})));const{boxShadow:a,themeColor:s}=I(),{playAllMusic:p}=_();return(a,l)=>{const u=e;return n(),r(u,{onClick:l[0]||(l[0]=e=>t(p)(o.songs)),color:t(s),round:""},{icon:i((()=>[q])),default:i((()=>[c(d(o.name),1)])),_:1},8,["color"])}}}),[["__scopeId","data-v-5d7e5644"]]),R=["onMousedown","textContent"],$={key:0,class:"iconfont vip"},E=["onClick"],O=["onClick"],U=["onClick"],V=s({__name:"index",props:{songs:null,songIdMapper:null,height:null,showSelect:{type:Boolean},sort:{default:void 0},isCancelSort:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},pageSize:{default:0}},setup(e,{expose:s}){const p=e;l((e=>({"2f0cc297":t(u),b61b3faa:t(V),"9f06316a":t(z),a21c7ea2:t(q),"1f149137":t(G)})));const{fontColor:u,background:z,fontGray:q,themeColor:G,tableHover:V,bgMode:F}=I(),J=k("hideScrollbar"),K=j(),{songList:N,current:Q,isPlay:W}=P(K),X=H(),Y=m(),Z=f((()=>p.showSelect)),ee=f((()=>p.showSelect?55:0)),oe=()=>{Y.value.clearSelection()};h(Z,(e=>{e||oe()}));const ae=f((()=>p.sort?p.sort:[!1,!1,!1,!1])),se=f((()=>p.isCancelSort)),le=(e,o)=>e.name.localeCompare(o.name),te=(e,o)=>e.singer.localeCompare(o.singer),ne=(e,o)=>e.album.localeCompare(o.album),re=(e,o)=>+e.time-+o.time;h(se,(e=>{e&&Y.value.clearSort()}));const ie=()=>document.querySelectorAll(`.operation${p.showHeader}`),ce=e=>{let o=0;if(p.pageSize>0){const a=Math.floor(p.songIdMapper.get(e.id)/p.pageSize);o=p.songIdMapper.get(e.id)-a*p.pageSize}else o=p.songIdMapper.get(e.id);const a=ie()[o];a&&(a.style.opacity="1")},de=e=>{let o=0;if(p.pageSize>0){const a=Math.floor(p.songIdMapper.get(e.id)/p.pageSize);o=p.songIdMapper.get(e.id)-a*p.pageSize}else o=p.songIdMapper.get(e.id);const a=ie()[o];a&&(a.style.opacity="0")},{playMusic:pe}=_();let ue=0,ge=!1;const me=()=>{if(ge)return ge=!1,clearTimeout(ue);ue=setTimeout((()=>{if(p.songs.length>0){const e=p.songs.findIndex((e=>e.id==N.value[Q.value].id));D(p.songs,e)}me()}),3e5)};return me(),T((()=>{ge=!0})),s({clearSelect:oe,getSelectItems:()=>{var e;return null==(e=Y.value)?void 0:e.getSelectionRows()}}),(s,l)=>{const p=a,u=x("prevent");return n(),r(t(o),{onCellDblclick:t(pe),onCellMouseEnter:ce,onCellMouseLeave:de,data:e.songs,"max-height":e.height,"show-header":e.showHeader,ref_key:"tableContainer",ref:Y,style:{width:"80vw"},class:C(["songs-table",{"skin-table":"skin"==t(F)}])},{default:i((()=>[t(Z)?(n(),r(p,{key:0,type:"selection",width:t(ee)},null,8,["width"])):v("",!0),w(p,{sortable:t(ae)[0],"sort-method":le,label:"歌曲",width:500-t(ee)},{default:i((o=>[g("div",null,[g("span",{onMousedown:b((e=>t(X).addLove(o.row,t(X).loveSongs,t(X).loveMusicId)),["prevent"]),class:C(["iconfont love",{"is-love":o.row.isLove}]),textContent:d(o.row.isLove?"󰅅":"")},null,42,R),g("span",null,d(o.row.name),1),"1"==o.row.available||"10"==o.row.available?(n(),S("span",$,"")):v("",!0),y((n(),S("span",{class:"iconfont playmv",onClick:e=>{return a=o.row,void B(a,(()=>{J()}));var a}},[c("")],8,E)),[[u]]),g("div",{class:C(`operation-area operation${e.showHeader}`)},[y((n(),S("span",{onClick:e=>t(pe)(o.row),class:"iconfont"},[c("")],8,O)),[[M,!t(W)||t(Q)!=t(N).findIndex((e=>e.id==o.row.id))],[u]]),y((n(),S("span",{onClick:l[0]||(l[0]=e=>W.value=!1),class:"iconfont"},[c(" ")])),[[M,t(W)&&t(Q)==t(N).findIndex((e=>e.id==o.row.id))],[u]]),y((n(),S("span",{class:"iconfont",onClick:e=>t(X).addMuiscDownload(o.row)},[c("󰌄")],8,U)),[[u]]),w(t(L),{song:o.row,play:t(pe)},null,8,["song","play"])],2)])])),_:1},8,["sortable","width"]),w(p,{sortable:t(ae)[1],"sort-method":te,prop:"singer",label:"歌手",width:"320"},null,8,["sortable"]),w(p,{sortable:t(ae)[2],"sort-method":ne,prop:"album",label:"专辑",width:"320"},null,8,["sortable"]),w(p,{sortable:t(ae)[3],"sort-method":re,label:"时长"},{default:i((e=>[g("span",null,d(t(A)(e.row.time)),1)])),_:1},8,["sortable"])])),_:1},8,["onCellDblclick","data","max-height","show-header","class"])}}});export{G as P,V as _};
