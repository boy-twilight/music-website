import{x as e,y as a}from"../element-plus/element-plus.79622da4.js";import{G as s,ax as l,d as i,Z as n,i as t,M as o,O as r,u as c,o as u,a as m,P as p,V as d,U as g,T as v,a2 as y,c as h,a7 as f,S as _,F as x,z as j,ag as b,aq as w}from"../@vue/@vue.7ad02ad1.js";import{b as C,u as k}from"../vue-router/vue-router.53ff932e.js";import{s as R}from"../pinia/pinia.07d51cb2.js";import{u as z,h as E,a as L,q as S,r as U,e as M,f as O,m as I,M as P,s as N,C as T,P as q,t as A,v as B,o as G,w as V,O as F,L as H,x as D,p as J,_ as K}from"../../static/index-df8f8390.js";import{P as W,_ as Z}from"../index.vue_vue_type_style_index_0_scoped_b3813f91_lang/index.vue_vue_type_style_index_0_scoped_b3813f91_lang.06fd6738.js";import{O as Q}from"../index/index.1e8871f5.js";import{A as X}from"../index/index.9674b0c7.js";import{A as Y}from"../index/index.dac636a2.js";import{S as $}from"../index/index.abdb7b1a.js";import{A as ee}from"../index/index.357c36c4.js";import{L as ae}from"../index/index.7d359e22.js";import{N as se}from"../index/index.a485fac7.js";import{T as le}from"../index/index.8d34a85f.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";/* empty css                                                                                                                     *//* empty css                                                                                                                     */const ie={class:"search-container scroll-container"},ne=["src"],te={class:"right-singer"},oe={class:"singer-name"},re={class:"singer-info"},ce={class:"song"},ue={class:"header-operation"},me={class:"lyric-container"},pe={class:"lyric-operation"},de=["onClick"],ge=["onClick"],ve=["onClick"],ye=["onClick"],he=["onClick"],fe={class:"lyric-left"},_e={class:"song-name"},xe={class:"is-vip iconfont"},je={class:"lyric-center"},be={class:"lyric-right"},we=K(s({__name:"SearchView",setup(s){l((e=>({"743278b0":c(K),d1f16610:c(ke),"11e30ab6":c(we),c8fac5a6:c(Ce),"7c92ca3f":c(Re),"1c625875":c(ze)})));const{fontGray:K,fontColor:we,boxShadow:Ce,themeColor:ke,singerBg:Re,buttonBg:ze,contentHeight:Ee}=z(),Le=k(),Se=E(),{loveMusicId:Ue,loveSongs:Me}=R(Se),Oe=C().query.keyWord+"",Ie=i("song"),Pe=n([]),Ne=n([]),Te=n([]),qe=n([]),Ae=n([]),Be=n([]),Ge=n([]),Ve=t((()=>Ge.length>0?Ge[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Fe=n([]),He=t((()=>new Map(Fe.map(((e,a)=>[e.id,a]))))),De=i(!1),Je=j("firstLoading"),Ke=n(new Map([["video",!1],["mv",!1],["album",!1],["radio",!1],["playList",!1],["lyric",!1],["singer",!1]])),We=n([]),Ze=i(!1),Qe=i(),Xe=i(1),Ye=t((()=>"song"==Ie.value?F:H)),$e=t((()=>"song"==Ie.value?Pe:Fe)),ea=t((()=>$e.value.slice((Xe.value-1)*Ye.value,Xe.value*Ye.value))),aa=t((()=>"song"==Ie.value?Pe.length:Fe.length)),sa=()=>{Pe.forEach((e=>{e.isLove=!0;null==Ue.value.get(e.id)&&Me.value.push(e)}))},{playMusic:la}=L(),ia=async e=>{if(Ie.value=e,"video"==e){if(0!=Ne.length)return;De.value=!0;try{const e=await S(1014,100,Oe),{result:{videos:a}}=e;a&&a.length>0?a.forEach((e=>{const{vid:a,title:s,coverUrl:l,creator:i,playTime:n}=e;Ne.push({id:a,name:s,image:l,artist:i[0].userName,playCount:n})})):Ke.set("video",!0)}catch(a){I(P.ERROR,a.message)}}else if("mv"==e){if(0!=Te.length)return;De.value=!0;try{const e=await S(1004,100,Oe),{result:{mvs:a}}=e;a&&0!=a.length?a.forEach((e=>{const{id:a,name:s,cover:l,artistName:i,playCount:n}=e;Te.push({id:a,name:s,image:l,artist:i,playCount:n})})):Ke.set("mv",!0)}catch(a){I(P.ERROR,a.message)}}else if("album"==e){if(0!=qe.length)return;De.value=!0;try{const e=await S(10,60,Oe),{result:{albums:a}}=e;a&&a.length>0?a.forEach((e=>{const{id:a,name:s,picUrl:l,publishTime:i,artist:n}=e;qe.push({id:a,name:s,cover:l,publishTime:D(i),artistId:n.id})})):Ke.set("album",!0)}catch(a){I(P.ERROR,a.message)}}else if("radio"==e){if(0!=Be.length)return;De.value=!0;try{const e=await S(1009,100,Oe),{result:{djRadios:a}}=e;a&&a.length>0?a.forEach((e=>{const{id:a,name:s,picUrl:l,playCount:i}=e;Be.push({name:s,id:a,image:l,playCount:i,creator:{nickname:"",avatarUrl:""},tag:[],description:""})})):Ke.set("radio",!0)}catch(a){I(P.ERROR,a.message)}}else if("playList"==e){if(0!=Ae.length)return;De.value=!0;try{const e=await S(1e3,100,Oe),{result:{playlists:a}}=e;a&&a.length>0?a.forEach((e=>{const{id:a,name:s,coverImgUrl:l,playCount:i}=e;Ae.push({id:a,name:s,image:l,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})})):Ke.set("playList",!0)}catch(a){I(P.ERROR,a.message)}}else if("lyric"==e){if(0!=Fe.length)return;De.value=!0;try{const e=await S(1006,100,Oe),{result:{songs:a}}=e;if(a&&a.length>0){const e=a.map((e=>e.id)).join(","),s=await U(e),{songs:l}=s;l.forEach((e=>{We.push(3),M(Fe,e)})),a.forEach(((e,a)=>{const{lyrics:{txt:s}}=e;Fe[a].lyric=s.split("\n")})),O(Fe),Se.initLoveMusic(Pe)}else Ke.set("lyric",!0)}catch(a){I(P.ERROR,a.message)}}De.value=!1};return(async()=>{Je.value=!0;try{(await Promise.all([S(1,100,Oe),S(100,100,Oe)])).forEach((async(e,a)=>{if(0==a){const{result:{songs:a}}=e;if(a&&a.length>0){const e=a.map((e=>e.id)).join(","),s=await U(e),{songs:l}=s;l.forEach((e=>{M(Pe,e)})),O(Pe),Se.initLoveMusic(Pe)}}else if(1==a){const{result:{artists:a}}=e;if(a&&a.length>0){const e=a.map((e=>{const{id:a,name:s,picUrl:l,accountId:i,albumSize:n,mvSize:t}=e;return{id:a,name:s,avatar:l,score:i,albumSize:n,mvSize:t}}));Ge.push(...e)}else Ke.set("singer",!0)}}))}catch(e){I(P.ERROR,e.message)}await N(J),Je.value=!1})(),(s,l)=>{const i=a,n=b("No"),t=e,j=w("prevent");return u(),o(t,{"max-height":c(Ee)},{default:r((()=>[m("div",ie,[p(g(c(Q),{songs:c(ea),"show-select":Ze.value,"onUpdate:showSelect":l[0]||(l[0]=e=>Ze.value=e),ref_key:"batch",ref:Qe},null,8,["songs","show-select"]),[[d,Ze.value]]),p(m("div",{class:"result-singer",onClick:l[2]||(l[2]=e=>c(Le).push({name:"artist",query:{id:c(Ve).id,score:c(Ve).score}}))},[m("img",{src:c(Ve).avatar,class:"left-singer"},null,8,ne),m("div",te,[m("h4",oe,"歌手："+v(c(Ve).name),1),m("p",re,[m("span",null,"专辑："+v(c(Ve).albumSize),1),m("span",null,"视频："+v(c(Ve).mvSize),1)])]),g(c(T),{name:c(Ve).isLove?"取消关注":"关注歌手",icon:c(Ve).isLove?"":"","icon-style":c(Ve).isLove?"color:#ff6a6a;":"",onClick:l[1]||(l[1]=y((e=>c(Se).addLove(c(Ve),c(Se).loveSinger,c(Se).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[d,c(Ve).name&&!Ze.value]]),p(g(c(le),{onGetActive:ia,active:"song",class:"search-tab"},{content:r((()=>[g(i,{label:"歌曲",name:"song"},{default:r((()=>[m("div",ce,[m("div",ue,[g(c(W),{songs:c(ea)},null,8,["songs"]),g(c(T),{icon:"",onClick:sa,name:"全部收藏"}),g(c(T),{icon:"",name:"批量操作",onClick:l[3]||(l[3]=e=>{var a;return null==(a=Qe.value)?void 0:a.openSelectBox()})})]),g(c(Z),{songs:c(ea),"page-size":c(Ye)},null,8,["songs","page-size"]),p(g(c(q),{"cur-page":Xe.value,"onUpdate:curPage":l[4]||(l[4]=e=>Xe.value=e),"page-size":c(Ye),total:c(aa)},null,8,["cur-page","page-size","total"]),[[d,c(Ye)<c(aa)]])])])),_:1}),g(i,{label:"视频",name:"video"},{default:r((()=>[g(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(g(c(se),{text:"暂无搜索结果"},null,512),[[d,Ke.get("video")]]),p(g(c(ee),{mvs:Ne,"show-pagination":!0},null,8,["mvs"]),[[d,!Ke.get("video")]])])),_:1}),g(i,{label:"MV",name:"mv"},{default:r((()=>[g(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(g(n,{text:"暂无搜索结果"},null,512),[[d,Ke.get("mv")]]),p(g(c(ee),{mvs:Te,"show-pagination":!0},null,8,["mvs"]),[[d,!Ke.get("mv")]])])),_:1}),g(i,{label:"专辑",name:"album"},{default:r((()=>[g(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(g(c(se),{text:"暂无搜索结果"},null,512),[[d,Ke.get("album")]]),p(g(c(X),{albums:qe,"show-pagination":!0},null,8,["albums"]),[[d,!Ke.get("album")]])])),_:1}),g(i,{label:"电台",name:"radio"},{default:r((()=>[g(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(g(c(se),{text:"暂无搜索结果"},null,512),[[d,Ke.get("radio")]]),p(g(c(Y),{playlists:Be,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[d,!Ke.get("radio")]])])),_:1}),g(i,{label:"歌单",name:"playList"},{default:r((()=>[g(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(g(c(se),{text:"暂无搜索结果"},null,512),[[d,Ke.get("playList")]]),p(g(c(Y),{playlists:Ae,"show-pagination":!0},null,8,["playlists"]),[[d,!Ke.get("playList")]])])),_:1}),g(i,{label:"歌手",name:"singer"},{default:r((()=>[g(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(g(c(se),{text:"暂无搜索结果"},null,512),[[d,Ke.get("singer")]]),p(g(c($),{"singer-list":Ge},null,8,["singer-list"]),[[d,!Ke.get("singer")]])])),_:1}),g(i,{label:"歌词",name:"lyric"},{default:r((()=>[g(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(g(c(se),{text:"暂无搜索结果"},null,512),[[d,Ke.get("lyric")]]),p(m("div",me,[(u(!0),h(x,null,f(c(ea),(e=>{var a;return u(),h("div",{class:"lyric",key:e.id},[m("div",pe,[p((u(),h("span",{class:"iconfont play-music",onClick:a=>c(la)(e)},[_("")],8,de)),[[j]]),p((u(),h("span",{class:"iconfont music-info",onClick:a=>c(A)(e)},[_("")],8,ge)),[[j]]),p((u(),h("span",{class:"iconfont",onClick:a=>c(B)(e)},[_("")],8,ve)),[[j]]),p((u(),h("span",{class:"open-lyric",onClick:a=>{return s=c(He).get(e.id),void(We[s]=We[s]==Fe[s].lyric.length?3:Fe[s].lyric.length);var s}},[_(v(We[c(He).get(e.id)]==(null==(a=e.lyric)?void 0:a.length)?"收起歌词":"展开歌词"),1)],8,ye)),[[j]]),p((u(),h("span",{class:"copy-lyric",onClick:a=>c(G)(e.name+"\r\n"+e.lyric.join("\r\n"),"歌词复制成功！")},[_("复制歌词")],8,he)),[[j]])]),m("div",fe,[m("p",_e,[m("span",null,v(e.name),1),p(m("span",xe,"",512),[[d,"10"==e.available||"1"==e.available]])]),(u(!0),h(x,null,f(e.lyric,((a,s)=>p((u(),h("p",{key:s},v(a.trim()),1)),[[d,s<We[c(He).get(e.id)]]]))),128))]),m("div",je,[m("span",null,v(e.singer),1)]),m("div",be,[m("span",null,v(e.album),1),m("span",null,v(c(V)(e.time)),1)])])})),128)),p(g(c(q),{class:"lyric-pagination","cur-page":Xe.value,"onUpdate:curPage":l[5]||(l[5]=e=>Xe.value=e),"page-size":c(Ye),total:c(aa)},null,8,["cur-page","page-size","total"]),[[d,c(Ye)<c(aa)]])],512),[[d,!Ke.get("lyric")]])])),_:1})])),_:1},512),[[d,!Ze.value]])])])),_:1},8,["max-height"])}}}),[["__scopeId","data-v-bd90d465"]]);export{we as default};
