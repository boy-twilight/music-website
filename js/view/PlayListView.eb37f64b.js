import{h as a,x as e}from"../element-plus/element-plus.70abbed3.js";import{G as s,ax as o,d as t,Z as i,i as l,c as n,P as r,V as c,U as m,u as p,a as d,T as u,F as v,a7 as g,M as y,R as _,O as f,o as j,z as h}from"../@vue/@vue.7ad02ad1.js";import{b as x}from"../vue-router/vue-router.53ff932e.js";import{u as b,j as k,g as C,k as L,l as P,n as w,f as z,h as R,o as U,m as I,i as S,p as E,q as M,r as O,C as q,P as G,S as F,s as T,_ as V}from"../../static/index-a102e56d.js";import{O as $}from"../index/index.e386a666.js";import{M as B}from"../index/index.b5edaa48.js";import{P as H,_ as J}from"../index.vue_vue_type_style_index_0_scoped_841f6d57_lang/index.vue_vue_type_style_index_0_scoped_841f6d57_lang.e799ab86.js";/* empty css                                                                                                                     */import{N as K}from"../index/index.241e4e22.js";import{T as N}from"../index/index.b10daf18.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const Z={class:"playlist-container scroll-container"},A={class:"header"},D=["src"],Q={class:"right"},W={class:"title"},X={class:"creator"},Y={class:"creator-name"},aa={class:"tag"},ea={class:"description"},sa={class:"header-operation"},oa=V(s({__name:"PlayListView",setup(s){o((a=>({"0a818bde":p(V),"0a71ec7a":p(oa),d7bdc356:p(ta),"4aab3288":p(ia)})));const{fontColor:V,fontBlack:oa,boxShadow:ta,fontGray:ia}=b(),la=t(!1),na=k(),ra=x(),ca=ra.query.id+"",ma=ra.query.type+"",pa=i({id:ca,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),da=i([]),ua=i([]),va=l((()=>new Map(da.map(((a,e)=>[a.id,e]))))),ga=t(1),ya=t(30),_a=l((()=>da.slice((ga.value-1)*ya.value,ga.value*ya.value))),fa=l((()=>da.length)),ja=h("firstLoading"),ha=t(!1),xa=a=>{ga.value=a},ba=a=>{ha.value=a},ka=a=>{ha.value=a},Ca=()=>{T("我有一个精品歌单分享给你："+pa.name+"，地址：https://www.liyinchao.cloud"+ra.fullPath)},La=()=>{"playlist"==ma?na.addLove(pa,na.lovePlaylist,na.lovePlaylistId):na.addLove(pa,na.loveRadio,na.loveRadioId)};return C((async()=>{if("playlist"==ma)try{(await Promise.all([L(ca),P(ca),w(ca,100)])).forEach(((a,e)=>{if(0==e){const{playlist:{name:e,coverImgUrl:s,description:o,tags:t,creator:i,playCount:l}}=a;pa.name=e,pa.image=s,pa.description=o,pa.tag=t,pa.creator.avatarUrl=i.avatarUrl,pa.creator.nickname=i.nickname,pa.playCount=l,na.initLoveStatus(pa,na.lovePlaylistId)}else if(1==e){const{songs:e}=a;e.forEach((a=>{z(da,a)})),na.initLoveMusic(da),R(da)}else if(2==e){const{comments:e,hotComments:s}=a;U(s,ua),U(e,ua),la.value=0==ua.length}}))}catch(a){I(S.ERROR,a.message)}else{try{(await Promise.all([E(ca),M(ca,100)])).forEach(((a,e)=>{if(0==e){const{data:{name:e,dj:{avatarUrl:s,nickname:o},picUrl:t,desc:i,subCount:l}}=a;pa.name=e,pa.id=ca,pa.description=i,pa.image=t,pa.playCount=l,pa.creator.nickname=o,pa.creator.avatarUrl=s,na.initLoveStatus(pa,na.loveRadioId)}else if(1==e){const{programs:e}=a;e.forEach((a=>{const{mainSong:{name:e,id:s,fee:o,artists:t,album:{name:i,picUrl:l},duration:n}}=a;da.push({id:s,name:e,singer:t[0].name,songImage:l,album:i,available:o,time:n})})),na.initLoveMusic(da),R(da)}}))}catch(a){I(S.ERROR,a.message)}O(ca,"7",ua,(()=>{la.value=0==ua.length}))}ja.value=!1}),ja),(s,o)=>{const t=a,i=e;return j(),n("div",Z,[r(m(p($),{"song-id-mapper":p(va),songs:p(_a),onCloseSelect:ba},null,8,["song-id-mapper","songs"]),[[c,ha.value]]),r(d("div",A,[d("img",{src:pa.image,class:"left-image"},null,8,D),d("div",Q,[d("p",W,u(pa.name),1),d("div",X,[m(t,{src:pa.creator.avatarUrl},null,8,["src"]),d("span",Y,u(pa.creator.nickname),1),d("div",aa,[(j(!0),n(v,null,g(pa.tag,(a=>(j(),n("span",{key:a},"#"+u(a),1)))),128))])]),d("p",ea,u(pa.description),1),d("div",sa,[m(p(H),{songs:p(_a)},null,8,["songs"]),m(p(q),{name:pa.isLove?"取消收藏":"收藏",icon:pa.isLove?"":"","icon-style":pa.isLove?"color:#ff6a6a;":"",onClick:La},null,8,["name","icon","icon-style"]),ha.value?_("",!0):(j(),y(p(B),{key:0,"share-to":Ca,onOpenSelect:ka}))])])],512),[[c,!ha.value]]),r(m(p(N),{active:"song",class:"playlist-tab"},{content:f((()=>[m(i,{label:`歌曲 ${da.length}`,name:"song"},{default:f((()=>[m(p(J),{songs:p(_a),"page-size":ya.value,"song-id-mapper":p(va)},null,8,["songs","page-size","song-id-mapper"]),r(m(p(G),{"cur-page":ga.value,"page-size":ya.value,total:p(fa),onPageChange:xa},null,8,["cur-page","page-size","total"]),[[c,ya.value<p(fa)]])])),_:1},8,["label"]),m(i,{label:`评论 ${ua.length<10?ua.length+10:ua.length}`,name:"comment"},{default:f((()=>[la.value?(j(),y(p(K),{key:1,size:280,text:"暂无评论数据"})):(j(),y(p(F),{key:0,comments:ua},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[c,!ha.value]])])}}}),[["__scopeId","data-v-f74e9bc8"]]);export{oa as default};
