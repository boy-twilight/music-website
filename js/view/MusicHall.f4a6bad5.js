import{y as e,z as a}from"../element-plus/element-plus.93eaa55f.js";import{G as l,ax as s,d as i,Z as t,c as n,U as o,O as u,u as r,o as c,P as v,F as p,a7 as m,M as d,V as h,z as y}from"../@vue/@vue.7ad02ad1.js";import{u as g,g as f,J as _,K as j,L as x,m as b,i as E,M as R,c as w,N as C,_ as k}from"../../static/index-1ea6ea63.js";/* empty css                                                                                                                     */import{A as I}from"../index/index.752bb5d3.js";import{L as O}from"../index/index.58aa7729.js";/* empty css                                                                                                                     */import{T as U}from"../index/index.f739a9eb.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../vue-router/vue-router.53ff932e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const z={class:"music-hall-container"},N=["infinite-scroll-disabled"],S=["infinite-scroll-disabled"],F=["infinite-scroll-disabled"],G=k(l({__name:"MusicHall",setup(l){s((e=>({"4740b216":r(k),"17a1d891":r(L),"65ff396c":r(G),"09be82e9":r(M)})));const{fontColor:k,boxShadow:G,fontGray:L,containerHeight:M}=g(),T=y("firstLoading"),A=i(!1),H=t([]),K=t([]),P=t([]),D=i(18),J=i(0),V=i(!1),Z=async()=>{try{const e=await R(100,P[J.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:i}=e;H[J.value].push({name:a,id:l,image:s,playCount:i,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){b(E.ERROR,e.message)}0==J.value&&(K[J.value].push(...H[J.value].slice(0,D.value)),T.value=!1),A.value&&(A.value=!1)},q=()=>{V.value=!0,D.value+=12,D.value<H[J.value].length?setTimeout((()=>{K[J.value].push(...H[J.value].slice(D.value-12,D.value)),V.value=!1}),100):(A.value=!0,J.value<P.length?(D.value=0,K[J.value].push(...H[J.value].slice(K[J.value].length)),J.value++,Z(),V.value=!1):(A.value=!1,b(E.INFO,"已经到底部啦！")))},B=t([]),Q=t([]),W=t([]),X=i(18),Y=i(0),$=i(!1),ee=async()=>{try{const e=await w(100,W[Y.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:i}=e;B[Y.value].push({name:a,id:l,image:s,playCount:i,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){b(E.ERROR,e.message)}0==Y.value&&(Q[Y.value].push(...B[Y.value].slice(0,X.value)),T.value=!1),A.value&&(A.value=!1)},ae=()=>{$.value=!0,X.value+=12,X.value<B[J.value].length?setTimeout((()=>{Q[Y.value].push(...B[Y.value].slice(X.value-12,X.value)),$.value=!1}),100):(A.value=!0,Y.value<W.length?(X.value=0,Q[Y.value].push(...B[Y.value].slice(Q[Y.value].length)),Y.value++,ee(),$.value=!1):(A.value=!1,b(E.INFO,"已经到底部啦！")))},le=t([]),se=t([]),ie=i(0),te=i(!1),ne=()=>{te.value=!0,A.value=!0,ie.value++,ie.value<se.length?(oe(),te.value=!1):(b(E.SUCCESS,"已经到达底部啦！"),A.value=!1)},oe=async()=>{try{const e=await C(se[ie.value].id),{data:{playlist:a}}=e;a.forEach((e=>{const{id:a,name:l,cover:s,playCount:i}=e;le[ie.value].push({id:a,name:l,image:s,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){b(E.ERROR,e.message)}0==ie.value&&(T.value=!1),A.value&&(A.value=!1)},ue=e=>{"rec"==e&&0==B[0].length?(T.value=!0,ee()):"style"==e&&0==le[0].length&&(T.value=!0,oe())};return f((async()=>{try{(await Promise.all([_(),j(),x()])).forEach(((e,a)=>{if(0==a){const{tags:a}=e;P.push(...a.map((e=>e.name))),P.forEach((()=>{H.push([]),K.push([])}))}else if(1==a){const{sub:a}=e;W.push(...a.map((e=>e.name))),W.forEach((()=>{B.push([]),Q.push([])}))}else if(2==a){const{data:a}=e;a.forEach((e=>{const{tagId:a,tagName:l}=e;se.push({id:a,name:l}),le.push([])}))}}))}catch(e){b(E.ERROR,e.message)}await Z(),T.value=!1}),T),(l,s)=>{const i=e,t=a;return c(),n("div",z,[o(r(U),{active:"top",onGetActive:ue},{content:u((()=>[o(i,{label:"精选歌单",name:"top"},{default:u((()=>[v((c(),n("div",{class:"container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":V.value,style:{overflow:"scroll"}},[(c(!0),n(p,null,m(K,((e,a)=>v((c(),d(r(I),{key:P[a],title:P[a],playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),o(r(O),{"is-loading":A.value},null,8,["is-loading"])],8,N)),[[t,q]])])),_:1}),o(i,{label:"网友推荐",name:"rec"},{default:u((()=>[v((c(),n("div",{class:"container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":$.value,style:{overflow:"scroll"}},[(c(!0),n(p,null,m(Q,((e,a)=>v((c(),d(r(I),{key:W[a],title:W[a],playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),o(r(O),{"is-loading":A.value},null,8,["is-loading"])],8,S)),[[t,ae]])])),_:1}),o(i,{label:"浪漫曲风",name:"style"},{default:u((()=>[v((c(),n("div",{class:"container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":te.value,style:{overflow:"scroll"}},[(c(!0),n(p,null,m(le,((e,a)=>v((c(),d(r(I),{key:se[a].id,title:se[a].name,playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),o(r(O),{"is-loading":A.value},null,8,["is-loading"])],8,F)),[[t,ne]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-32d28873"]]);export{G as default};
