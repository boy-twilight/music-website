import{x as e,y as a}from"../element-plus/element-plus.70abbed3.js";import{G as l,ax as s,d as i,Z as t,c as o,U as n,O as u,u as r,z as c,o as v,P as p,F as d,a7 as m,M as h,V as y}from"../@vue/@vue.7ad02ad1.js";import{J as g,g as f,K as _,L as j,M as x,m as b,i as E,N as R,c as w,O as C,_ as k}from"../../static/index-c54fb4ae.js";/* empty css                                                                                                                     */import{A as S}from"../index/index.29dc9c50.js";import{L as O}from"../index/index.7682c408.js";/* empty css                                                                                                                     */import{T as I}from"../index/index.f2ebda2c.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../vue-router/vue-router.53ff932e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const U={class:"music-hall-container"},z=["infinite-scroll-disabled"],N=["infinite-scroll-disabled"],F=["infinite-scroll-disabled"],G=k(l({__name:"MusicHall",setup(l){s((e=>({"3321362f":r(k),"33347a17":r(H),"867e6eb4":r(G),"083aca65":r(M),"23023ea3":r(L),"13a1d580":r(T)})));const{fontColor:k,boxShadow:G,fontGray:H,containerHeight:L}=c("theme"),{scrollBarWidth:M,scrollVisible:T,autoHideScrollbar:A,hideScrollbar:K}=g(),P=c("firstLoading"),V=i(!1),B=t([]),D=t([]),J=t([]),W=i(18),Z=i(0),q=i(!1),Q=async()=>{try{const e=await R(100,J[Z.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:i}=e;B[Z.value].push({name:a,id:l,image:s,playCount:i,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){b(E.ERROR,e.message)}0==Z.value&&(D[Z.value].push(...B[Z.value].slice(0,W.value)),P.value=!1),V.value&&(V.value=!1)},X=()=>{q.value=!0,W.value+=12,W.value<B[Z.value].length?setTimeout((()=>{D[Z.value].push(...B[Z.value].slice(W.value-12,W.value)),q.value=!1}),100):(V.value=!0,Z.value<J.length?(W.value=0,D[Z.value].push(...B[Z.value].slice(D[Z.value].length)),Z.value++,Q(),q.value=!1):(V.value=!1,b(E.INFO,"已经到底部啦！")))},Y=t([]),$=t([]),ee=t([]),ae=i(18),le=i(0),se=i(!1),ie=async()=>{try{const e=await w(100,ee[le.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:i}=e;Y[le.value].push({name:a,id:l,image:s,playCount:i,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){b(E.ERROR,e.message)}0==le.value&&($[le.value].push(...Y[le.value].slice(0,ae.value)),P.value=!1),V.value&&(V.value=!1)},te=()=>{se.value=!0,ae.value+=12,ae.value<Y[Z.value].length?setTimeout((()=>{$[le.value].push(...Y[le.value].slice(ae.value-12,ae.value)),se.value=!1}),100):(V.value=!0,le.value<ee.length?(ae.value=0,$[le.value].push(...Y[le.value].slice($[le.value].length)),le.value++,ie(),se.value=!1):(V.value=!1,b(E.INFO,"已经到底部啦！")))},oe=t([]),ne=t([]),ue=i(0),re=i(!1),ce=()=>{re.value=!0,V.value=!0,ue.value++,ue.value<ne.length?(ve(),re.value=!1):(b(E.SUCCESS,"已经到达底部啦！"),V.value=!1)},ve=async()=>{try{const e=await C(ne[ue.value].id),{data:{playlist:a}}=e;a.forEach((e=>{const{id:a,name:l,cover:s,playCount:i}=e;oe[ue.value].push({id:a,name:l,image:s,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){b(E.ERROR,e.message)}0==ue.value&&(P.value=!1),V.value&&(V.value=!1)},pe=e=>{K(),"rec"==e&&0==Y[0].length?(P.value=!0,ie()):"style"==e&&0==oe[0].length&&(P.value=!0,ve())};return f((async()=>{try{(await Promise.all([_(),j(),x()])).forEach(((e,a)=>{if(0==a){const{tags:a}=e;J.push(...a.map((e=>e.name))),J.forEach((()=>{B.push([]),D.push([])}))}else if(1==a){const{sub:a}=e;ee.push(...a.map((e=>e.name))),ee.forEach((()=>{Y.push([]),$.push([])}))}else if(2==a){const{data:a}=e;a.forEach((e=>{const{tagId:a,tagName:l}=e;ne.push({id:a,name:l}),oe.push([])}))}}))}catch(e){b(E.ERROR,e.message)}await Q(),P.value=!1}),P),(l,s)=>{const i=e,t=a;return v(),o("div",U,[n(r(I),{active:"top",onGetActive:pe},{content:u((()=>[n(i,{label:"精选歌单",name:"top"},{default:u((()=>[p((v(),o("div",{class:"container scroll-container",onScroll:s[0]||(s[0]=e=>r(A)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":q.value,style:{overflow:"auto"}},[(v(!0),o(d,null,m(D,((e,a)=>p((v(),h(r(S),{key:J[a],title:J[a],playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),n(r(O),{"is-loading":V.value},null,8,["is-loading"])],40,z)),[[t,X]])])),_:1}),n(i,{label:"网友推荐",name:"rec"},{default:u((()=>[p((v(),o("div",{class:"container scroll-container",onScroll:s[1]||(s[1]=e=>r(A)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":se.value,style:{overflow:"auto"}},[(v(!0),o(d,null,m($,((e,a)=>p((v(),h(r(S),{key:ee[a],title:ee[a],playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),n(r(O),{"is-loading":V.value},null,8,["is-loading"])],40,N)),[[t,te]])])),_:1}),n(i,{label:"浪漫曲风",name:"style"},{default:u((()=>[p((v(),o("div",{class:"container scroll-container",onScroll:s[2]||(s[2]=e=>r(A)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":re.value,style:{overflow:"auto"}},[(v(!0),o(d,null,m(oe,((e,a)=>p((v(),h(r(S),{key:ne[a].id,title:ne[a].name,playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),n(r(O),{"is-loading":V.value},null,8,["is-loading"])],40,F)),[[t,ce]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-5fe202d3"]]);export{G as default};
