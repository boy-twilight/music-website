import{t as e,g as u,a,u as t,b as n,C as i,P as l,v as s,w as r,s as o,x as c,e as V,c as d,y as v,z as m,A as p,j as g,k as f,_ as h}from"../../static/index-a47c3a7a.js";import{P as y,_ as w}from"../index.vue_vue_type_style_index_0_scoped_2dc764e5_lang/index.vue_vue_type_style_index_0_scoped_2dc764e5_lang.fc383066.js";import{O as N}from"../index/index.3beb5c84.js";import{A as _}from"../index/index.43c04425.js";import{A as x}from"../index/index.e9db409e.js";import{S as E}from"../index/index.eeedc938.js";import{A as k}from"../index/index.1a5275e8.js";import{L as S}from"../index/index.4a520f69.js";import{N as b}from"../index/index.456753dc.js";import{T as C}from"../index/index.dbb8a4d6.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../nprogress/nprogress.204a1a2a.js";import"../dplayer/dplayer.87601a3d.js";import"../lodash-es/lodash-es.8b477e85.js";/* empty css                                   *//* empty css                                                                                                                     *//* empty css                                                                                                                     */const D={class:"search-container scroll-container"},R=["src"],j={class:"right-singer"},B={class:"singer-name"},z={class:"singer-info"},L={class:"song"},T={class:"header-operation"},I={class:"lyric-container"},O={class:"lyric-operation"},P=["onClick"],M=["onClick"],U=["onClick"],A=["onClick"],F=["onClick"],q={class:"lyric-left"},G={class:"song-name"},W={class:"is-vip iconfont"},H={class:"lyric-center"},J={class:"lyric-right"},K=h(Vue.defineComponent({__name:"SearchView",setup(h){Vue.useCssVars((e=>({"424aed52":Vue.unref(X),"40d5211a":Vue.unref($),"06d92a54":Vue.unref(Z),df0e866a:Vue.unref(Y),"4aab3ee1":Vue.unref(ee),"2b0a65d2":Vue.unref(ue)})));const K=e(),{bgMode:Q}=Pinia.storeToRefs(K),X=Vue.inject("fontGray"),Y=u().get("shadow"),Z=u().get("fontColor"),$=u().get("themeColor"),ee=Vue.computed((()=>"skin"==Q.value?"rgba(220, 220, 220, 0.1)":"#ffffff"==(null==Z?void 0:Z.value)?"rgba(30, 30, 30, 0.2)":"rgba(220, 220, 220, 0.25)")),ue=Vue.computed((()=>"skin"==Q.value?"rgba(230, 230, 230, 0.25)":"#ffffff"==(null==Z?void 0:Z.value)?"rgba(30, 30, 30, 1)":"rgba(220, 220, 220, 0.8)")),ae=VueRouter.useRouter(),te=a(),{loveMusicId:ne,loveSongs:ie}=Pinia.storeToRefs(te),le=Vue.ref(!1),se=e=>{le.value=e},re=()=>{he.forEach((e=>{e.isLove=!0;null==ne.value.get(e.id)&&ie.value.push(e)}))},oe=t(),{songListId:ce,songList:Ve,current:de,playProcess:ve,playTime:me,isPlay:pe}=Pinia.storeToRefs(oe),ge=VueRouter.useRoute().query.keyWord+"",fe=Vue.ref("song"),he=Vue.reactive([]),ye=Vue.computed((()=>new Map(he.map(((e,u)=>[e.id,u]))))),we=Vue.reactive([]),Ne=Vue.reactive([]),_e=Vue.reactive([]),xe=Vue.reactive([]),Ee=Vue.reactive([]),ke=Vue.reactive([]),Se=Vue.computed((()=>ke.length>0?ke[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),be=Vue.reactive([]),Ce=Vue.computed((()=>new Map(be.map(((e,u)=>[e.id,u]))))),De=Vue.ref(!1),Re=Vue.inject("firstLoading"),je=Vue.reactive([!1,!1,!1,!1,!1,!1,!1]),Be=Vue.reactive([]),ze=Vue.ref(1),Le=Vue.computed((()=>"song"==fe.value?30:10)),Te=Vue.computed((()=>"song"==fe.value?he:be)),Ie=Vue.computed((()=>Te.value.slice((ze.value-1)*Le.value,ze.value*Le.value))),Oe=Vue.computed((()=>"song"==fe.value?he.length:be.length)),Pe=e=>{ze.value=e},Me=e=>{fe.value=e,"video"==e&&0==we.length?n((async()=>{try{const e=await v(1014,100,ge),{result:{videos:u}}=e;u&&u.length>0&&u.forEach((e=>{const{vid:u,title:a,coverUrl:t,creator:n,playTime:i}=e;we.push({id:u,name:a,image:t,artist:n[0].userName,playCount:i})}))}catch(e){V(d.ERROR,e.message)}De.value=!1,je[0]=0==we.length}),De):"mv"==e&&0==Ne.length?n((async()=>{try{const e=await v(1004,100,ge),{result:{mvs:u}}=e;u&&0!=u.length&&u.forEach((e=>{const{id:u,name:a,cover:t,artistName:n,playCount:i}=e;Ne.push({id:u,name:a,image:t,artist:n,playCount:i})}))}catch(e){V(d.ERROR,e.message)}De.value=!1,je[1]=0==Ne.length}),De):"album"==e&&0==_e.length?n((async()=>{try{const e=await v(10,60,ge),{result:{albums:u}}=e;u&&u.length>0&&u.forEach((e=>{const{id:u,name:a,picUrl:t,publishTime:n,artist:i}=e;_e.push({id:u,name:a,cover:t,publishTime:m(n),artistId:i.id})}))}catch(e){V(d.ERROR,e.message)}De.value=!1,je[2]=0==_e.length}),De):"radio"==e&&0==Ee.length?n((async()=>{try{const e=await v(1009,100,ge),{result:{djRadios:u}}=e;u&&u.length>0&&u.forEach((e=>{const{id:u,name:a,picUrl:t,playCount:n}=e;Ee.push({name:a,id:u,image:t,playCount:n,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(e){V(d.ERROR,e.message)}De.value=!1,je[3]=0==Ee.length}),De):"playList"==e&&0==xe.length?n((async()=>{try{const e=await v(1e3,100,ge),{result:{playlists:u}}=e;u&&u.length>0&&u.forEach((e=>{const{id:u,name:a,coverImgUrl:t,playCount:n}=e;xe.push({id:u,name:a,image:t,playCount:n,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){V(d.ERROR,e.message)}De.value=!1,je[4]=0==xe.length}),De):"lyric"==e&&0==be.length&&n((async()=>{try{const e=await v(1006,100,ge),{result:{songs:u}}=e;if(u&&u.length>0){const e=u.map((e=>e.id)).join(","),a=await p(e),{songs:t}=a;t.forEach((e=>{Be.push(3),g([],be,e)})),u.forEach(((e,u)=>{const{lyrics:{txt:a}}=e;be[u].lyric=a.split("\n")})),f(e,be),te.initLoveMusic(he)}}catch(e){V(d.ERROR,e.message)}De.value=!1,je[6]=0==be.length}),De)};return n((async()=>{try{(await Promise.all([v(1,100,ge),v(100,100,ge)])).forEach((async(e,u)=>{if(0==u){const{result:{songs:u}}=e;if(u&&u.length>0){const e=u.map((e=>e.id)).join(","),a=await p(e),{songs:t}=a;t.forEach((e=>{g([],he,e)})),f(e,he),te.initLoveMusic(he)}}else if(1==u){const{result:{artists:u}}=e;u&&u.length>0&&u.forEach((e=>{const{id:u,name:a,picUrl:t,accountId:n,albumSize:i,mvSize:l}=e;ke.push({id:u,name:a,avatar:t,score:n,albumSize:i,mvSize:l})})),je[5]=0==ke.length}}))}catch(e){V(d.ERROR,e.message)}Re.value=!1}),Re),(e,u)=>{const a=Vue.resolveComponent("el-tab-pane"),t=Vue.resolveComponent("No"),n=Vue.resolveDirective("prevent");return Vue.openBlock(),Vue.createElementBlock("div",D,[Vue.withDirectives(Vue.createVNode(Vue.unref(N),{songs:Vue.unref(Ie),"song-id-mapper":Vue.unref(ye),onCloseSelect:se},null,8,["songs","song-id-mapper"]),[[Vue.vShow,le.value]]),Vue.withDirectives(Vue.createElementVNode("div",{class:"result-singer",onClick:u[1]||(u[1]=e=>Vue.unref(ae).push({name:"artist",query:{id:Vue.unref(Se).id,score:Vue.unref(Se).score}}))},[Vue.createElementVNode("img",{src:Vue.unref(Se).avatar,class:"left-singer"},null,8,R),Vue.createElementVNode("div",j,[Vue.createElementVNode("h4",B,"歌手："+Vue.toDisplayString(Vue.unref(Se).name),1),Vue.createElementVNode("p",z,[Vue.createElementVNode("span",null,"专辑："+Vue.toDisplayString(Vue.unref(Se).albumSize),1),Vue.createElementVNode("span",null,"视频："+Vue.toDisplayString(Vue.unref(Se).mvSize),1)])]),Vue.createVNode(Vue.unref(i),{name:Vue.unref(Se).isLove?"取消关注":"关注歌手",icon:Vue.unref(Se).isLove?"":"","icon-style":Vue.unref(Se).isLove?"color:#ff6a6a;":"",onClick:u[0]||(u[0]=Vue.withModifiers((e=>Vue.unref(te).addLove(Vue.unref(Se),Vue.unref(te).loveSinger,Vue.unref(te).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[Vue.vShow,Vue.unref(Se).name]]),Vue.withDirectives(Vue.createVNode(Vue.unref(C),{onGetActive:Me,active:"song",class:"search-tab"},{content:Vue.withCtx((()=>[Vue.createVNode(a,{label:"歌曲",name:"song"},{default:Vue.withCtx((()=>[Vue.createElementVNode("div",L,[Vue.createElementVNode("div",T,[Vue.createVNode(Vue.unref(y),{songs:Vue.unref(Ie)},null,8,["songs"]),Vue.createVNode(Vue.unref(i),{icon:"",onClick:re,name:"全部收藏"}),Vue.createVNode(Vue.unref(i),{icon:"",name:"批量操作",onClick:u[2]||(u[2]=e=>le.value=!le.value)})]),Vue.createVNode(Vue.unref(w),{songs:Vue.unref(Ie),"page-size":Vue.unref(Le),"song-id-mapper":Vue.unref(ye)},null,8,["songs","page-size","song-id-mapper"]),Vue.withDirectives(Vue.createVNode(Vue.unref(l),{"cur-page":ze.value,"page-size":Vue.unref(Le),total:Vue.unref(Oe),onPageChange:Pe},null,8,["cur-page","page-size","total"]),[[Vue.vShow,Vue.unref(Le)<Vue.unref(Oe)]])])])),_:1}),Vue.createVNode(a,{label:"视频",name:"video"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(S),{"is-loading":De.value},null,8,["is-loading"]),Vue.withDirectives(Vue.createVNode(Vue.unref(b),{text:"暂无搜索结果"},null,512),[[Vue.vShow,je[0]]]),Vue.withDirectives(Vue.createVNode(Vue.unref(k),{mvs:we,"show-pagination":!0},null,8,["mvs"]),[[Vue.vShow,!je[0]]])])),_:1}),Vue.createVNode(a,{label:"MV",name:"mv"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(S),{"is-loading":De.value},null,8,["is-loading"]),Vue.withDirectives(Vue.createVNode(t,{text:"暂无搜索结果"},null,512),[[Vue.vShow,je[1]]]),Vue.withDirectives(Vue.createVNode(Vue.unref(k),{mvs:Ne,"show-pagination":!0},null,8,["mvs"]),[[Vue.vShow,!je[1]]])])),_:1}),Vue.createVNode(a,{label:"专辑",name:"album"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(S),{"is-loading":De.value},null,8,["is-loading"]),Vue.withDirectives(Vue.createVNode(Vue.unref(b),{text:"暂无搜索结果"},null,512),[[Vue.vShow,je[2]]]),Vue.withDirectives(Vue.createVNode(Vue.unref(_),{albums:_e,"show-pagination":!0},null,8,["albums"]),[[Vue.vShow,!je[2]]])])),_:1}),Vue.createVNode(a,{label:"电台",name:"radio"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(S),{"is-loading":De.value},null,8,["is-loading"]),Vue.withDirectives(Vue.createVNode(Vue.unref(b),{text:"暂无搜索结果"},null,512),[[Vue.vShow,je[3]]]),Vue.withDirectives(Vue.createVNode(Vue.unref(x),{playlists:Ee,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[Vue.vShow,!je[3]]])])),_:1}),Vue.createVNode(a,{label:"歌单",name:"playList"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(S),{"is-loading":De.value},null,8,["is-loading"]),Vue.withDirectives(Vue.createVNode(Vue.unref(b),{text:"暂无搜索结果"},null,512),[[Vue.vShow,je[4]]]),Vue.withDirectives(Vue.createVNode(Vue.unref(x),{playlists:xe,"show-pagination":!0},null,8,["playlists"]),[[Vue.vShow,!je[4]]])])),_:1}),Vue.createVNode(a,{label:"歌手",name:"singer"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(S),{"is-loading":De.value},null,8,["is-loading"]),Vue.withDirectives(Vue.createVNode(Vue.unref(b),{text:"暂无搜索结果"},null,512),[[Vue.vShow,je[5]]]),Vue.withDirectives(Vue.createVNode(Vue.unref(E),{"singer-list":ke},null,8,["singer-list"]),[[Vue.vShow,!je[5]]])])),_:1}),Vue.createVNode(a,{label:"歌词",name:"lyric"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(S),{"is-loading":De.value},null,8,["is-loading"]),Vue.withDirectives(Vue.createVNode(Vue.unref(b),{text:"暂无搜索结果"},null,512),[[Vue.vShow,je[6]]]),Vue.createElementVNode("div",I,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(Ie),(e=>{var u;return Vue.openBlock(),Vue.createElementBlock("div",{class:"lyric",key:e.id},[Vue.createElementVNode("div",O,[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{class:"iconfont play-music",onClick:u=>(async e=>{if("0"==e.available||"8"==e.available){const u=ce.value.get(e.id);null==u?(te.addRecord(e,te.songRecord,te.loveMusicId),0==de.value?(pe&&(pe.value=!1),ve.value=0,me.value=0,Ve.value.unshift(e),await Vue.nextTick(),pe.value=!0):(Ve.value.unshift(e),de.value=0)):de.value!=u?de.value=u:pe.value=!0}else"1"==e.available?V(d.INFO,"此歌曲为vip专属"):"10"==e.available&&V(d.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")})(e)},[Vue.createTextVNode("")],8,P)),[[n]]),Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{class:"iconfont music-info",onClick:u=>Vue.unref(s)(e)},[Vue.createTextVNode("")],8,M)),[[n]]),Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{class:"iconfont",onClick:u=>Vue.unref(r)(e)},[Vue.createTextVNode("")],8,U)),[[n]]),Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{class:"open-lyric",onClick:u=>{return a=Vue.unref(Ce).get(e.id),void(Be[a]=Be[a]==be[a].lyric.length?3:be[a].lyric.length);var a}},[Vue.createTextVNode(Vue.toDisplayString(Be[Vue.unref(Ce).get(e.id)]==(null==(u=e.lyric)?void 0:u.length)?"收起歌词":"展开歌词"),1)],8,A)),[[n]]),Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{class:"copy-lyric",onClick:u=>Vue.unref(o)(e.name+"\r\n"+e.lyric.join("\r\n"),"歌词复制成功！")},[Vue.createTextVNode("复制歌词")],8,F)),[[n]])]),Vue.createElementVNode("div",q,[Vue.createElementVNode("p",G,[Vue.createElementVNode("span",null,Vue.toDisplayString(e.name),1),Vue.withDirectives(Vue.createElementVNode("span",W,"",512),[[Vue.vShow,"10"==e.available||"1"==e.available]])]),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.lyric,((u,a)=>Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("p",{key:a},Vue.toDisplayString(u.trim()),1)),[[Vue.vShow,a<Be[Vue.unref(Ce).get(e.id)]]]))),128))]),Vue.createElementVNode("div",H,[Vue.createElementVNode("span",null,Vue.toDisplayString(e.singer),1)]),Vue.createElementVNode("div",J,[Vue.createElementVNode("span",null,Vue.toDisplayString(e.album),1),Vue.createElementVNode("span",null,Vue.toDisplayString(Vue.unref(c)(e.time)),1)])])})),128)),Vue.withDirectives(Vue.createVNode(Vue.unref(l),{class:"lyric-pagination","cur-page":ze.value,"page-size":Vue.unref(Le),total:Vue.unref(Oe),onPageChange:Pe},null,8,["cur-page","page-size","total"]),[[Vue.vShow,Vue.unref(Le)<Vue.unref(Oe)]])])])),_:1})])),_:1},512),[[Vue.vShow,!le.value]])])}}}),[["__scopeId","data-v-7a779702"]]);export{K as default};
