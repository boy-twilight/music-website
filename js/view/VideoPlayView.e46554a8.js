import{x as e,h as a}from"../element-plus/element-plus.93eaa55f.js";import{G as s,ax as o,d as t,Z as i,i as l,y as n,M as r,O as c,u as m,o as d,a as u,U as p,P as v,V as y,c as h,a7 as f,S as j,F as g,W as _,T as C,z as x,n as k,aq as b,ay as w,az as V}from"../@vue/@vue.7ad02ad1.js";import{b as R,u as S}from"../vue-router/vue-router.53ff932e.js";import{u as T,j as z,g as E,A as I,B as q,D as L,E as N,z as O,m as P,i as A,o as D,F,G,H,I as U,C as Z,S as B,s as M,_ as W}from"../../static/index-1ea6ea63.js";import{D as J}from"../dplayer/dplayer.beff636d.js";/* empty css                                                                                                                     */import{A as K}from"../index/index.8180a858.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const Q=e=>(w("data-v-4245c5ad"),e=e(),V(),e),X={class:"video-container scroll-container"},Y={class:"players-container"},$={class:"recommend-container"},ee={class:"content"},ae={class:"mask"},se=["onClick"],oe=Q((()=>u("div",{class:"players"},null,-1))),te={class:"detail"},ie={class:"title"},le={class:"artist-info"},ne={class:"operation"},re={class:"comment-area"},ce=Q((()=>u("h4",{class:"title"},"全部评论",-1))),me=Q((()=>u("span",{class:"iconfont_1"}," ",-1))),de=W(s({__name:"VideoPlayView",setup(s){o((e=>({"220017ca":m(w),"21f07866":m(V),"6c75791c":m(de),"2aad8f78":m(ue),a8c0ab7e:m(W),eae83b38:m(Q)})));const{fontColor:w,fontBlack:V,boxShadow:W,themeColor:Q,fontGray:de,videoHeight:ue,contentHeight:pe}=T(),ve=z(),ye=t(),he=R(),fe=S(),je=he.query.id+"",ge=i({id:je,name:"",image:"",artist:"",playCount:"",url:"",time:"",publishTime:"",available:""}),_e=i([]),Ce=l((()=>[ge,..._e])),xe=x("firstLoading"),ke=t(!1),be=i([]),we=t(!1),Ve=()=>{M("我在https://www.liyinchao.cloud"+he.fullPath+"观看"+ge.name+",快来和我一起观看把！")};return E((async()=>{if(/.*[A-Z]+.*/.test(je))try{(await Promise.all([F(je),G(je),H(je),U(je,1e3)])).forEach(((e,a)=>{if(0==a){const{data:{title:a,coverUrl:s,publishTime:o,playTime:t,creator:i}}=e;ge.name=a,ge.image=s,ge.playCount=t,ge.publishTime=O(o),ge.artist=i.nickname}else if(1==a){const{urls:a}=e;a?ge.url=a[0].url:P(A.INFO,"此视频暂无播放资源，请切换下一个。")}else if(2==a){const{data:a}=e;a.forEach((e=>{const{title:a,coverUrl:s,vid:o,playTime:t,creator:i}=e;_e.push({id:o,name:a,image:s,playCount:t,artist:i[0].userName})}))}else if(3==a){const{comments:a,hotComments:s}=e;D(s,be),D(a,be)}}))}catch(e){P(A.ERROR,e.message)}else try{(await Promise.all([I(je),q(je),L(je),N(je,1e3)])).forEach(((e,a)=>{if(0==a){const{data:{name:a,artistName:s,cover:o,playCount:t,duration:i,publishTime:l}}=e;ge.name=a,ge.playCount=t,ge.image=o,ge.artist=s,ge.time=i,ge.publishTime=O(l)}else if(1==a){const{data:{url:a,fee:s}}=e;a?(ge.url=a,ge.available=s):P(A.INFO,"此视频暂无播放资源，请切换下一个。")}else if(2==a){const{mvs:a}=e;a&&a.forEach((e=>{const{id:a,cover:s,name:o,artistName:t,playCount:i}=e;_e.push({id:a,image:s,name:o,artist:t,playCount:i})}))}else if(3==a){const{comments:a,hotComments:s}=e;D(s,be),D(a,be)}}))}catch(e){P(A.ERROR,e.message)}ve.addRecord(ge,ve.videoRecord,ve.videoRecordId),ve.initLoveStatus(ge,ve.loveVideoId),(async()=>{await k(),ye.value=new J({container:document.querySelector(".players"),video:{url:ge.url,thumbnails:ge.image,type:"video/mp4",pic:ge.image},autoplay:!1,loop:!1,hotkey:!0,theme:null==Q?void 0:Q.value,chromecast:!0,lang:"zh-cn",screenshot:!0,preload:"auto",volume:.9,playbackSpeed:[.75,1,1.25,1.5,1.75,2],contextmenu:[{text:"下载",click:()=>{ve.addVideoDownload(ge)}},{text:"收藏",click:()=>{ve.addLove(ge,ve.loveVideo,ve.loveVideoId)}},{text:"分享",click:()=>{Ve()}}]}),document.querySelector(".dplayer-video").onended=()=>{ke.value=!0}})(),xe.value=!1}),xe),n((()=>{var e;document.querySelector(".dplayer-video").onended=null,null==(e=ye.value)||e.destroy()})),(s,o)=>{const t=a,i=e,l=b("prevent");return d(),r(i,{"max-height":m(pe)},{default:c((()=>[u("div",X,[u("div",Y,[p(_,{name:"show"},{default:c((()=>[v(u("div",$,[v(u("h4",null,"相关推荐",512),[[y,m(Ce).length>1]]),u("div",ee,[(d(!0),h(g,null,f(m(Ce),((e,a)=>(d(),h("div",{class:"recommend-video",key:e.id},[p(t,{src:e.image,class:"image"},null,8,["src"]),u("div",ae,[v((d(),h("span",{class:"iconfont play",onClick:s=>((e,a)=>{0==e?(ke.value=!1,document.querySelector(".dplayer-video").play()):fe.push({name:"video",query:{id:a}})})(a,e.id)},[j("")],8,se)),[[l]])])])))),128))])],512),[[y,ke.value]])])),_:1}),oe]),u("div",te,[u("p",ie,C(ge.name),1),u("div",le,[u("span",null,C(/.*[A-Z]+.*/.test(je)?"创作者："+ge.artist:"演唱："+ge.artist),1),u("span",null,C(ge.playCount)+"次观看",1),u("span",null,"发布时间："+C(ge.publishTime),1)]),v(u("div",ne,[p(m(Z),{name:ge.isLove?"取消收藏":"收藏",icon:ge.isLove?"":"","icon-style":ge.isLove?"color:#ff6a6a;":"",onClick:o[0]||(o[0]=e=>m(ve).addLove(ge,m(ve).loveVideo,m(ve).loveVideoId)),class:"operate"},null,8,["name","icon","icon-style"]),p(m(Z),{name:"下载",onClick:o[1]||(o[1]=e=>m(ve).addVideoDownload(ge)),icon:"",class:"operate"}),p(m(Z),{name:"分享",icon:"",onClick:Ve,class:"operate"}),p(m(Z),{name:"评论",icon:"",onClick:o[2]||(o[2]=e=>we.value=!0),class:"operate"})],512),[[y,!we.value]])]),v(p(m(K),{mvs:_e,title:"相关推荐"},null,8,["mvs"]),[[y,!we.value&&_e.length>0]]),v(u("div",re,[ce,u("button",{class:"exit",onClick:o[3]||(o[3]=e=>we.value=!1)},[me,j(" 退出 ")]),p(m(B),{comments:be},null,8,["comments"])],512),[[y,we.value]])])])),_:1},8,["max-height"])}}}),[["__scopeId","data-v-4245c5ad"]]);export{de as default};
