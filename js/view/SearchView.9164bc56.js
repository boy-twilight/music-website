import{x as a,y as e}from"../element-plus/element-plus.93eaa55f.js";import{G as s,ax as l,d as n,Z as i,i as t,M as o,O as r,u as c,o as u,a as p,P as m,V as g,U as d,T as v,a2 as h,c as y,a7 as _,S as f,F as x,z as j,ag as b,aq as C}from"../@vue/@vue.7ad02ad1.js";import{b as k,u as R}from"../vue-router/vue-router.53ff932e.js";import{s as w}from"../pinia/pinia.07d51cb2.js";import{u as z,j as E,a as S,g as L,t as M,v as O,f as U,h as I,m as P,i as N,C as T,P as A,w as q,x as G,s as V,y as B,z as F,_ as H}from"../../static/index-1ea6ea63.js";import{P as D,_ as J}from"../index.vue_vue_type_style_index_0_scoped_c70cb44b_lang/index.vue_vue_type_style_index_0_scoped_c70cb44b_lang.8adf256f.js";import{O as K}from"../index/index.f9027000.js";import{A as W}from"../index/index.eae5a8be.js";import{A as Z}from"../index/index.752bb5d3.js";import{S as Q}from"../index/index.03db74ba.js";import{A as X}from"../index/index.8180a858.js";import{L as Y}from"../index/index.58aa7729.js";import{N as $}from"../index/index.d670be34.js";import{T as aa}from"../index/index.f739a9eb.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";/* empty css                                                                                                                     *//* empty css                                                                                                                     */const ea={class:"search-container scroll-container"},sa=["src"],la={class:"right-singer"},na={class:"singer-name"},ia={class:"singer-info"},ta={class:"song"},oa={class:"header-operation"},ra={class:"lyric-container"},ca={class:"lyric-operation"},ua=["onClick"],pa=["onClick"],ma=["onClick"],ga=["onClick"],da=["onClick"],va={class:"lyric-left"},ha={class:"song-name"},ya={class:"is-vip iconfont"},_a={class:"lyric-center"},fa={class:"lyric-right"},xa=H(s({__name:"SearchView",setup(s){l((a=>({"497c64af":c(H),41863537:c(ba),"3452c2d2":c(xa),"6f76310e":c(ja),"51dcb63e":c(Ca),"1ca77718":c(ka)})));const{fontGray:H,fontColor:xa,boxShadow:ja,themeColor:ba,singerBg:Ca,buttonBg:ka,contentHeight:Ra}=z(),wa=R(),za=E(),{loveMusicId:Ea,loveSongs:Sa}=w(za),La=k().query.keyWord+"",Ma=n("song"),Oa=i([]),Ua=t((()=>new Map(Oa.map(((a,e)=>[a.id,e]))))),Ia=i([]),Pa=i([]),Na=i([]),Ta=i([]),Aa=i([]),qa=i([]),Ga=t((()=>qa.length>0?qa[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Va=i([]),Ba=t((()=>new Map(Va.map(((a,e)=>[a.id,e]))))),Fa=n(!1),Ha=j("firstLoading"),Da=i([!1,!1,!1,!1,!1,!1,!1]),Ja=i([]),Ka=n(!1),Wa=n(1),Za=t((()=>"song"==Ma.value?30:10)),Qa=t((()=>"song"==Ma.value?Oa:Va)),Xa=t((()=>Qa.value.slice((Wa.value-1)*Za.value,Wa.value*Za.value))),Ya=t((()=>"song"==Ma.value?Oa.length:Va.length)),$a=a=>{Ka.value=a},ae=()=>{Oa.forEach((a=>{a.isLove=!0;null==Ea.value.get(a.id)&&Sa.value.push(a)}))},ee=a=>{Wa.value=a},{playMusic:se}=S(),le=a=>{Ma.value=a,"video"==a&&0==Ia.length?L((async()=>{try{const a=await M(1014,100,La),{result:{videos:e}}=a;e&&e.length>0&&e.forEach((a=>{const{vid:e,title:s,coverUrl:l,creator:n,playTime:i}=a;Ia.push({id:e,name:s,image:l,artist:n[0].userName,playCount:i})}))}catch(a){P(N.ERROR,a.message)}Fa.value=!1,Da[0]=0==Ia.length}),Fa):"mv"==a&&0==Pa.length?L((async()=>{try{const a=await M(1004,100,La),{result:{mvs:e}}=a;e&&0!=e.length&&e.forEach((a=>{const{id:e,name:s,cover:l,artistName:n,playCount:i}=a;Pa.push({id:e,name:s,image:l,artist:n,playCount:i})}))}catch(a){P(N.ERROR,a.message)}Fa.value=!1,Da[1]=0==Pa.length}),Fa):"album"==a&&0==Na.length?L((async()=>{try{const a=await M(10,60,La),{result:{albums:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,publishTime:n,artist:i}=a;Na.push({id:e,name:s,cover:l,publishTime:F(n),artistId:i.id})}))}catch(a){P(N.ERROR,a.message)}Fa.value=!1,Da[2]=0==Na.length}),Fa):"radio"==a&&0==Aa.length?L((async()=>{try{const a=await M(1009,100,La),{result:{djRadios:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,playCount:n}=a;Aa.push({name:s,id:e,image:l,playCount:n,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){P(N.ERROR,a.message)}Fa.value=!1,Da[3]=0==Aa.length}),Fa):"playList"==a&&0==Ta.length?L((async()=>{try{const a=await M(1e3,100,La),{result:{playlists:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,coverImgUrl:l,playCount:n}=a;Ta.push({id:e,name:s,image:l,playCount:n,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){P(N.ERROR,a.message)}Fa.value=!1,Da[4]=0==Ta.length}),Fa):"lyric"==a&&0==Va.length&&L((async()=>{try{const a=await M(1006,100,La),{result:{songs:e}}=a;if(e&&e.length>0){const a=e.map((a=>a.id)).join(","),s=await O(a),{songs:l}=s;l.forEach((a=>{Ja.push(3),U(Va,a)})),e.forEach(((a,e)=>{const{lyrics:{txt:s}}=a;Va[e].lyric=s.split("\n")})),I(Va),za.initLoveMusic(Oa)}}catch(a){P(N.ERROR,a.message)}Fa.value=!1,Da[6]=0==Va.length}),Fa)};return L((async()=>{try{(await Promise.all([M(1,100,La),M(100,100,La)])).forEach((async(a,e)=>{if(0==e){const{result:{songs:e}}=a;if(e&&e.length>0){const a=e.map((a=>a.id)).join(","),s=await O(a),{songs:l}=s;l.forEach((a=>{U(Oa,a)})),I(Oa),za.initLoveMusic(Oa)}}else if(1==e){const{result:{artists:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,accountId:n,albumSize:i,mvSize:t}=a;qa.push({id:e,name:s,avatar:l,score:n,albumSize:i,mvSize:t})})),Da[5]=0==qa.length}}))}catch(a){P(N.ERROR,a.message)}Ha.value=!1}),Ha),(s,l)=>{const n=e,i=b("No"),t=a,j=C("prevent");return u(),o(t,{"max-height":c(Ra)},{default:r((()=>[p("div",ea,[m(d(c(K),{songs:c(Xa),"song-id-mapper":c(Ua),onCloseSelect:$a},null,8,["songs","song-id-mapper"]),[[g,Ka.value]]),m(p("div",{class:"result-singer",onClick:l[1]||(l[1]=a=>c(wa).push({name:"artist",query:{id:c(Ga).id,score:c(Ga).score}}))},[p("img",{src:c(Ga).avatar,class:"left-singer"},null,8,sa),p("div",la,[p("h4",na,"歌手："+v(c(Ga).name),1),p("p",ia,[p("span",null,"专辑："+v(c(Ga).albumSize),1),p("span",null,"视频："+v(c(Ga).mvSize),1)])]),d(c(T),{name:c(Ga).isLove?"取消关注":"关注歌手",icon:c(Ga).isLove?"":"","icon-style":c(Ga).isLove?"color:#ff6a6a;":"",onClick:l[0]||(l[0]=h((a=>c(za).addLove(c(Ga),c(za).loveSinger,c(za).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[g,c(Ga).name]]),m(d(c(aa),{onGetActive:le,active:"song",class:"search-tab"},{content:r((()=>[d(n,{label:"歌曲",name:"song"},{default:r((()=>[p("div",ta,[p("div",oa,[d(c(D),{songs:c(Xa)},null,8,["songs"]),d(c(T),{icon:"",onClick:ae,name:"全部收藏"}),d(c(T),{icon:"",name:"批量操作",onClick:l[2]||(l[2]=a=>Ka.value=!Ka.value)})]),d(c(J),{songs:c(Xa),"page-size":c(Za),"song-id-mapper":c(Ua)},null,8,["songs","page-size","song-id-mapper"]),m(d(c(A),{"cur-page":Wa.value,"page-size":c(Za),total:c(Ya),onPageChange:ee},null,8,["cur-page","page-size","total"]),[[g,c(Za)<c(Ya)]])])])),_:1}),d(n,{label:"视频",name:"video"},{default:r((()=>[d(c(Y),{"is-loading":Fa.value},null,8,["is-loading"]),m(d(c($),{text:"暂无搜索结果"},null,512),[[g,Da[0]]]),m(d(c(X),{mvs:Ia,"show-pagination":!0},null,8,["mvs"]),[[g,!Da[0]]])])),_:1}),d(n,{label:"MV",name:"mv"},{default:r((()=>[d(c(Y),{"is-loading":Fa.value},null,8,["is-loading"]),m(d(i,{text:"暂无搜索结果"},null,512),[[g,Da[1]]]),m(d(c(X),{mvs:Pa,"show-pagination":!0},null,8,["mvs"]),[[g,!Da[1]]])])),_:1}),d(n,{label:"专辑",name:"album"},{default:r((()=>[d(c(Y),{"is-loading":Fa.value},null,8,["is-loading"]),m(d(c($),{text:"暂无搜索结果"},null,512),[[g,Da[2]]]),m(d(c(W),{albums:Na,"show-pagination":!0},null,8,["albums"]),[[g,!Da[2]]])])),_:1}),d(n,{label:"电台",name:"radio"},{default:r((()=>[d(c(Y),{"is-loading":Fa.value},null,8,["is-loading"]),m(d(c($),{text:"暂无搜索结果"},null,512),[[g,Da[3]]]),m(d(c(Z),{playlists:Aa,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[g,!Da[3]]])])),_:1}),d(n,{label:"歌单",name:"playList"},{default:r((()=>[d(c(Y),{"is-loading":Fa.value},null,8,["is-loading"]),m(d(c($),{text:"暂无搜索结果"},null,512),[[g,Da[4]]]),m(d(c(Z),{playlists:Ta,"show-pagination":!0},null,8,["playlists"]),[[g,!Da[4]]])])),_:1}),d(n,{label:"歌手",name:"singer"},{default:r((()=>[d(c(Y),{"is-loading":Fa.value},null,8,["is-loading"]),m(d(c($),{text:"暂无搜索结果"},null,512),[[g,Da[5]]]),m(d(c(Q),{"singer-list":qa},null,8,["singer-list"]),[[g,!Da[5]]])])),_:1}),d(n,{label:"歌词",name:"lyric"},{default:r((()=>[d(c(Y),{"is-loading":Fa.value},null,8,["is-loading"]),m(d(c($),{text:"暂无搜索结果"},null,512),[[g,Da[6]]]),p("div",ra,[(u(!0),y(x,null,_(c(Xa),(a=>{var e;return u(),y("div",{class:"lyric",key:a.id},[p("div",ca,[m((u(),y("span",{class:"iconfont play-music",onClick:e=>c(se)(a)},[f("")],8,ua)),[[j]]),m((u(),y("span",{class:"iconfont music-info",onClick:e=>c(q)(a)},[f("")],8,pa)),[[j]]),m((u(),y("span",{class:"iconfont",onClick:e=>c(G)(a)},[f("")],8,ma)),[[j]]),m((u(),y("span",{class:"open-lyric",onClick:e=>{return s=c(Ba).get(a.id),void(Ja[s]=Ja[s]==Va[s].lyric.length?3:Va[s].lyric.length);var s}},[f(v(Ja[c(Ba).get(a.id)]==(null==(e=a.lyric)?void 0:e.length)?"收起歌词":"展开歌词"),1)],8,ga)),[[j]]),m((u(),y("span",{class:"copy-lyric",onClick:e=>c(V)(a.name+"\r\n"+a.lyric.join("\r\n"),"歌词复制成功！")},[f("复制歌词")],8,da)),[[j]])]),p("div",va,[p("p",ha,[p("span",null,v(a.name),1),m(p("span",ya,"",512),[[g,"10"==a.available||"1"==a.available]])]),(u(!0),y(x,null,_(a.lyric,((e,s)=>m((u(),y("p",{key:s},v(e.trim()),1)),[[g,s<Ja[c(Ba).get(a.id)]]]))),128))]),p("div",_a,[p("span",null,v(a.singer),1)]),p("div",fa,[p("span",null,v(a.album),1),p("span",null,v(c(B)(a.time)),1)])])})),128)),m(d(c(A),{class:"lyric-pagination","cur-page":Wa.value,"page-size":c(Za),total:c(Ya),onPageChange:ee},null,8,["cur-page","page-size","total"]),[[g,c(Za)<c(Ya)]])])])),_:1})])),_:1},512),[[g,!Ka.value]])])])),_:1},8,["max-height"])}}}),[["__scopeId","data-v-f229ac2d"]]);export{xa as default};
