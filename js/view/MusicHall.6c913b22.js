import{y as e,z as a}from"../element-plus/element-plus.79622da4.js";import{G as l,ax as s,d as i,Z as t,c as n,U as o,O as u,u as r,o as c,P as v,F as p,a7 as d,M as m,V as h,z as y}from"../@vue/@vue.7ad02ad1.js";import{u as f,F as g,G as _,H as j,m as x,M as b,I as E,b as R,J as w,_ as C}from"../../static/index-0b0a9c54.js";/* empty css                                                                                                                     */import{A as k}from"../index/index.c37f2e8f.js";import{L as I}from"../index/index.f06ff2a7.js";/* empty css                                                                                                                     */import{T as O}from"../index/index.d30438cd.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../vue-router/vue-router.53ff932e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const U={class:"music-hall-container"},z=["infinite-scroll-disabled"],F=["infinite-scroll-disabled"],G=["infinite-scroll-disabled"],N=C(l({__name:"MusicHall",setup(l){s((e=>({"6a729404":r(C),"56058da2":r(S),"17dbb30a":r(N),feadae90:r(H)})));const{fontColor:C,boxShadow:N,fontGray:S,containerHeight:H}=f(),M=y("firstLoading"),T=i(!1),A=t([]),L=t([]),P=t([]),D=i(18),J=i(0),K=i(!1),V=async()=>{try{const e=await E(100,P[J.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:i}=e;A[J.value].push({name:a,id:l,image:s,playCount:i,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){x(b.ERROR,e.message)}0==J.value&&(L[J.value].push(...A[J.value].slice(0,D.value)),M.value=!1),T.value&&(T.value=!1)},Z=()=>{K.value=!0,D.value+=12,D.value<A[J.value].length?setTimeout((()=>{L[J.value].push(...A[J.value].slice(D.value-12,D.value)),K.value=!1}),100):(T.value=!0,J.value<P.length?(D.value=0,L[J.value].push(...A[J.value].slice(L[J.value].length)),J.value++,V(),K.value=!1):(T.value=!1,x(b.INFO,"已经到底部啦！")))},q=t([]),B=t([]),Q=t([]),W=i(18),X=i(0),Y=i(!1),$=async()=>{try{const e=await R(100,Q[X.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:i}=e;q[X.value].push({name:a,id:l,image:s,playCount:i,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){x(b.ERROR,e.message)}0==X.value&&(B[X.value].push(...q[X.value].slice(0,W.value)),M.value=!1),T.value&&(T.value=!1)},ee=()=>{Y.value=!0,W.value+=12,W.value<q[J.value].length?setTimeout((()=>{B[X.value].push(...q[X.value].slice(W.value-12,W.value)),Y.value=!1}),100):(T.value=!0,X.value<Q.length?(W.value=0,B[X.value].push(...q[X.value].slice(B[X.value].length)),X.value++,$(),Y.value=!1):(T.value=!1,x(b.INFO,"已经到底部啦！")))},ae=t([]),le=t([]),se=i(0),ie=i(!1),te=()=>{ie.value=!0,T.value=!0,se.value++,se.value<le.length?(ne(),ie.value=!1):(x(b.SUCCESS,"已经到达底部啦！"),T.value=!1)},ne=async()=>{try{const e=await w(le[se.value].id),{data:{playlist:a}}=e;a.forEach((e=>{const{id:a,name:l,cover:s,playCount:i}=e;ae[se.value].push({id:a,name:l,image:s,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){x(b.ERROR,e.message)}0==se.value&&(M.value=!1),T.value&&(T.value=!1)},oe=e=>{if("rec"==e){if(0!=q[0].length)return;M.value=!0,$()}else if("style"==e){if(0!=ae[0].length)return;M.value=!0,ne()}};return(async()=>{M.value=!0;try{(await Promise.all([g(),_(),j()])).forEach(((e,a)=>{if(0==a){const{tags:a}=e;P.push(...a.map((e=>e.name))),P.forEach((()=>{A.push([]),L.push([])}))}else if(1==a){const{sub:a}=e;Q.push(...a.map((e=>e.name))),Q.forEach((()=>{q.push([]),B.push([])}))}else if(2==a){const{data:a}=e;a.forEach((e=>{const{tagId:a,tagName:l}=e;le.push({id:a,name:l}),ae.push([])}))}}))}catch(e){x(b.ERROR,e.message)}await V(),M.value=!1})(),(l,s)=>{const i=e,t=a;return c(),n("div",U,[o(r(O),{active:"top",onGetActive:oe},{content:u((()=>[o(i,{label:"精选歌单",name:"top"},{default:u((()=>[v((c(),n("div",{class:"container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":K.value,style:{overflow:"scroll"}},[(c(!0),n(p,null,d(L,((e,a)=>v((c(),m(r(k),{key:P[a],title:P[a],playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),o(r(I),{"is-loading":T.value},null,8,["is-loading"])],8,z)),[[t,Z]])])),_:1}),o(i,{label:"网友推荐",name:"rec"},{default:u((()=>[v((c(),n("div",{class:"container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":Y.value,style:{overflow:"scroll"}},[(c(!0),n(p,null,d(B,((e,a)=>v((c(),m(r(k),{key:Q[a],title:Q[a],playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),o(r(I),{"is-loading":T.value},null,8,["is-loading"])],8,F)),[[t,ee]])])),_:1}),o(i,{label:"浪漫曲风",name:"style"},{default:u((()=>[v((c(),n("div",{class:"container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ie.value,style:{overflow:"scroll"}},[(c(!0),n(p,null,d(ae,((e,a)=>v((c(),m(r(k),{key:le[a].id,title:le[a].name,playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),o(r(I),{"is-loading":T.value},null,8,["is-loading"])],8,G)),[[t,te]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-28cd3cad"]]);export{N as default};
