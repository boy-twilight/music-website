import{h as e,x as a}from"../element-plus/element-plus.d1c0be0b.js";import{G as s,ax as t,r as o,Z as i,i as l,c as n,P as r,V as c,U as m,u as p,a as d,T as u,F as v,a7 as g,M as y,R as _,O as f,z as h,o as j}from"../@vue/@vue.59fec093.js";import{b as x}from"../vue-router/vue-router.10a7fca4.js";import{g as k,a as b,b as C,l as L,m as P,n as w,h as z,i as R,o as U,j as I,k as E,p as S,q as M,r as O,C as q,P as G,S as F,s as T,_ as V}from"../../static/index-4224aa70.js";import{O as $}from"../index/index.5aa296be.js";import{M as B}from"../index/index.4122275b.js";import{P as D,_ as H}from"../index.vue_vue_type_style_index_0_scoped_2dc764e5_lang/index.vue_vue_type_style_index_0_scoped_2dc764e5_lang.24350255.js";/* empty css                                                                                                                     */import{N}from"../index/index.a6b36b6a.js";import{T as Z}from"../index/index.3b7c2f8a.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.81428a33.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.57559ed5.js";const A={class:"playlist-container scroll-container"},J={class:"header"},K=["src"],Q={class:"right"},W={class:"title"},X={class:"creator"},Y={class:"creator-name"},ee={class:"tag"},ae={class:"description"},se={class:"header-operation"},te=V(s({__name:"PlayListView",setup(s){t((e=>({"8dc9a876":p(V),"8de8e73e":p(te),"42babe3c":p(oe),"05fa79c1":p(ie)})));const V=k().get("fontColor"),te=k().get("fontBlack"),oe=k().get("shadow"),ie=h("fontGray"),le=o(!1),ne=b(),re=x(),ce=re.query.id+"",me=re.query.type+"",pe=i({id:ce,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),de=i([]),ue=i([]),ve=l((()=>new Map(de.map(((e,a)=>[e.id,a]))))),ge=o(1),ye=o(30),_e=l((()=>de.slice((ge.value-1)*ye.value,ge.value*ye.value))),fe=l((()=>de.length)),he=h("firstLoading"),je=o(!1),xe=e=>{ge.value=e},ke=e=>{je.value=e},be=e=>{je.value=e},Ce=()=>{T("我有一个精品歌单分享给你："+pe.name+"，地址：https://www.liyinchao.cloud"+re.fullPath)},Le=()=>{"playlist"==me?ne.addLove(pe,ne.lovePlaylist,ne.lovePlaylistId):ne.addLove(pe,ne.loveRadio,ne.loveRadioId)};return C((async()=>{if("playlist"==me)try{(await Promise.all([L(ce),P(ce),w(ce,100)])).forEach(((e,a)=>{if(0==a){const{playlist:{name:a,coverImgUrl:s,description:t,tags:o,creator:i,playCount:l}}=e;pe.name=a,pe.image=s,pe.description=t,pe.tag=o,pe.creator.avatarUrl=i.avatarUrl,pe.creator.nickname=i.nickname,pe.playCount=l,ne.initLoveStatus(pe,ne.lovePlaylistId)}else if(1==a){const{songs:a}=e,s=[];a.forEach((e=>{z(s,de,e)})),ne.initLoveMusic(de),R(s.join(","),de)}else if(2==a){const{comments:a,hotComments:s}=e;U(s,ue),U(a,ue),le.value=0==ue.length}}))}catch(e){I(E.ERROR,e.message)}else{try{(await Promise.all([S(ce),M(ce,100)])).forEach(((e,a)=>{if(0==a){const{data:{name:a,dj:{avatarUrl:s,nickname:t},picUrl:o,desc:i,subCount:l}}=e;pe.name=a,pe.id=ce,pe.description=i,pe.image=o,pe.playCount=l,pe.creator.nickname=t,pe.creator.avatarUrl=s,ne.initLoveStatus(pe,ne.loveRadioId)}else if(1==a){const{programs:a}=e,s=[];a.forEach((e=>{const{mainSong:{name:a,id:t,fee:o,artists:i,album:{name:l,picUrl:n},duration:r}}=e;s.push(t),de.push({id:t,name:a,singer:i[0].name,songImage:n,album:l,available:o,time:r})})),ne.initLoveMusic(de),R(s.join(","),de)}}))}catch(e){I(E.ERROR,e.message)}O(ce,"7",ue,(()=>{le.value=0==ue.length}))}he.value=!1}),he),(s,t)=>{const o=e,i=a;return j(),n("div",A,[r(m(p($),{"song-id-mapper":p(ve),songs:p(_e),onCloseSelect:ke},null,8,["song-id-mapper","songs"]),[[c,je.value]]),r(d("div",J,[d("img",{src:pe.image,class:"left-image"},null,8,K),d("div",Q,[d("p",W,u(pe.name),1),d("div",X,[m(o,{src:pe.creator.avatarUrl},null,8,["src"]),d("span",Y,u(pe.creator.nickname),1),d("div",ee,[(j(!0),n(v,null,g(pe.tag,(e=>(j(),n("span",{key:e},"#"+u(e),1)))),128))])]),d("p",ae,u(pe.description),1),d("div",se,[m(p(D),{songs:p(_e)},null,8,["songs"]),m(p(q),{name:pe.isLove?"取消收藏":"收藏",icon:pe.isLove?"":"","icon-style":pe.isLove?"color:#ff6a6a;":"",onClick:Le},null,8,["name","icon","icon-style"]),je.value?_("",!0):(j(),y(p(B),{key:0,"share-to":Ce,onOpenSelect:be}))])])],512),[[c,!je.value]]),r(m(p(Z),{active:"song",class:"playlist-tab"},{content:f((()=>[m(i,{label:`歌曲 ${de.length}`,name:"song"},{default:f((()=>[m(p(H),{songs:p(_e),"page-size":ye.value,"song-id-mapper":p(ve)},null,8,["songs","page-size","song-id-mapper"]),r(m(p(G),{"cur-page":ge.value,"page-size":ye.value,total:p(fe),onPageChange:xe},null,8,["cur-page","page-size","total"]),[[c,ye.value<p(fe)]])])),_:1},8,["label"]),m(i,{label:`评论 ${ue.length<10?ue.length+10:ue.length}`,name:"comment"},{default:f((()=>[le.value?(j(),y(p(N),{key:1,size:280,text:"暂无评论数据"})):(j(),y(p(F),{key:0,comments:ue},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[c,!je.value]])])}}}),[["__scopeId","data-v-26a6aa55"]]);export{te as default};
