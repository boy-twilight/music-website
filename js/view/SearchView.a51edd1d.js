import{x as a}from"../element-plus/element-plus.85c7c360.js";import{G as e,ax as s,i as l,r as n,Z as i,c as t,P as o,V as r,U as c,u,a as d,T as p,a2 as g,O as m,z as v,o as h,F as y,a7 as f,S as _,n as b,ag as x,aq as j}from"../@vue/@vue.59fec093.js";import{b as C,u as R}from"../vue-router/vue-router.10a7fca4.js";import{s as k}from"../pinia/pinia.81428a33.js";import{t as w,g as z,a as E,u as S,b as L,v as O,j as I,k as M,w as U,x as P,h as A,i as N,C as T,P as F,y as G,z as q,s as V,A as B,_ as D}from"../../assets/index-116bc366.js";import{P as H,_ as J}from"../index.vue_vue_type_style_index_0_scoped_2dc764e5_lang/index.vue_vue_type_style_index_0_scoped_2dc764e5_lang.f03b0795.js";import{O as K}from"../index/index.b7f19c8f.js";import{A as W}from"../index/index.164c0e5b.js";import{A as Z}from"../index/index.b4ed238e.js";import{S as Q}from"../index/index.4fae2fcd.js";import{A as X}from"../index/index.206a1636.js";import{L as Y}from"../index/index.9d918216.js";import{N as $}from"../index/index.5d95a719.js";import{T as aa}from"../index/index.d39b6c60.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";/* empty css                                                                                                                     *//* empty css                                                                                                                     */const ea={class:"search-container scroll-container"},sa=["src"],la={class:"right-singer"},na={class:"singer-name"},ia={class:"singer-info"},ta={class:"song"},oa={class:"header-operation"},ra={class:"lyric-container"},ca={class:"lyric-operation"},ua=["onClick"],da=["onClick"],pa=["onClick"],ga=["onClick"],ma=["onClick"],va={class:"lyric-left"},ha={class:"song-name"},ya={class:"is-vip iconfont"},fa={class:"lyric-center"},_a={class:"lyric-right"},ba=D(e({__name:"SearchView",setup(e){s((a=>({"1bce67ab":u(xa),"71392d9a":u(Ra),"5dc4fb1b":u(Ca),"3136e4dc":u(ja),"242eb93a":u(ka),78037120:u(wa)})));const D=w(),{bgMode:ba}=k(D),xa=v("fontGray"),ja=z().get("shadow"),Ca=z().get("fontColor"),Ra=z().get("themeColor"),ka=l((()=>"skin"==ba.value?"rgba(220, 220, 220, 0.1)":"#ffffff"==(null==Ca?void 0:Ca.value)?"rgba(30, 30, 30, 0.2)":"rgba(220, 220, 220, 0.25)")),wa=l((()=>"skin"==ba.value?"rgba(230, 230, 230, 0.25)":"#ffffff"==(null==Ca?void 0:Ca.value)?"rgba(30, 30, 30, 1)":"rgba(220, 220, 220, 0.8)")),za=R(),Ea=E(),{loveMusicId:Sa,loveSongs:La}=k(Ea),Oa=n(!1),Ia=a=>{Oa.value=a},Ma=()=>{Ba.forEach((a=>{a.isLove=!0;null==Sa.value.get(a.id)&&La.value.push(a)}))},Ua=S(),{songListId:Pa,songList:Aa,current:Na,playProcess:Ta,playTime:Fa,isPlay:Ga}=k(Ua),qa=C().query.keyWord+"",Va=n("song"),Ba=i([]),Da=l((()=>new Map(Ba.map(((a,e)=>[a.id,e]))))),Ha=i([]),Ja=i([]),Ka=i([]),Wa=i([]),Za=i([]),Qa=i([]),Xa=l((()=>Qa.length>0?Qa[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Ya=i([]),$a=l((()=>new Map(Ya.map(((a,e)=>[a.id,e]))))),ae=n(!1),ee=v("firstLoading"),se=i([!1,!1,!1,!1,!1,!1,!1]),le=i([]),ne=n(1),ie=l((()=>"song"==Va.value?30:10)),te=l((()=>"song"==Va.value?Ba:Ya)),oe=l((()=>te.value.slice((ne.value-1)*ie.value,ne.value*ie.value))),re=l((()=>"song"==Va.value?Ba.length:Ya.length)),ce=a=>{ne.value=a},ue=a=>{Va.value=a,"video"==a&&0==Ha.length?L((async()=>{try{const a=await O(1014,100,qa),{result:{videos:e}}=a;e&&e.length>0&&e.forEach((a=>{const{vid:e,title:s,coverUrl:l,creator:n,playTime:i}=a;Ha.push({id:e,name:s,image:l,artist:n[0].userName,playCount:i})}))}catch(a){I(M.ERROR,a.message)}ae.value=!1,se[0]=0==Ha.length}),ae):"mv"==a&&0==Ja.length?L((async()=>{try{const a=await O(1004,100,qa),{result:{mvs:e}}=a;e&&0!=e.length&&e.forEach((a=>{const{id:e,name:s,cover:l,artistName:n,playCount:i}=a;Ja.push({id:e,name:s,image:l,artist:n,playCount:i})}))}catch(a){I(M.ERROR,a.message)}ae.value=!1,se[1]=0==Ja.length}),ae):"album"==a&&0==Ka.length?L((async()=>{try{const a=await O(10,60,qa),{result:{albums:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,publishTime:n,artist:i}=a;Ka.push({id:e,name:s,cover:l,publishTime:U(n),artistId:i.id})}))}catch(a){I(M.ERROR,a.message)}ae.value=!1,se[2]=0==Ka.length}),ae):"radio"==a&&0==Za.length?L((async()=>{try{const a=await O(1009,100,qa),{result:{djRadios:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,playCount:n}=a;Za.push({name:s,id:e,image:l,playCount:n,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){I(M.ERROR,a.message)}ae.value=!1,se[3]=0==Za.length}),ae):"playList"==a&&0==Wa.length?L((async()=>{try{const a=await O(1e3,100,qa),{result:{playlists:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,coverImgUrl:l,playCount:n}=a;Wa.push({id:e,name:s,image:l,playCount:n,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){I(M.ERROR,a.message)}ae.value=!1,se[4]=0==Wa.length}),ae):"lyric"==a&&0==Ya.length&&L((async()=>{try{const a=await O(1006,100,qa),{result:{songs:e}}=a;if(e&&e.length>0){const a=e.map((a=>a.id)).join(","),s=await P(a),{songs:l}=s;l.forEach((a=>{le.push(3),A([],Ya,a)})),e.forEach(((a,e)=>{const{lyrics:{txt:s}}=a;Ya[e].lyric=s.split("\n")})),N(a,Ya),Ea.initLoveMusic(Ba)}}catch(a){I(M.ERROR,a.message)}ae.value=!1,se[6]=0==Ya.length}),ae)};return L((async()=>{try{const a=await O(1,100,qa),{result:{songs:e}}=a;if(e&&e.length>0){const a=e.map((a=>a.id)).join(","),s=await P(a),{songs:l}=s;l.forEach((a=>{A([],Ba,a)})),N(a,Ba),Ea.initLoveMusic(Ba)}}catch(a){I(M.ERROR,a.message)}try{const a=await O(100,100,qa),{result:{artists:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,accountId:n,albumSize:i,mvSize:t}=a;Qa.push({id:e,name:s,avatar:l,score:n,albumSize:i,mvSize:t})})),se[5]=0==Qa.length}catch(a){I(M.ERROR,a.message)}ee.value=!1}),ee),(e,s)=>{const l=a,n=x("No"),i=j("prevent");return h(),t("div",ea,[o(c(u(K),{songs:u(oe),"song-id-mapper":u(Da),onCloseSelect:Ia},null,8,["songs","song-id-mapper"]),[[r,Oa.value]]),o(d("div",{class:"result-singer",onClick:s[1]||(s[1]=a=>u(za).push({name:"artist",query:{id:u(Xa).id,score:u(Xa).score}}))},[d("img",{src:u(Xa).avatar,class:"left-singer"},null,8,sa),d("div",la,[d("h4",na,"歌手："+p(u(Xa).name),1),d("p",ia,[d("span",null,"专辑："+p(u(Xa).albumSize),1),d("span",null,"视频："+p(u(Xa).mvSize),1)])]),c(u(T),{name:u(Xa).isLove?"取消关注":"关注歌手",icon:u(Xa).isLove?"":"","icon-style":u(Xa).isLove?"color:#ff6a6a;":"",onClick:s[0]||(s[0]=g((a=>u(Ea).addLove(u(Xa),u(Ea).loveSinger,u(Ea).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[r,u(Xa).name]]),o(c(u(aa),{onGetActive:ue,active:"song",class:"search-tab"},{content:m((()=>[c(l,{label:"歌曲",name:"song"},{default:m((()=>[d("div",ta,[d("div",oa,[c(u(H),{songs:u(oe)},null,8,["songs"]),c(u(T),{icon:"",onClick:Ma,name:"全部收藏"}),c(u(T),{icon:"",name:"批量操作",onClick:s[2]||(s[2]=a=>Oa.value=!Oa.value)})]),c(u(J),{songs:u(oe),"page-size":u(ie),"song-id-mapper":u(Da)},null,8,["songs","page-size","song-id-mapper"]),o(c(u(F),{"cur-page":ne.value,"page-size":u(ie),total:u(re),onPageChange:ce},null,8,["cur-page","page-size","total"]),[[r,u(ie)<u(re)]])])])),_:1}),c(l,{label:"视频",name:"video"},{default:m((()=>[c(u(Y),{"is-loading":ae.value},null,8,["is-loading"]),o(c(u($),{text:"暂无搜索结果"},null,512),[[r,se[0]]]),o(c(u(X),{mvs:Ha,"show-pagination":!0},null,8,["mvs"]),[[r,!se[0]]])])),_:1}),c(l,{label:"MV",name:"mv"},{default:m((()=>[c(u(Y),{"is-loading":ae.value},null,8,["is-loading"]),o(c(n,{text:"暂无搜索结果"},null,512),[[r,se[1]]]),o(c(u(X),{mvs:Ja,"show-pagination":!0},null,8,["mvs"]),[[r,!se[1]]])])),_:1}),c(l,{label:"专辑",name:"album"},{default:m((()=>[c(u(Y),{"is-loading":ae.value},null,8,["is-loading"]),o(c(u($),{text:"暂无搜索结果"},null,512),[[r,se[2]]]),o(c(u(W),{albums:Ka,"show-pagination":!0},null,8,["albums"]),[[r,!se[2]]])])),_:1}),c(l,{label:"电台",name:"radio"},{default:m((()=>[c(u(Y),{"is-loading":ae.value},null,8,["is-loading"]),o(c(u($),{text:"暂无搜索结果"},null,512),[[r,se[3]]]),o(c(u(Z),{playlists:Za,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[r,!se[3]]])])),_:1}),c(l,{label:"歌单",name:"playList"},{default:m((()=>[c(u(Y),{"is-loading":ae.value},null,8,["is-loading"]),o(c(u($),{text:"暂无搜索结果"},null,512),[[r,se[4]]]),o(c(u(Z),{playlists:Wa,"show-pagination":!0},null,8,["playlists"]),[[r,!se[4]]])])),_:1}),c(l,{label:"歌手",name:"singer"},{default:m((()=>[c(u(Y),{"is-loading":ae.value},null,8,["is-loading"]),o(c(u($),{text:"暂无搜索结果"},null,512),[[r,se[5]]]),o(c(u(Q),{"singer-list":Qa},null,8,["singer-list"]),[[r,!se[5]]])])),_:1}),c(l,{label:"歌词",name:"lyric"},{default:m((()=>[c(u(Y),{"is-loading":ae.value},null,8,["is-loading"]),o(c(u($),{text:"暂无搜索结果"},null,512),[[r,se[6]]]),d("div",ra,[(h(!0),t(y,null,f(u(oe),(a=>{var e;return h(),t("div",{class:"lyric",key:a.id},[d("div",ca,[o((h(),t("span",{class:"iconfont play-music",onClick:e=>(async a=>{if("0"==a.available||"8"==a.available){const e=Pa.value.get(a.id);null==e?(Ea.addRecord(a,Ea.songRecord,Ea.loveMusicId),0==Na.value?(Ga&&(Ga.value=!1),Ta.value=0,Fa.value=0,Aa.value.unshift(a),await b(),Ga.value=!0):(Aa.value.unshift(a),Na.value=0)):Na.value!=e?Na.value=e:Ga.value=!0}else"1"==a.available?I(M.INFO,"此歌曲为vip专属"):"10"==a.available&&I(M.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")})(a)},[_("")],8,ua)),[[i]]),o((h(),t("span",{class:"iconfont music-info",onClick:e=>u(G)(a)},[_("")],8,da)),[[i]]),o((h(),t("span",{class:"iconfont",onClick:e=>u(q)(a)},[_("")],8,pa)),[[i]]),o((h(),t("span",{class:"open-lyric",onClick:e=>{return s=u($a).get(a.id),void(le[s]=le[s]==Ya[s].lyric.length?3:Ya[s].lyric.length);var s}},[_(p(le[u($a).get(a.id)]==(null==(e=a.lyric)?void 0:e.length)?"收起歌词":"展开歌词"),1)],8,ga)),[[i]]),o((h(),t("span",{class:"copy-lyric",onClick:e=>u(V)(a.name+"\r\n"+a.lyric.join("\r\n"),"歌词复制成功！")},[_("复制歌词")],8,ma)),[[i]])]),d("div",va,[d("p",ha,[d("span",null,p(a.name),1),o(d("span",ya,"",512),[[r,"10"==a.available||"1"==a.available]])]),(h(!0),t(y,null,f(a.lyric,((e,s)=>o((h(),t("p",{key:s},p(e.trim()),1)),[[r,s<le[u($a).get(a.id)]]]))),128))]),d("div",fa,[d("span",null,p(a.singer),1)]),d("div",_a,[d("span",null,p(a.album),1),d("span",null,p(u(B)(a.time)),1)])])})),128)),o(c(u(F),{class:"lyric-pagination","cur-page":ne.value,"page-size":u(ie),total:u(re),onPageChange:ce},null,8,["cur-page","page-size","total"]),[[r,u(ie)<u(re)]])])])),_:1})])),_:1},512),[[r,!Oa.value]])])}}}),[["__scopeId","data-v-0dfdd533"]]);export{ba as default};
