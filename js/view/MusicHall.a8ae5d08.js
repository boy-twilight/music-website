import{x as e,y as a}from"../element-plus/element-plus.d1c0be0b.js";import{G as l,ax as s,i as t,r as i,Z as n,c as o,U as u,O as r,u as v,z as c,o as d,P as p,F as m,a7 as h,M as g,V as f}from"../@vue/@vue.59fec093.js";import{g as y,t as _,b as j,K as x,L as b,M as k,j as E,k as R,N as w,d as C,O,_ as I}from"../../static/index-9031b76e.js";/* empty css                                                                                                                     */import{A as S}from"../index/index.57080ef2.js";import{L as U}from"../index/index.ab3ceea1.js";/* empty css                                                                                                                     */import{T as z}from"../index/index.a35437cd.js";import{t as T}from"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../vue-router/vue-router.10a7fca4.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.81428a33.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.57559ed5.js";const F={class:"music-hall-container"},G=["infinite-scroll-disabled"],L=["infinite-scroll-disabled"],N=["infinite-scroll-disabled"],A=I(l({__name:"MusicHall",setup(l){s((e=>({d7e1cdde:v(I),cd249a16:v(M),"1daeab88":v(A),"8da35dac":H.value,"51bef005":v(B),"68eac70d":K.value})));const I=y().get("fontColor"),A=y().get("shadow"),M=c("fontGray"),P=_(),B=t((()=>P.isFullScreen?"76.3vh":"73.3vh")),H=i("0px"),K=i("none"),V=()=>{K.value="none",H.value="0"};let Z=0;const q=T((()=>{"block"!=K.value&&(K.value="block",H.value="6px"),Z&&clearTimeout(Z),Z=setTimeout((()=>{"none"!=K.value&&V()}),3e3)}),600,{leading:!0,trailing:!1}),D=c("firstLoading"),J=i(!1),Q=n([]),W=n([]),X=n([]),Y=i(18),$=i(0),ee=i(!1),ae=async()=>{try{const e=await w(100,X[$.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:t}=e;Q[$.value].push({name:a,id:l,image:s,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){E(R.ERROR,e.message)}0==$.value&&(W[$.value].push(...Q[$.value].slice(0,Y.value)),D.value=!1),J.value&&(J.value=!1)},le=()=>{ee.value=!0,Y.value+=12,Y.value<Q[$.value].length?setTimeout((()=>{W[$.value].push(...Q[$.value].slice(Y.value-12,Y.value)),ee.value=!1}),100):(J.value=!0,$.value<X.length?(Y.value=0,W[$.value].push(...Q[$.value].slice(W[$.value].length)),$.value++,ae(),ee.value=!1):(J.value=!1,E(R.INFO,"已经到底部啦！")))},se=n([]),te=n([]),ie=n([]),ne=i(18),oe=i(0),ue=i(!1),re=async()=>{try{const e=await C(100,ie[oe.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:t}=e;se[oe.value].push({name:a,id:l,image:s,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){E(R.ERROR,e.message)}0==oe.value&&(te[oe.value].push(...se[oe.value].slice(0,ne.value)),D.value=!1),J.value&&(J.value=!1)},ve=()=>{ue.value=!0,ne.value+=12,ne.value<se[$.value].length?setTimeout((()=>{te[oe.value].push(...se[oe.value].slice(ne.value-12,ne.value)),ue.value=!1}),100):(J.value=!0,oe.value<ie.length?(ne.value=0,te[oe.value].push(...se[oe.value].slice(te[oe.value].length)),oe.value++,re(),ue.value=!1):(J.value=!1,E(R.INFO,"已经到底部啦！")))},ce=n([]),de=n([]),pe=i(0),me=i(!1),he=()=>{me.value=!0,J.value=!0,pe.value++,pe.value<de.length?(ge(),me.value=!1):(E(R.SUCCESS,"已经到达底部啦！"),J.value=!1)},ge=async()=>{try{const e=await O(de[pe.value].id),{data:{playlist:a}}=e;a.forEach((e=>{const{id:a,name:l,cover:s,playCount:t}=e;ce[pe.value].push({id:a,name:l,image:s,playCount:t,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){E(R.ERROR,e.message)}0==pe.value&&(D.value=!1),J.value&&(J.value=!1)},fe=e=>{V(),"rec"==e&&0==se[0].length?(D.value=!0,re()):"style"==e&&0==ce[0].length&&(D.value=!0,ge())};return j((async()=>{try{(await Promise.all([x(),b(),k()])).forEach(((e,a)=>{if(0==a){const{tags:a}=e;X.push(...a.map((e=>e.name))),X.forEach((()=>{Q.push([]),W.push([])}))}else if(1==a){const{sub:a}=e;ie.push(...a.map((e=>e.name))),ie.forEach((()=>{se.push([]),te.push([])}))}else if(2==a){const{data:a}=e;a.forEach((e=>{const{tagId:a,tagName:l}=e;de.push({id:a,name:l}),ce.push([])}))}}))}catch(e){E(R.ERROR,e.message)}await ae(),D.value=!1}),D),(l,s)=>{const t=e,i=a;return d(),o("div",F,[u(v(z),{active:"top",onGetActive:fe},{content:r((()=>[u(t,{label:"精选歌单",name:"top"},{default:r((()=>[p((d(),o("div",{class:"container scroll-container",onScroll:s[0]||(s[0]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ee.value,style:{overflow:"auto"}},[(d(!0),o(m,null,h(W,((e,a)=>p((d(),g(v(S),{key:X[a],title:X[a],playlists:e},null,8,["title","playlists"])),[[f,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,G)),[[i,le]])])),_:1}),u(t,{label:"网友推荐",name:"rec"},{default:r((()=>[p((d(),o("div",{class:"container scroll-container",onScroll:s[1]||(s[1]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ue.value,style:{overflow:"auto"}},[(d(!0),o(m,null,h(te,((e,a)=>p((d(),g(v(S),{key:ie[a],title:ie[a],playlists:e},null,8,["title","playlists"])),[[f,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,L)),[[i,ve]])])),_:1}),u(t,{label:"浪漫曲风",name:"style"},{default:r((()=>[p((d(),o("div",{class:"container scroll-container",onScroll:s[2]||(s[2]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":me.value,style:{overflow:"auto"}},[(d(!0),o(m,null,h(ce,((e,a)=>p((d(),g(v(S),{key:de[a].id,title:de[a].name,playlists:e},null,8,["title","playlists"])),[[f,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,N)),[[i,he]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-2b711246"]]);export{A as default};
