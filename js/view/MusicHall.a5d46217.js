import{x as e,y as a}from"../element-plus/element-plus.70abbed3.js";import{G as l,ax as s,d as i,Z as t,c as o,U as n,O as u,u as r,o as c,P as v,F as p,a7 as d,M as m,V as h,z as y}from"../@vue/@vue.7ad02ad1.js";import{u as g,J as f,g as _,K as j,L as b,M as x,m as E,i as R,N as w,c as C,O as k,_ as S}from"../../static/index-93562299.js";/* empty css                                                                                                                     */import{A as O}from"../index/index.59f22b8c.js";import{L as I}from"../index/index.0bc01097.js";/* empty css                                                                                                                     */import{T as U}from"../index/index.aa4e95c9.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../vue-router/vue-router.53ff932e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const z={class:"music-hall-container"},N=["infinite-scroll-disabled"],F=["infinite-scroll-disabled"],G=["infinite-scroll-disabled"],H=S(l({__name:"MusicHall",setup(l){s((e=>({"0cdb7c84":r(S),"84877eb0":r(L),f99c5796:r(H),"59bda036":r(T),"01da22f2":r(M),"81fc7d62":r(A)})));const{fontColor:S,boxShadow:H,fontGray:L,containerHeight:M}=g(),{scrollBarWidth:T,scrollVisible:A,autoHideScrollbar:K,hideScrollbar:P}=f(),V=y("firstLoading"),B=i(!1),D=t([]),J=t([]),W=t([]),Z=i(18),q=i(0),Q=i(!1),X=async()=>{try{const e=await w(100,W[q.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:i}=e;D[q.value].push({name:a,id:l,image:s,playCount:i,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){E(R.ERROR,e.message)}0==q.value&&(J[q.value].push(...D[q.value].slice(0,Z.value)),V.value=!1),B.value&&(B.value=!1)},Y=()=>{Q.value=!0,Z.value+=12,Z.value<D[q.value].length?setTimeout((()=>{J[q.value].push(...D[q.value].slice(Z.value-12,Z.value)),Q.value=!1}),100):(B.value=!0,q.value<W.length?(Z.value=0,J[q.value].push(...D[q.value].slice(J[q.value].length)),q.value++,X(),Q.value=!1):(B.value=!1,E(R.INFO,"已经到底部啦！")))},$=t([]),ee=t([]),ae=t([]),le=i(18),se=i(0),ie=i(!1),te=async()=>{try{const e=await C(100,ae[se.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:i}=e;$[se.value].push({name:a,id:l,image:s,playCount:i,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){E(R.ERROR,e.message)}0==se.value&&(ee[se.value].push(...$[se.value].slice(0,le.value)),V.value=!1),B.value&&(B.value=!1)},oe=()=>{ie.value=!0,le.value+=12,le.value<$[q.value].length?setTimeout((()=>{ee[se.value].push(...$[se.value].slice(le.value-12,le.value)),ie.value=!1}),100):(B.value=!0,se.value<ae.length?(le.value=0,ee[se.value].push(...$[se.value].slice(ee[se.value].length)),se.value++,te(),ie.value=!1):(B.value=!1,E(R.INFO,"已经到底部啦！")))},ne=t([]),ue=t([]),re=i(0),ce=i(!1),ve=()=>{ce.value=!0,B.value=!0,re.value++,re.value<ue.length?(pe(),ce.value=!1):(E(R.SUCCESS,"已经到达底部啦！"),B.value=!1)},pe=async()=>{try{const e=await k(ue[re.value].id),{data:{playlist:a}}=e;a.forEach((e=>{const{id:a,name:l,cover:s,playCount:i}=e;ne[re.value].push({id:a,name:l,image:s,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){E(R.ERROR,e.message)}0==re.value&&(V.value=!1),B.value&&(B.value=!1)},de=e=>{P(),"rec"==e&&0==$[0].length?(V.value=!0,te()):"style"==e&&0==ne[0].length&&(V.value=!0,pe())};return _((async()=>{try{(await Promise.all([j(),b(),x()])).forEach(((e,a)=>{if(0==a){const{tags:a}=e;W.push(...a.map((e=>e.name))),W.forEach((()=>{D.push([]),J.push([])}))}else if(1==a){const{sub:a}=e;ae.push(...a.map((e=>e.name))),ae.forEach((()=>{$.push([]),ee.push([])}))}else if(2==a){const{data:a}=e;a.forEach((e=>{const{tagId:a,tagName:l}=e;ue.push({id:a,name:l}),ne.push([])}))}}))}catch(e){E(R.ERROR,e.message)}await X(),V.value=!1}),V),(l,s)=>{const i=e,t=a;return c(),o("div",z,[n(r(U),{active:"top",onGetActive:de},{content:u((()=>[n(i,{label:"精选歌单",name:"top"},{default:u((()=>[v((c(),o("div",{class:"container scroll-container",onScroll:s[0]||(s[0]=e=>r(K)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":Q.value,style:{overflow:"auto"}},[(c(!0),o(p,null,d(J,((e,a)=>v((c(),m(r(O),{key:W[a],title:W[a],playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),n(r(I),{"is-loading":B.value},null,8,["is-loading"])],40,N)),[[t,Y]])])),_:1}),n(i,{label:"网友推荐",name:"rec"},{default:u((()=>[v((c(),o("div",{class:"container scroll-container",onScroll:s[1]||(s[1]=e=>r(K)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ie.value,style:{overflow:"auto"}},[(c(!0),o(p,null,d(ee,((e,a)=>v((c(),m(r(O),{key:ae[a],title:ae[a],playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),n(r(I),{"is-loading":B.value},null,8,["is-loading"])],40,F)),[[t,oe]])])),_:1}),n(i,{label:"浪漫曲风",name:"style"},{default:u((()=>[v((c(),o("div",{class:"container scroll-container",onScroll:s[2]||(s[2]=e=>r(K)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ce.value,style:{overflow:"auto"}},[(c(!0),o(p,null,d(ne,((e,a)=>v((c(),m(r(O),{key:ue[a].id,title:ue[a].name,playlists:e},null,8,["title","playlists"])),[[h,e.length>0]]))),128)),n(r(I),{"is-loading":B.value},null,8,["is-loading"])],40,G)),[[t,ve]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-8cf18b66"]]);export{H as default};
