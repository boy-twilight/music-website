import{x as a,h as e,y as s}from"../element-plus/element-plus.93eaa55f.js";import{G as t,ax as o,Z as i,i as l,d as n,M as r,O as c,u as m,o as p,a as d,P as u,V as v,U as g,T as y,c as _,a7 as h,F as f,R as j,z as x}from"../@vue/@vue.7ad02ad1.js";import{b}from"../vue-router/vue-router.53ff932e.js";import{u as k,j as C,g as L,k as P,l as w,n as z,f as R,h as U,o as I,m as S,i as E,p as M,q as O,r as q,C as G,P as F,S as H,s as T,_ as V}from"../../static/index-5203d642.js";import{O as $}from"../index/index.ef2dd8dc.js";import{M as B}from"../index/index.390900a1.js";import{P as J,_ as K}from"../index.vue_vue_type_style_index_0_scoped_c70cb44b_lang/index.vue_vue_type_style_index_0_scoped_c70cb44b_lang.40b36b17.js";/* empty css                                                                                                                     */import{N}from"../index/index.539ac15d.js";import{T as Z}from"../index/index.2343545c.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const A={class:"playlist-container scroll-container"},D={class:"header"},Q=["src"],W={class:"right"},X={class:"title"},Y={class:"creator"},aa={class:"creator-name"},ea={class:"tag"},sa={class:"description"},ta={class:"header-operation"},oa=V(t({__name:"PlayListView",setup(t){o((a=>({"9bcadeba":m(V),"9bea1d82":m(oa),"3bba231a":m(ia),"99a7fdba":m(la)})));const{fontColor:V,fontBlack:oa,boxShadow:ia,fontGray:la,contentHeight:na}=k(),ra=C(),ca=b(),ma=ca.query.id+"",pa=ca.query.type+"",da=i({id:ma,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),ua=i([]),va=i([]),ga=l((()=>new Map(ua.map(((a,e)=>[a.id,e]))))),ya=n(1),_a=n(30),ha=l((()=>ua.slice((ya.value-1)*_a.value,ya.value*_a.value))),fa=l((()=>ua.length)),ja=x("firstLoading"),xa=n(!1),ba=n(!1),ka=a=>{ya.value=a},Ca=a=>{xa.value=a},La=a=>{xa.value=a},Pa=()=>{T("我有一个精品歌单分享给你："+da.name+"，地址：https://www.liyinchao.cloud"+ca.fullPath)},wa=()=>{"playlist"==pa?ra.addLove(da,ra.lovePlaylist,ra.lovePlaylistId):ra.addLove(da,ra.loveRadio,ra.loveRadioId)};return L((async()=>{if("playlist"==pa)try{(await Promise.all([P(ma),w(ma),z(ma,100)])).forEach(((a,e)=>{if(0==e){const{playlist:{name:e,coverImgUrl:s,description:t,tags:o,creator:i,playCount:l}}=a;da.name=e,da.image=s,da.description=t,da.tag=o,da.creator.avatarUrl=i.avatarUrl,da.creator.nickname=i.nickname,da.playCount=l,ra.initLoveStatus(da,ra.lovePlaylistId)}else if(1==e){const{songs:e}=a;e.forEach((a=>{R(ua,a)})),ra.initLoveMusic(ua),U(ua)}else if(2==e){const{comments:e,hotComments:s}=a;I(s,va),I(e,va),ba.value=0==va.length}}))}catch(a){S(E.ERROR,a.message)}else{try{(await Promise.all([M(ma),O(ma,100)])).forEach(((a,e)=>{if(0==e){const{data:{name:e,dj:{avatarUrl:s,nickname:t},picUrl:o,desc:i,subCount:l}}=a;da.name=e,da.id=ma,da.description=i,da.image=o,da.playCount=l,da.creator.nickname=t,da.creator.avatarUrl=s,ra.initLoveStatus(da,ra.loveRadioId)}else if(1==e){const{programs:e}=a;e.forEach((a=>{const{mainSong:{name:e,id:s,fee:t,artists:o,album:{name:i,picUrl:l},duration:n}}=a;ua.push({id:s,name:e,singer:o[0].name,songImage:l,album:i,available:t,time:n})})),ra.initLoveMusic(ua),U(ua)}}))}catch(a){S(E.ERROR,a.message)}q(ma,"7",va,(()=>{ba.value=0==va.length}))}ja.value=!1}),ja),(t,o)=>{const i=e,l=s,n=a;return p(),r(n,{"max-height":m(na)},{default:c((()=>[d("div",A,[u(g(m($),{"song-id-mapper":m(ga),songs:m(ha),onCloseSelect:Ca},null,8,["song-id-mapper","songs"]),[[v,xa.value]]),u(d("div",D,[d("img",{src:da.image,class:"left-image"},null,8,Q),d("div",W,[d("p",X,y(da.name),1),d("div",Y,[g(i,{src:da.creator.avatarUrl},null,8,["src"]),d("span",aa,y(da.creator.nickname),1),d("div",ea,[(p(!0),_(f,null,h(da.tag,(a=>(p(),_("span",{key:a},"#"+y(a),1)))),128))])]),d("p",sa,y(da.description),1),d("div",ta,[g(m(J),{songs:m(ha)},null,8,["songs"]),g(m(G),{name:da.isLove?"取消收藏":"收藏",icon:da.isLove?"":"","icon-style":da.isLove?"color:#ff6a6a;":"",onClick:wa},null,8,["name","icon","icon-style"]),xa.value?j("",!0):(p(),r(m(B),{key:0,"share-to":Pa,onOpenSelect:La}))])])],512),[[v,!xa.value]]),u(g(m(Z),{active:"song",class:"playlist-tab"},{content:c((()=>[g(l,{label:`歌曲 ${ua.length}`,name:"song"},{default:c((()=>[g(m(K),{songs:m(ha),"page-size":_a.value,"song-id-mapper":m(ga)},null,8,["songs","page-size","song-id-mapper"]),u(g(m(F),{"cur-page":ya.value,"page-size":_a.value,total:m(fa),onPageChange:ka},null,8,["cur-page","page-size","total"]),[[v,_a.value<m(fa)]])])),_:1},8,["label"]),g(l,{label:`评论 ${va.length<10?va.length+10:va.length}`,name:"comment"},{default:c((()=>[ba.value?(p(),r(m(N),{key:1,size:280,text:"暂无评论数据"})):(p(),r(m(H),{key:0,comments:va},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[v,!xa.value]])])])),_:1},8,["max-height"])}}}),[["__scopeId","data-v-f6b16ef3"]]);export{oa as default};
