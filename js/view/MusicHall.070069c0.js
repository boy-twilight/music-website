import{x as e,y as a}from"../element-plus/element-plus.85c7c360.js";import{G as l,ax as s,i as t,r as i,Z as n,c as o,U as u,O as r,u as v,z as c,o as p,P as d,F as m,a7 as h,M as g,V as y}from"../@vue/@vue.59fec093.js";import{g as f,t as _,b as j,K as x,e as b,d as R,L as E,M as w,N as k,f as O,O as C,_ as I}from"../../assets/index-0f5abafb.js";/* empty css                                                                                                                     */import{A as S}from"../index/index.07740bc6.js";import{L as U}from"../index/index.fc86a6dd.js";/* empty css                                                                                                                     */import{T as z}from"../index/index.7e48a06b.js";import{t as T}from"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../vue-router/vue-router.10a7fca4.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.81428a33.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";const F={class:"music-hall-container"},G=["infinite-scroll-disabled"],L=["infinite-scroll-disabled"],N=["infinite-scroll-disabled"],A=I(l({__name:"MusicHall",setup(l){s((e=>({"64961e66":v(I),"97e0188e":v(M),57548344:v(A),"737793ee":K.value,"307b0ac1":v(H),"63ffe6d1":P.value})));const I=f().get("fontColor"),A=f().get("shadow"),M=c("fontGray"),B=_(),H=t((()=>B.isFullScreen?"76.3vh":"73.3vh")),K=i("0px"),P=i("none"),V=()=>{P.value="none",K.value="0"};let Z=0;const q=T((()=>{"block"!=P.value&&(P.value="block",K.value="6px"),Z&&clearTimeout(Z),Z=setTimeout((()=>{"none"!=P.value&&V()}),3e3)}),600,{leading:!0,trailing:!1}),D=c("firstLoading"),J=i(!1),Q=n([]),W=n([]),X=n([]),Y=i(18),$=i(0),ee=i(!1),ae=async()=>{try{const e=await k(100,X[$.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:t}=e;Q[$.value].push({name:a,id:l,image:s,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){b(R.ERROR,e.message)}0==$.value&&(W[$.value].push(...Q[$.value].slice(0,Y.value)),D.value=!1),J.value&&(J.value=!1)},le=()=>{ee.value=!0,Y.value+=12,Y.value<Q[$.value].length?setTimeout((()=>{W[$.value].push(...Q[$.value].slice(Y.value-12,Y.value)),ee.value=!1}),100):(J.value=!0,$.value<X.length?(Y.value=0,W[$.value].push(...Q[$.value].slice(W[$.value].length)),$.value++,ae(),ee.value=!1):(J.value=!1,b(R.INFO,"已经到底部啦！")))},se=n([]),te=n([]),ie=n([]),ne=i(18),oe=i(0),ue=i(!1),re=async()=>{try{const e=await O(100,ie[oe.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:t}=e;se[oe.value].push({name:a,id:l,image:s,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){b(R.ERROR,e.message)}0==oe.value&&(te[oe.value].push(...se[oe.value].slice(0,ne.value)),D.value=!1),J.value&&(J.value=!1)},ve=()=>{ue.value=!0,ne.value+=12,ne.value<se[$.value].length?setTimeout((()=>{te[oe.value].push(...se[oe.value].slice(ne.value-12,ne.value)),ue.value=!1}),100):(J.value=!0,oe.value<ie.length?(ne.value=0,te[oe.value].push(...se[oe.value].slice(te[oe.value].length)),oe.value++,re(),ue.value=!1):(J.value=!1,b(R.INFO,"已经到底部啦！")))},ce=n([]),pe=n([]),de=i(0),me=i(!1),he=()=>{me.value=!0,J.value=!0,de.value++,de.value<pe.length?(ge(),me.value=!1):(b(R.SUCCESS,"已经到达底部啦！"),J.value=!1)},ge=async()=>{try{const e=await C(pe[de.value].id),{data:{playlist:a}}=e;a.forEach((e=>{const{id:a,name:l,cover:s,playCount:t}=e;ce[de.value].push({id:a,name:l,image:s,playCount:t,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){b(R.ERROR,e.message)}0==de.value&&(D.value=!1),J.value&&(J.value=!1)},ye=e=>{V(),"rec"==e&&0==se[0].length?(D.value=!0,re()):"style"==e&&0==ce[0].length&&(D.value=!0,ge())};return j((async()=>{try{const e=await x(),{tags:a}=e;X.push(...a.map((e=>e.name))),X.forEach((()=>{Q.push([]),W.push([])}))}catch(e){b(R.ERROR,e.message)}try{const e=await E(),{sub:a}=e;ie.push(...a.map((e=>e.name))),ie.forEach((()=>{se.push([]),te.push([])}))}catch(e){b(R.ERROR,e.message)}try{const e=await w(),{data:a}=e;a.forEach((e=>{const{tagId:a,tagName:l}=e;pe.push({id:a,name:l}),ce.push([])}))}catch(e){b(R.ERROR,e.message)}ae()}),D),(l,s)=>{const t=e,i=a;return p(),o("div",F,[u(v(z),{active:"top",onGetActive:ye},{content:r((()=>[u(t,{label:"精选歌单",name:"top"},{default:r((()=>[d((p(),o("div",{class:"container scroll-container",onScroll:s[0]||(s[0]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ee.value,style:{overflow:"auto"}},[(p(!0),o(m,null,h(W,((e,a)=>d((p(),g(v(S),{key:X[a],title:X[a],playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,G)),[[i,le]])])),_:1}),u(t,{label:"网友推荐",name:"rec"},{default:r((()=>[d((p(),o("div",{class:"container scroll-container",onScroll:s[1]||(s[1]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ue.value,style:{overflow:"auto"}},[(p(!0),o(m,null,h(te,((e,a)=>d((p(),g(v(S),{key:ie[a],title:ie[a],playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,L)),[[i,ve]])])),_:1}),u(t,{label:"浪漫曲风",name:"style"},{default:r((()=>[d((p(),o("div",{class:"container scroll-container",onScroll:s[2]||(s[2]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":me.value,style:{overflow:"auto"}},[(p(!0),o(m,null,h(ce,((e,a)=>d((p(),g(v(S),{key:pe[a].id,title:pe[a].name,playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,N)),[[i,he]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-59430509"]]);export{A as default};
