import{h as e}from"../element-plus/element-plus.70abbed3.js";import{G as a,ax as s,d as o,Z as t,i,y as l,c as n,a as r,U as c,O as m,W as d,T as p,P as u,V as v,u as y,S as h,o as f,F as j,a7 as g,ay as _,az as C,z as b,n as k,aq as x}from"../@vue/@vue.7ad02ad1.js";import{b as w,u as V}from"../vue-router/vue-router.53ff932e.js";import{u as R,j as S,g as T,A as E,B as I,D as q,E as z,v as L,m as N,i as O,o as P,F as A,G as D,H as F,I as G,C as U,S as Z,s as B,_ as H}from"../../static/index-6eb5ac45.js";import{D as W}from"../dplayer/dplayer.beff636d.js";/* empty css                                                                                                                     */import{A as J}from"../index/index.f206099b.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const K=e=>(_("data-v-0845e4b4"),e=e(),C(),e),M={class:"video-container scroll-container"},Q={class:"players-container"},X={class:"recommend-container"},Y={class:"content"},$={class:"mask"},ee=["onClick"],ae=K((()=>r("div",{class:"players"},null,-1))),se={class:"detail"},oe={class:"title"},te={class:"artist-info"},ie={class:"operation"},le={class:"comment-area"},ne=K((()=>r("h4",{class:"title"},"全部评论",-1))),re=K((()=>r("span",{class:"iconfont_1"}," ",-1))),ce=H(a({__name:"VideoPlayView",setup(a){s((e=>({"759090d8":y(_),"75afcfa0":y(C),b9748fdc:y(ce),"4307367c":y(me),"4ed74a0b":y(H),"4e483bda":y(K)})));const{fontColor:_,fontBlack:C,boxShadow:H,themeColor:K,fontGray:ce,videoHeight:me}=R(),de=S(),pe=o(),ue=w(),ve=V(),ye=ue.query.id+"",he=t({id:ye,name:"",image:"",artist:"",playCount:"",url:"",time:"",publishTime:"",available:""}),fe=t([]),je=i((()=>[he,...fe])),ge=b("firstLoading"),_e=o(!1),Ce=t([]),be=o(!1),ke=()=>{B("我在https://www.liyinchao.cloud"+ue.fullPath+"观看"+he.name+",快来和我一起观看把！")};return T((async()=>{if(/.*[A-Z]+.*/.test(ye))try{(await Promise.all([A(ye),D(ye),F(ye),G(ye,1e3)])).forEach(((e,a)=>{if(0==a){const{data:{title:a,coverUrl:s,publishTime:o,playTime:t,creator:i}}=e;he.name=a,he.image=s,he.playCount=t,he.publishTime=L(o),he.artist=i.nickname}else if(1==a){const{urls:a}=e;a?he.url=a[0].url:N(O.INFO,"此视频暂无播放资源，请切换下一个。")}else if(2==a){const{data:a}=e;a.forEach((e=>{const{title:a,coverUrl:s,vid:o,playTime:t,creator:i}=e;fe.push({id:o,name:a,image:s,playCount:t,artist:i[0].userName})}))}else if(3==a){const{comments:a,hotComments:s}=e;P(s,Ce),P(a,Ce)}}))}catch(e){N(O.ERROR,e.message)}else try{(await Promise.all([E(ye),I(ye),q(ye),z(ye,1e3)])).forEach(((e,a)=>{if(0==a){const{data:{name:a,artistName:s,cover:o,playCount:t,duration:i,publishTime:l}}=e;he.name=a,he.playCount=t,he.image=o,he.artist=s,he.time=i,he.publishTime=L(l)}else if(1==a){const{data:{url:a,fee:s}}=e;a?(he.url=a,he.available=s):N(O.INFO,"此视频暂无播放资源，请切换下一个。")}else if(2==a){const{mvs:a}=e;a&&a.forEach((e=>{const{id:a,cover:s,name:o,artistName:t,playCount:i}=e;fe.push({id:a,image:s,name:o,artist:t,playCount:i})}))}else if(3==a){const{comments:a,hotComments:s}=e;P(s,Ce),P(a,Ce)}}))}catch(e){N(O.ERROR,e.message)}de.addRecord(he,de.videoRecord,de.videoRecordId),de.initLoveStatus(he,de.loveVideoId),(async()=>{await k(),pe.value=new W({container:document.querySelector(".players"),video:{url:he.url,thumbnails:he.image,type:"video/mp4",pic:he.image},autoplay:!1,loop:!1,hotkey:!0,theme:null==K?void 0:K.value,chromecast:!0,lang:"zh-cn",screenshot:!0,preload:"auto",volume:.9,playbackSpeed:[.75,1,1.25,1.5,1.75,2],contextmenu:[{text:"下载",click:()=>{de.addVideoDownload(he)}},{text:"收藏",click:()=>{de.addLove(he,de.loveVideo,de.loveVideoId)}},{text:"分享",click:()=>{ke()}}]}),document.querySelector(".dplayer-video").onended=()=>{_e.value=!0}})(),ge.value=!1}),ge),l((()=>{var e;document.querySelector(".dplayer-video").onended=null,null==(e=pe.value)||e.destroy()})),(a,s)=>{const o=e,t=x("prevent");return f(),n("div",M,[r("div",Q,[c(d,{name:"show"},{default:m((()=>[u(r("div",X,[u(r("h4",null,"相关推荐",512),[[v,y(je).length>1]]),r("div",Y,[(f(!0),n(j,null,g(y(je),((e,a)=>(f(),n("div",{class:"recommend-video",key:e.id},[c(o,{src:e.image,class:"image"},null,8,["src"]),r("div",$,[u((f(),n("span",{class:"iconfont play",onClick:s=>((e,a)=>{0==e?(_e.value=!1,document.querySelector(".dplayer-video").play()):ve.push({name:"video",query:{id:a}})})(a,e.id)},[h("")],8,ee)),[[t]])])])))),128))])],512),[[v,_e.value]])])),_:1}),ae]),r("div",se,[r("p",oe,p(he.name),1),r("div",te,[r("span",null,p(/.*[A-Z]+.*/.test(ye)?"创作者："+he.artist:"演唱："+he.artist),1),r("span",null,p(he.playCount)+"次观看",1),r("span",null,"发布时间："+p(he.publishTime),1)]),u(r("div",ie,[c(y(U),{name:he.isLove?"取消收藏":"收藏",icon:he.isLove?"":"","icon-style":he.isLove?"color:#ff6a6a;":"",onClick:s[0]||(s[0]=e=>y(de).addLove(he,y(de).loveVideo,y(de).loveVideoId)),class:"operate"},null,8,["name","icon","icon-style"]),c(y(U),{name:"下载",onClick:s[1]||(s[1]=e=>y(de).addVideoDownload(he)),icon:"",class:"operate"}),c(y(U),{name:"分享",icon:"",onClick:ke,class:"operate"}),c(y(U),{name:"评论",icon:"",onClick:s[2]||(s[2]=e=>be.value=!0),class:"operate"})],512),[[v,!be.value]])]),u(c(y(J),{mvs:fe,title:"相关推荐"},null,8,["mvs"]),[[v,!be.value&&fe.length>0]]),u(r("div",le,[ne,r("button",{class:"exit",onClick:s[3]||(s[3]=e=>be.value=!1)},[re,h(" 退出 ")]),c(y(Z),{comments:Ce},null,8,["comments"])],512),[[v,be.value]])])}}}),[["__scopeId","data-v-0845e4b4"]]);export{ce as default};
