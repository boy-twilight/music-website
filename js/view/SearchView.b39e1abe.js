import{x as e,y as a}from"../element-plus/element-plus.79622da4.js";import{G as s,ax as l,d as i,Z as n,i as t,M as o,O as r,u as c,o as u,a as m,P as p,V as g,U as d,T as v,a2 as h,c as y,a7 as f,S as _,F as x,z as j,ag as b,aq as C}from"../@vue/@vue.7ad02ad1.js";import{b as w,u as k}from"../vue-router/vue-router.53ff932e.js";import{s as R}from"../pinia/pinia.07d51cb2.js";import{u as z,i as E,a as S,r as L,t as U,e as O,f as M,m as I,h as P,C as N,P as T,v as A,w as q,s as B,x as G,O as V,L as F,y as H,_ as D}from"../../static/index-14646868.js";import{P as J,_ as K}from"../index.vue_vue_type_style_index_0_scoped_f0a13ca2_lang/index.vue_vue_type_style_index_0_scoped_f0a13ca2_lang.aebb3855.js";import{O as W}from"../index/index.c68ce622.js";import{A as Z}from"../index/index.a46ebc4b.js";import{A as Q}from"../index/index.24857fb6.js";import{S as X}from"../index/index.8c95359e.js";import{A as Y}from"../index/index.134e1385.js";import{L as $}from"../index/index.7567e585.js";import{N as ee}from"../index/index.ae326d5b.js";import{T as ae}from"../index/index.be964c65.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";/* empty css                                                                                                                     *//* empty css                                                                                                                     */const se={class:"search-container scroll-container"},le=["src"],ie={class:"right-singer"},ne={class:"singer-name"},te={class:"singer-info"},oe={class:"song"},re={class:"header-operation"},ce={class:"lyric-container"},ue={class:"lyric-operation"},me=["onClick"],pe=["onClick"],ge=["onClick"],de=["onClick"],ve=["onClick"],he={class:"lyric-left"},ye={class:"song-name"},fe={class:"is-vip iconfont"},_e={class:"lyric-center"},xe={class:"lyric-right"},je=D(s({__name:"SearchView",setup(s){l((e=>({"040b0914":c(D),"624c9384":c(Ce),"7dc93ea0":c(je),"4abaf327":c(be),"065acd05":c(we),b3ab498a:c(ke)})));const{fontGray:D,fontColor:je,boxShadow:be,themeColor:Ce,singerBg:we,buttonBg:ke,contentHeight:Re}=z(),ze=k(),Ee=E(),{loveMusicId:Se,loveSongs:Le}=R(Ee),Ue=w().query.keyWord+"",Oe=i("song"),Me=n([]),Ie=n([]),Pe=n([]),Ne=n([]),Te=n([]),Ae=n([]),qe=n([]),Be=t((()=>qe.length>0?qe[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Ge=n([]),Ve=t((()=>new Map(Ge.map(((e,a)=>[e.id,a]))))),Fe=i(!1),He=j("firstLoading"),De=n(new Map([["video",!0],["mv",!0],["album",!0],["radio",!0],["playList",!0],["lyric",!0],["singer",!0]])),Je=n([]),Ke=i(!1),We=i(),Ze=i(1),Qe=t((()=>"song"==Oe.value?V:F)),Xe=t((()=>"song"==Oe.value?Me:Ge)),Ye=t((()=>Xe.value.slice((Ze.value-1)*Qe.value,Ze.value*Qe.value))),$e=t((()=>"song"==Oe.value?Me.length:Ge.length)),ea=()=>{Me.forEach((e=>{e.isLove=!0;null==Se.value.get(e.id)&&Le.value.push(e)}))},{playMusic:aa}=S(),sa=async e=>{if(Oe.value=e,"video"==e){if(0!=Ie.length)return;Fe.value=!0;try{const e=await L(1014,100,Ue),{result:{videos:a}}=e;a&&a.length>0&&a.forEach((e=>{const{vid:a,title:s,coverUrl:l,creator:i,playTime:n}=e;Ie.push({id:a,name:s,image:l,artist:i[0].userName,playCount:n})}))}catch(a){I(P.ERROR,a.message)}De.set("video",0==Ie.length)}else if("mv"==e){if(0!=Pe.length)return;Fe.value=!0;try{const e=await L(1004,100,Ue),{result:{mvs:a}}=e;a&&0!=a.length&&a.forEach((e=>{const{id:a,name:s,cover:l,artistName:i,playCount:n}=e;Pe.push({id:a,name:s,image:l,artist:i,playCount:n})}))}catch(a){I(P.ERROR,a.message)}De.set("mv",0==Pe.length)}else if("album"==e){if(0!=Ne.length)return;Fe.value=!0;try{const e=await L(10,60,Ue),{result:{albums:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,picUrl:l,publishTime:i,artist:n}=e;Ne.push({id:a,name:s,cover:l,publishTime:H(i),artistId:n.id})}))}catch(a){I(P.ERROR,a.message)}De.set("mv",0==Ne.length)}else if("radio"==e){if(0!=Ae.length)return;Fe.value=!0;try{const e=await L(1009,100,Ue),{result:{djRadios:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,picUrl:l,playCount:i}=e;Ae.push({name:s,id:a,image:l,playCount:i,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){I(P.ERROR,a.message)}De.set("radio",0==Ae.length)}else if("playList"==e&&0==Te.length){if(0!=Te.length)return;Fe.value=!0;try{const e=await L(1e3,100,Ue),{result:{playlists:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,coverImgUrl:l,playCount:i}=e;Te.push({id:a,name:s,image:l,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){I(P.ERROR,a.message)}De.set("radio",0==Te.length)}else if("lyric"==e){if(0!=Ge.length)return;Fe.value=!0;try{const e=await L(1006,100,Ue),{result:{songs:a}}=e;if(a&&a.length>0){const e=a.map((e=>e.id)).join(","),s=await U(e),{songs:l}=s;l.forEach((e=>{Je.push(3),O(Ge,e)})),a.forEach(((e,a)=>{const{lyrics:{txt:s}}=e;Ge[a].lyric=s.split("\n")})),M(Ge),Ee.initLoveMusic(Me)}}catch(a){I(P.ERROR,a.message)}De.set("lyric",0==Ge.length)}Fe.value=!1};return(async()=>{He.value=!0;try{(await Promise.all([L(1,100,Ue),L(100,100,Ue)])).forEach((async(e,a)=>{if(0==a){const{result:{songs:a}}=e;if(a&&a.length>0){const e=a.map((e=>e.id)).join(","),s=await U(e),{songs:l}=s;l.forEach((e=>{O(Me,e)})),M(Me),Ee.initLoveMusic(Me)}}else if(1==a){const{result:{artists:a}}=e;if(a&&a.length>0){const e=a.map((e=>{const{id:a,name:s,picUrl:l,accountId:i,albumSize:n,mvSize:t}=e;return{id:a,name:s,avatar:l,score:i,albumSize:n,mvSize:t}}));qe.push(...e)}De.set("singer",0==qe.length)}}))}catch(e){I(P.ERROR,e.message)}He.value=!1})(),(s,l)=>{const i=a,n=b("No"),t=e,j=C("prevent");return u(),o(t,{"max-height":c(Re)},{default:r((()=>[m("div",se,[p(d(c(W),{songs:c(Ye),"show-select":Ke.value,"onUpdate:showSelect":l[0]||(l[0]=e=>Ke.value=e),ref_key:"batch",ref:We},null,8,["songs","show-select"]),[[g,Ke.value]]),p(m("div",{class:"result-singer",onClick:l[2]||(l[2]=e=>c(ze).push({name:"artist",query:{id:c(Be).id,score:c(Be).score}}))},[m("img",{src:c(Be).avatar,class:"left-singer"},null,8,le),m("div",ie,[m("h4",ne,"歌手："+v(c(Be).name),1),m("p",te,[m("span",null,"专辑："+v(c(Be).albumSize),1),m("span",null,"视频："+v(c(Be).mvSize),1)])]),d(c(N),{name:c(Be).isLove?"取消关注":"关注歌手",icon:c(Be).isLove?"":"","icon-style":c(Be).isLove?"color:#ff6a6a;":"",onClick:l[1]||(l[1]=h((e=>c(Ee).addLove(c(Be),c(Ee).loveSinger,c(Ee).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[g,c(Be).name&&!Ke.value]]),p(d(c(ae),{onGetActive:sa,active:"song",class:"search-tab"},{content:r((()=>[d(i,{label:"歌曲",name:"song"},{default:r((()=>[m("div",oe,[m("div",re,[d(c(J),{songs:c(Ye)},null,8,["songs"]),d(c(N),{icon:"",onClick:ea,name:"全部收藏"}),d(c(N),{icon:"",name:"批量操作",onClick:l[3]||(l[3]=e=>{var a;return null==(a=We.value)?void 0:a.openSelectBox()})})]),d(c(K),{songs:c(Ye),"page-size":c(Qe)},null,8,["songs","page-size"]),p(d(c(T),{"cur-page":Ze.value,"onUpdate:curPage":l[4]||(l[4]=e=>Ze.value=e),"page-size":c(Qe),total:c($e)},null,8,["cur-page","page-size","total"]),[[g,c(Qe)<c($e)]])])])),_:1}),d(i,{label:"视频",name:"video"},{default:r((()=>[d(c($),{"is-loading":Fe.value},null,8,["is-loading"]),p(d(c(ee),{text:"暂无搜索结果"},null,512),[[g,De.get("video")]]),p(d(c(Y),{mvs:Ie,"show-pagination":!0},null,8,["mvs"]),[[g,!De.get("video")]])])),_:1}),d(i,{label:"MV",name:"mv"},{default:r((()=>[d(c($),{"is-loading":Fe.value},null,8,["is-loading"]),p(d(n,{text:"暂无搜索结果"},null,512),[[g,De.get("mv")]]),p(d(c(Y),{mvs:Pe,"show-pagination":!0},null,8,["mvs"]),[[g,!De.get("mv")]])])),_:1}),d(i,{label:"专辑",name:"album"},{default:r((()=>[d(c($),{"is-loading":Fe.value},null,8,["is-loading"]),p(d(c(ee),{text:"暂无搜索结果"},null,512),[[g,De.get("album")]]),p(d(c(Z),{albums:Ne,"show-pagination":!0},null,8,["albums"]),[[g,!De.get("album")]])])),_:1}),d(i,{label:"电台",name:"radio"},{default:r((()=>[d(c($),{"is-loading":Fe.value},null,8,["is-loading"]),p(d(c(ee),{text:"暂无搜索结果"},null,512),[[g,De.get("radio")]]),p(d(c(Q),{playlists:Ae,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[g,!De.get("radio")]])])),_:1}),d(i,{label:"歌单",name:"playList"},{default:r((()=>[d(c($),{"is-loading":Fe.value},null,8,["is-loading"]),p(d(c(ee),{text:"暂无搜索结果"},null,512),[[g,De.get("playList")]]),p(d(c(Q),{playlists:Te,"show-pagination":!0},null,8,["playlists"]),[[g,!De.get("playList")]])])),_:1}),d(i,{label:"歌手",name:"singer"},{default:r((()=>[d(c($),{"is-loading":Fe.value},null,8,["is-loading"]),p(d(c(ee),{text:"暂无搜索结果"},null,512),[[g,De.get("singer")]]),p(d(c(X),{"singer-list":qe},null,8,["singer-list"]),[[g,!De.get("singer")]])])),_:1}),d(i,{label:"歌词",name:"lyric"},{default:r((()=>[d(c($),{"is-loading":Fe.value},null,8,["is-loading"]),p(d(c(ee),{text:"暂无搜索结果"},null,512),[[g,De.get("lyric")]]),p(m("div",ce,[(u(!0),y(x,null,f(c(Ye),(e=>{var a;return u(),y("div",{class:"lyric",key:e.id},[m("div",ue,[p((u(),y("span",{class:"iconfont play-music",onClick:a=>c(aa)(e)},[_("")],8,me)),[[j]]),p((u(),y("span",{class:"iconfont music-info",onClick:a=>c(A)(e)},[_("")],8,pe)),[[j]]),p((u(),y("span",{class:"iconfont",onClick:a=>c(q)(e)},[_("")],8,ge)),[[j]]),p((u(),y("span",{class:"open-lyric",onClick:a=>{return s=c(Ve).get(e.id),void(Je[s]=Je[s]==Ge[s].lyric.length?3:Ge[s].lyric.length);var s}},[_(v(Je[c(Ve).get(e.id)]==(null==(a=e.lyric)?void 0:a.length)?"收起歌词":"展开歌词"),1)],8,de)),[[j]]),p((u(),y("span",{class:"copy-lyric",onClick:a=>c(B)(e.name+"\r\n"+e.lyric.join("\r\n"),"歌词复制成功！")},[_("复制歌词")],8,ve)),[[j]])]),m("div",he,[m("p",ye,[m("span",null,v(e.name),1),p(m("span",fe,"",512),[[g,"10"==e.available||"1"==e.available]])]),(u(!0),y(x,null,f(e.lyric,((a,s)=>p((u(),y("p",{key:s},v(a.trim()),1)),[[g,s<Je[c(Ve).get(e.id)]]]))),128))]),m("div",_e,[m("span",null,v(e.singer),1)]),m("div",xe,[m("span",null,v(e.album),1),m("span",null,v(c(G)(e.time)),1)])])})),128)),p(d(c(T),{class:"lyric-pagination","cur-page":Ze.value,"onUpdate:curPage":l[5]||(l[5]=e=>Ze.value=e),"page-size":c(Qe),total:c($e)},null,8,["cur-page","page-size","total"]),[[g,c(Qe)<c($e)]])],512),[[g,!De.get("lyric")]])])),_:1})])),_:1},512),[[g,!Ke.value]])])])),_:1},8,["max-height"])}}}),[["__scopeId","data-v-fe5051a9"]]);export{je as default};
