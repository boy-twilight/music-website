import{g as e,a,b as t,C as n,P as o,S as s,s as l,l as r,m as u,n as i,j as c,k as V,o as d,e as m,c as p,p as v,q as g,r as f,_ as y}from"../../static/index-a47c3a7a.js";import{O as _}from"../index/index.3beb5c84.js";import{M as h}from"../index/index.3b3e6026.js";import{P as k,_ as x}from"../index.vue_vue_type_style_index_0_scoped_2dc764e5_lang/index.vue_vue_type_style_index_0_scoped_2dc764e5_lang.fc383066.js";/* empty css                                                                                                                     */import{N as j}from"../index/index.456753dc.js";import{T as N}from"../index/index.dbb8a4d6.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../nprogress/nprogress.204a1a2a.js";import"../dplayer/dplayer.87601a3d.js";import"../lodash-es/lodash-es.8b477e85.js";/* empty css                                   */const w={class:"playlist-container scroll-container"},C={class:"header"},E=["src"],b={class:"right"},S={class:"title"},B={class:"creator"},L={class:"creator-name"},R={class:"tag"},P={class:"description"},U={class:"header-operation"},D=y(Vue.defineComponent({__name:"PlayListView",setup(y){Vue.useCssVars((e=>({"8dc9a876":Vue.unref(D),"8de8e73e":Vue.unref(I),"42babe3c":Vue.unref(z),"05fa79c1":Vue.unref(q)})));const D=e().get("fontColor"),I=e().get("fontBlack"),z=e().get("shadow"),q=Vue.inject("fontGray"),M=Vue.ref(!1),O=a(),$=VueRouter.useRoute(),F=$.query.id+"",G=$.query.type+"",T=Vue.reactive({id:F,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),A=Vue.reactive([]),H=Vue.reactive([]),J=Vue.computed((()=>new Map(A.map(((e,a)=>[e.id,a]))))),K=Vue.ref(1),Q=Vue.ref(30),W=Vue.computed((()=>A.slice((K.value-1)*Q.value,K.value*Q.value))),X=Vue.computed((()=>A.length)),Y=Vue.inject("firstLoading"),Z=Vue.ref(!1),ee=e=>{K.value=e},ae=e=>{Z.value=e},te=e=>{Z.value=e},ne=()=>{l("我有一个精品歌单分享给你："+T.name+"，地址：https://www.liyinchao.cloud/#"+$.fullPath)},oe=()=>{"playlist"==G?O.addLove(T,O.lovePlaylist,O.lovePlaylistId):O.addLove(T,O.loveRadio,O.loveRadioId)};return t((async()=>{if("playlist"==G)try{(await Promise.all([r(F),u(F),i(F,100)])).forEach(((e,a)=>{if(0==a){const{playlist:{name:a,coverImgUrl:t,description:n,tags:o,creator:s,playCount:l}}=e;T.name=a,T.image=t,T.description=n,T.tag=o,T.creator.avatarUrl=s.avatarUrl,T.creator.nickname=s.nickname,T.playCount=l,O.initLoveStatus(T,O.lovePlaylistId)}else if(1==a){const{songs:a}=e,t=[];a.forEach((e=>{c(t,A,e)})),O.initLoveMusic(A),V(t.join(","),A)}else if(2==a){const{comments:a,hotComments:t}=e;d(t,H),d(a,H),M.value=0==H.length}}))}catch(e){m(p.ERROR,e.message)}else{try{(await Promise.all([v(F),g(F,100)])).forEach(((e,a)=>{if(0==a){const{data:{name:a,dj:{avatarUrl:t,nickname:n},picUrl:o,desc:s,subCount:l}}=e;T.name=a,T.id=F,T.description=s,T.image=o,T.playCount=l,T.creator.nickname=n,T.creator.avatarUrl=t,O.initLoveStatus(T,O.loveRadioId)}else if(1==a){const{programs:a}=e,t=[];a.forEach((e=>{const{mainSong:{name:a,id:n,fee:o,artists:s,album:{name:l,picUrl:r},duration:u}}=e;t.push(n),A.push({id:n,name:a,singer:s[0].name,songImage:r,album:l,available:o,time:u})})),O.initLoveMusic(A),V(t.join(","),A)}}))}catch(e){m(p.ERROR,e.message)}f(F,"7",H,(()=>{M.value=0==H.length}))}Y.value=!1}),Y),(e,a)=>{const t=Vue.resolveComponent("el-image"),l=Vue.resolveComponent("el-tab-pane");return Vue.openBlock(),Vue.createElementBlock("div",w,[Vue.withDirectives(Vue.createVNode(Vue.unref(_),{"song-id-mapper":Vue.unref(J),songs:Vue.unref(W),onCloseSelect:ae},null,8,["song-id-mapper","songs"]),[[Vue.vShow,Z.value]]),Vue.withDirectives(Vue.createElementVNode("div",C,[Vue.createElementVNode("img",{src:T.image,class:"left-image"},null,8,E),Vue.createElementVNode("div",b,[Vue.createElementVNode("p",S,Vue.toDisplayString(T.name),1),Vue.createElementVNode("div",B,[Vue.createVNode(t,{src:T.creator.avatarUrl},null,8,["src"]),Vue.createElementVNode("span",L,Vue.toDisplayString(T.creator.nickname),1),Vue.createElementVNode("div",R,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(T.tag,(e=>(Vue.openBlock(),Vue.createElementBlock("span",{key:e},"#"+Vue.toDisplayString(e),1)))),128))])]),Vue.createElementVNode("p",P,Vue.toDisplayString(T.description),1),Vue.createElementVNode("div",U,[Vue.createVNode(Vue.unref(k),{songs:Vue.unref(W)},null,8,["songs"]),Vue.createVNode(Vue.unref(n),{name:T.isLove?"取消收藏":"收藏",icon:T.isLove?"":"","icon-style":T.isLove?"color:#ff6a6a;":"",onClick:oe},null,8,["name","icon","icon-style"]),Z.value?Vue.createCommentVNode("",!0):(Vue.openBlock(),Vue.createBlock(Vue.unref(h),{key:0,"share-to":ne,onOpenSelect:te}))])])],512),[[Vue.vShow,!Z.value]]),Vue.withDirectives(Vue.createVNode(Vue.unref(N),{active:"song",class:"playlist-tab"},{content:Vue.withCtx((()=>[Vue.createVNode(l,{label:`歌曲 ${A.length}`,name:"song"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(x),{songs:Vue.unref(W),"page-size":Q.value,"song-id-mapper":Vue.unref(J)},null,8,["songs","page-size","song-id-mapper"]),Vue.withDirectives(Vue.createVNode(Vue.unref(o),{"cur-page":K.value,"page-size":Q.value,total:Vue.unref(X),onPageChange:ee},null,8,["cur-page","page-size","total"]),[[Vue.vShow,Q.value<Vue.unref(X)]])])),_:1},8,["label"]),Vue.createVNode(l,{label:`评论 ${H.length<10?H.length+10:H.length}`,name:"comment"},{default:Vue.withCtx((()=>[M.value?(Vue.openBlock(),Vue.createBlock(Vue.unref(j),{key:1,size:280,text:"暂无评论数据"})):(Vue.openBlock(),Vue.createBlock(Vue.unref(s),{key:0,comments:H},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[Vue.vShow,!Z.value]])])}}}),[["__scopeId","data-v-26a6aa55"]]);export{D as default};
