import{x as a}from"../element-plus/element-plus.70abbed3.js";import{G as e,ax as s,d as l,Z as n,i,c as t,P as o,V as r,U as c,u,a as p,T as m,a2 as d,O as g,o as v,F as y,a7 as h,S as _,z as f,ag as j,aq as x}from"../@vue/@vue.7ad02ad1.js";import{b,u as C}from"../vue-router/vue-router.53ff932e.js";import{s as k}from"../pinia/pinia.07d51cb2.js";import{u as R,j as w,a as z,g as E,t as S,m as L,i as O,v as M,w as U,f as I,h as P,C as N,P as T,x as A,y as q,s as G,z as V,_ as B}from"../../static/index-c54fb4ae.js";import{P as F,_ as D}from"../index.vue_vue_type_style_index_0_scoped_841f6d57_lang/index.vue_vue_type_style_index_0_scoped_841f6d57_lang.e971174d.js";import{O as H}from"../index/index.684680ab.js";import{A as J}from"../index/index.c25428da.js";import{A as K}from"../index/index.29dc9c50.js";import{S as W}from"../index/index.1bab85b2.js";import{A as Z}from"../index/index.3ab33549.js";import{L as Q}from"../index/index.7682c408.js";import{N as X}from"../index/index.8fb16df1.js";import{T as Y}from"../index/index.f2ebda2c.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";/* empty css                                                                                                                     *//* empty css                                                                                                                     */const $={class:"search-container scroll-container"},aa=["src"],ea={class:"right-singer"},sa={class:"singer-name"},la={class:"singer-info"},na={class:"song"},ia={class:"header-operation"},ta={class:"lyric-container"},oa={class:"lyric-operation"},ra=["onClick"],ca=["onClick"],ua=["onClick"],pa=["onClick"],ma=["onClick"],da={class:"lyric-left"},ga={class:"song-name"},va={class:"is-vip iconfont"},ya={class:"lyric-center"},ha={class:"lyric-right"},_a=B(e({__name:"SearchView",setup(e){s((a=>({40189736:u(B),"17686f6d":u(ja),"1e4945a1":u(_a),b02e4fd0:u(fa),"2f57f418":u(xa),efb8d7ac:u(ba)})));const{fontGray:B,fontColor:_a,boxShadow:fa,themeColor:ja,singerBg:xa,buttonBg:ba}=R(),Ca=C(),ka=w(),{loveMusicId:Ra,loveSongs:wa}=k(ka),za=l(!1),Ea=a=>{za.value=a},Sa=()=>{Ma.forEach((a=>{a.isLove=!0;null==Ra.value.get(a.id)&&wa.value.push(a)}))},La=b().query.keyWord+"",Oa=l("song"),Ma=n([]),Ua=i((()=>new Map(Ma.map(((a,e)=>[a.id,e]))))),Ia=n([]),Pa=n([]),Na=n([]),Ta=n([]),Aa=n([]),qa=n([]),Ga=i((()=>qa.length>0?qa[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Va=n([]),Ba=i((()=>new Map(Va.map(((a,e)=>[a.id,e]))))),Fa=l(!1),Da=f("firstLoading"),Ha=n([!1,!1,!1,!1,!1,!1,!1]),Ja=n([]),Ka=l(1),Wa=i((()=>"song"==Oa.value?30:10)),Za=i((()=>"song"==Oa.value?Ma:Va)),Qa=i((()=>Za.value.slice((Ka.value-1)*Wa.value,Ka.value*Wa.value))),Xa=i((()=>"song"==Oa.value?Ma.length:Va.length)),Ya=a=>{Ka.value=a},{playMusic:$a}=z(),ae=a=>{Oa.value=a,"video"==a&&0==Ia.length?E((async()=>{try{const a=await S(1014,100,La),{result:{videos:e}}=a;e&&e.length>0&&e.forEach((a=>{const{vid:e,title:s,coverUrl:l,creator:n,playTime:i}=a;Ia.push({id:e,name:s,image:l,artist:n[0].userName,playCount:i})}))}catch(a){L(O.ERROR,a.message)}Fa.value=!1,Ha[0]=0==Ia.length}),Fa):"mv"==a&&0==Pa.length?E((async()=>{try{const a=await S(1004,100,La),{result:{mvs:e}}=a;e&&0!=e.length&&e.forEach((a=>{const{id:e,name:s,cover:l,artistName:n,playCount:i}=a;Pa.push({id:e,name:s,image:l,artist:n,playCount:i})}))}catch(a){L(O.ERROR,a.message)}Fa.value=!1,Ha[1]=0==Pa.length}),Fa):"album"==a&&0==Na.length?E((async()=>{try{const a=await S(10,60,La),{result:{albums:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,publishTime:n,artist:i}=a;Na.push({id:e,name:s,cover:l,publishTime:M(n),artistId:i.id})}))}catch(a){L(O.ERROR,a.message)}Fa.value=!1,Ha[2]=0==Na.length}),Fa):"radio"==a&&0==Aa.length?E((async()=>{try{const a=await S(1009,100,La),{result:{djRadios:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,playCount:n}=a;Aa.push({name:s,id:e,image:l,playCount:n,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){L(O.ERROR,a.message)}Fa.value=!1,Ha[3]=0==Aa.length}),Fa):"playList"==a&&0==Ta.length?E((async()=>{try{const a=await S(1e3,100,La),{result:{playlists:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,coverImgUrl:l,playCount:n}=a;Ta.push({id:e,name:s,image:l,playCount:n,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){L(O.ERROR,a.message)}Fa.value=!1,Ha[4]=0==Ta.length}),Fa):"lyric"==a&&0==Va.length&&E((async()=>{try{const a=await S(1006,100,La),{result:{songs:e}}=a;if(e&&e.length>0){const a=e.map((a=>a.id)).join(","),s=await U(a),{songs:l}=s;l.forEach((a=>{Ja.push(3),I(Va,a)})),e.forEach(((a,e)=>{const{lyrics:{txt:s}}=a;Va[e].lyric=s.split("\n")})),P(Va),ka.initLoveMusic(Ma)}}catch(a){L(O.ERROR,a.message)}Fa.value=!1,Ha[6]=0==Va.length}),Fa)};return E((async()=>{try{(await Promise.all([S(1,100,La),S(100,100,La)])).forEach((async(a,e)=>{if(0==e){const{result:{songs:e}}=a;if(e&&e.length>0){const a=e.map((a=>a.id)).join(","),s=await U(a),{songs:l}=s;l.forEach((a=>{I(Ma,a)})),P(Ma),ka.initLoveMusic(Ma)}}else if(1==e){const{result:{artists:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,accountId:n,albumSize:i,mvSize:t}=a;qa.push({id:e,name:s,avatar:l,score:n,albumSize:i,mvSize:t})})),Ha[5]=0==qa.length}}))}catch(a){L(O.ERROR,a.message)}Da.value=!1}),Da),(e,s)=>{const l=a,n=j("No"),i=x("prevent");return v(),t("div",$,[o(c(u(H),{songs:u(Qa),"song-id-mapper":u(Ua),onCloseSelect:Ea},null,8,["songs","song-id-mapper"]),[[r,za.value]]),o(p("div",{class:"result-singer",onClick:s[1]||(s[1]=a=>u(Ca).push({name:"artist",query:{id:u(Ga).id,score:u(Ga).score}}))},[p("img",{src:u(Ga).avatar,class:"left-singer"},null,8,aa),p("div",ea,[p("h4",sa,"歌手："+m(u(Ga).name),1),p("p",la,[p("span",null,"专辑："+m(u(Ga).albumSize),1),p("span",null,"视频："+m(u(Ga).mvSize),1)])]),c(u(N),{name:u(Ga).isLove?"取消关注":"关注歌手",icon:u(Ga).isLove?"":"","icon-style":u(Ga).isLove?"color:#ff6a6a;":"",onClick:s[0]||(s[0]=d((a=>u(ka).addLove(u(Ga),u(ka).loveSinger,u(ka).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[r,u(Ga).name]]),o(c(u(Y),{onGetActive:ae,active:"song",class:"search-tab"},{content:g((()=>[c(l,{label:"歌曲",name:"song"},{default:g((()=>[p("div",na,[p("div",ia,[c(u(F),{songs:u(Qa)},null,8,["songs"]),c(u(N),{icon:"",onClick:Sa,name:"全部收藏"}),c(u(N),{icon:"",name:"批量操作",onClick:s[2]||(s[2]=a=>za.value=!za.value)})]),c(u(D),{songs:u(Qa),"page-size":u(Wa),"song-id-mapper":u(Ua)},null,8,["songs","page-size","song-id-mapper"]),o(c(u(T),{"cur-page":Ka.value,"page-size":u(Wa),total:u(Xa),onPageChange:Ya},null,8,["cur-page","page-size","total"]),[[r,u(Wa)<u(Xa)]])])])),_:1}),c(l,{label:"视频",name:"video"},{default:g((()=>[c(u(Q),{"is-loading":Fa.value},null,8,["is-loading"]),o(c(u(X),{text:"暂无搜索结果"},null,512),[[r,Ha[0]]]),o(c(u(Z),{mvs:Ia,"show-pagination":!0},null,8,["mvs"]),[[r,!Ha[0]]])])),_:1}),c(l,{label:"MV",name:"mv"},{default:g((()=>[c(u(Q),{"is-loading":Fa.value},null,8,["is-loading"]),o(c(n,{text:"暂无搜索结果"},null,512),[[r,Ha[1]]]),o(c(u(Z),{mvs:Pa,"show-pagination":!0},null,8,["mvs"]),[[r,!Ha[1]]])])),_:1}),c(l,{label:"专辑",name:"album"},{default:g((()=>[c(u(Q),{"is-loading":Fa.value},null,8,["is-loading"]),o(c(u(X),{text:"暂无搜索结果"},null,512),[[r,Ha[2]]]),o(c(u(J),{albums:Na,"show-pagination":!0},null,8,["albums"]),[[r,!Ha[2]]])])),_:1}),c(l,{label:"电台",name:"radio"},{default:g((()=>[c(u(Q),{"is-loading":Fa.value},null,8,["is-loading"]),o(c(u(X),{text:"暂无搜索结果"},null,512),[[r,Ha[3]]]),o(c(u(K),{playlists:Aa,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[r,!Ha[3]]])])),_:1}),c(l,{label:"歌单",name:"playList"},{default:g((()=>[c(u(Q),{"is-loading":Fa.value},null,8,["is-loading"]),o(c(u(X),{text:"暂无搜索结果"},null,512),[[r,Ha[4]]]),o(c(u(K),{playlists:Ta,"show-pagination":!0},null,8,["playlists"]),[[r,!Ha[4]]])])),_:1}),c(l,{label:"歌手",name:"singer"},{default:g((()=>[c(u(Q),{"is-loading":Fa.value},null,8,["is-loading"]),o(c(u(X),{text:"暂无搜索结果"},null,512),[[r,Ha[5]]]),o(c(u(W),{"singer-list":qa},null,8,["singer-list"]),[[r,!Ha[5]]])])),_:1}),c(l,{label:"歌词",name:"lyric"},{default:g((()=>[c(u(Q),{"is-loading":Fa.value},null,8,["is-loading"]),o(c(u(X),{text:"暂无搜索结果"},null,512),[[r,Ha[6]]]),p("div",ta,[(v(!0),t(y,null,h(u(Qa),(a=>{var e;return v(),t("div",{class:"lyric",key:a.id},[p("div",oa,[o((v(),t("span",{class:"iconfont play-music",onClick:e=>u($a)(a)},[_("")],8,ra)),[[i]]),o((v(),t("span",{class:"iconfont music-info",onClick:e=>u(A)(a)},[_("")],8,ca)),[[i]]),o((v(),t("span",{class:"iconfont",onClick:e=>u(q)(a)},[_("")],8,ua)),[[i]]),o((v(),t("span",{class:"open-lyric",onClick:e=>{return s=u(Ba).get(a.id),void(Ja[s]=Ja[s]==Va[s].lyric.length?3:Va[s].lyric.length);var s}},[_(m(Ja[u(Ba).get(a.id)]==(null==(e=a.lyric)?void 0:e.length)?"收起歌词":"展开歌词"),1)],8,pa)),[[i]]),o((v(),t("span",{class:"copy-lyric",onClick:e=>u(G)(a.name+"\r\n"+a.lyric.join("\r\n"),"歌词复制成功！")},[_("复制歌词")],8,ma)),[[i]])]),p("div",da,[p("p",ga,[p("span",null,m(a.name),1),o(p("span",va,"",512),[[r,"10"==a.available||"1"==a.available]])]),(v(!0),t(y,null,h(a.lyric,((e,s)=>o((v(),t("p",{key:s},m(e.trim()),1)),[[r,s<Ja[u(Ba).get(a.id)]]]))),128))]),p("div",ya,[p("span",null,m(a.singer),1)]),p("div",ha,[p("span",null,m(a.album),1),p("span",null,m(u(V)(a.time)),1)])])})),128)),o(c(u(T),{class:"lyric-pagination","cur-page":Ka.value,"page-size":u(Wa),total:u(Xa),onPageChange:Ya},null,8,["cur-page","page-size","total"]),[[r,u(Wa)<u(Xa)]])])])),_:1})])),_:1},512),[[r,!za.value]])])}}}),[["__scopeId","data-v-c34e7ec1"]]);export{_a as default};
