import{x as e,y as a}from"../element-plus/element-plus.79622da4.js";import{G as s,ax as l,d as i,Z as n,i as t,M as o,O as r,u as c,o as u,a as m,P as p,V as g,U as d,T as v,a2 as h,c as y,a7 as f,S as _,F as x,z as j,ag as b,aq as w}from"../@vue/@vue.7ad02ad1.js";import{b as C,u as k}from"../vue-router/vue-router.53ff932e.js";import{s as R}from"../pinia/pinia.07d51cb2.js";import{u as z,h as E,a as S,t as L,v as U,e as M,f as O,m as I,M as P,s as N,C as T,P as q,w as A,x as B,q as G,y as V,O as F,L as H,z as D,r as J,_ as K}from"../../static/index-4abce35a.js";import{P as W,_ as Z}from"../index.vue_vue_type_style_index_0_scoped_b3813f91_lang/index.vue_vue_type_style_index_0_scoped_b3813f91_lang.b57f0142.js";import{O as Q}from"../index/index.3a10cfb0.js";import{A as X}from"../index/index.22815a49.js";import{A as Y}from"../index/index.365d0052.js";import{S as $}from"../index/index.ede3d065.js";import{A as ee}from"../index/index.bafb893e.js";import{L as ae}from"../index/index.c6590816.js";import{N as se}from"../index/index.df3bc403.js";import{T as le}from"../index/index.e2f2205e.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";/* empty css                                                                                                                     *//* empty css                                                                                                                     */const ie={class:"search-container scroll-container"},ne=["src"],te={class:"right-singer"},oe={class:"singer-name"},re={class:"singer-info"},ce={class:"song"},ue={class:"header-operation"},me={class:"lyric-container"},pe={class:"lyric-operation"},ge=["onClick"],de=["onClick"],ve=["onClick"],he=["onClick"],ye=["onClick"],fe={class:"lyric-left"},_e={class:"song-name"},xe={class:"is-vip iconfont"},je={class:"lyric-center"},be={class:"lyric-right"},we=K(s({__name:"SearchView",setup(s){l((e=>({c0a78146:c(K),"69abc736":c(ke),"55a219a9":c(we),"417ca7c0":c(Ce),afe6de28:c(Re),"47dc1f22":c(ze)})));const{fontGray:K,fontColor:we,boxShadow:Ce,themeColor:ke,singerBg:Re,buttonBg:ze,contentHeight:Ee}=z(),Se=k(),Le=E(),{loveMusicId:Ue,loveSongs:Me}=R(Le),Oe=C().query.keyWord+"",Ie=i("song"),Pe=n([]),Ne=n([]),Te=n([]),qe=n([]),Ae=n([]),Be=n([]),Ge=n([]),Ve=t((()=>Ge.length>0?Ge[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Fe=n([]),He=t((()=>new Map(Fe.map(((e,a)=>[e.id,a]))))),De=i(!1),Je=j("firstLoading"),Ke=n(new Map([["video",!0],["mv",!0],["album",!0],["radio",!0],["playList",!0],["lyric",!0],["singer",!0]])),We=n([]),Ze=i(!1),Qe=i(),Xe=i(1),Ye=t((()=>"song"==Ie.value?F:H)),$e=t((()=>"song"==Ie.value?Pe:Fe)),ea=t((()=>$e.value.slice((Xe.value-1)*Ye.value,Xe.value*Ye.value))),aa=t((()=>"song"==Ie.value?Pe.length:Fe.length)),sa=()=>{Pe.forEach((e=>{e.isLove=!0;null==Ue.value.get(e.id)&&Me.value.push(e)}))},{playMusic:la}=S(),ia=async e=>{if(Ie.value=e,"video"==e){if(0!=Ne.length)return;De.value=!0;try{const e=await L(1014,100,Oe),{result:{videos:a}}=e;a&&a.length>0&&a.forEach((e=>{const{vid:a,title:s,coverUrl:l,creator:i,playTime:n}=e;Ne.push({id:a,name:s,image:l,artist:i[0].userName,playCount:n})}))}catch(a){I(P.ERROR,a.message)}Ke.set("video",0==Ne.length)}else if("mv"==e){if(0!=Te.length)return;De.value=!0;try{const e=await L(1004,100,Oe),{result:{mvs:a}}=e;a&&0!=a.length&&a.forEach((e=>{const{id:a,name:s,cover:l,artistName:i,playCount:n}=e;Te.push({id:a,name:s,image:l,artist:i,playCount:n})}))}catch(a){I(P.ERROR,a.message)}Ke.set("mv",0==Te.length)}else if("album"==e){if(0!=qe.length)return;De.value=!0;try{const e=await L(10,60,Oe),{result:{albums:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,picUrl:l,publishTime:i,artist:n}=e;qe.push({id:a,name:s,cover:l,publishTime:D(i),artistId:n.id})}))}catch(a){I(P.ERROR,a.message)}Ke.set("mv",0==qe.length)}else if("radio"==e){if(0!=Be.length)return;De.value=!0;try{const e=await L(1009,100,Oe),{result:{djRadios:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,picUrl:l,playCount:i}=e;Be.push({name:s,id:a,image:l,playCount:i,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){I(P.ERROR,a.message)}Ke.set("radio",0==Be.length)}else if("playList"==e&&0==Ae.length){if(0!=Ae.length)return;De.value=!0;try{const e=await L(1e3,100,Oe),{result:{playlists:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,coverImgUrl:l,playCount:i}=e;Ae.push({id:a,name:s,image:l,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){I(P.ERROR,a.message)}Ke.set("radio",0==Ae.length)}else if("lyric"==e){if(0!=Fe.length)return;De.value=!0;try{const e=await L(1006,100,Oe),{result:{songs:a}}=e;if(a&&a.length>0){const e=a.map((e=>e.id)).join(","),s=await U(e),{songs:l}=s;l.forEach((e=>{We.push(3),M(Fe,e)})),a.forEach(((e,a)=>{const{lyrics:{txt:s}}=e;Fe[a].lyric=s.split("\n")})),O(Fe),Le.initLoveMusic(Pe)}}catch(a){I(P.ERROR,a.message)}Ke.set("lyric",0==Fe.length)}De.value=!1};return(async()=>{Je.value=!0;try{(await Promise.all([L(1,100,Oe),L(100,100,Oe)])).forEach((async(e,a)=>{if(0==a){const{result:{songs:a}}=e;if(a&&a.length>0){const e=a.map((e=>e.id)).join(","),s=await U(e),{songs:l}=s;l.forEach((e=>{M(Pe,e)})),await O(Pe),Le.initLoveMusic(Pe)}}else if(1==a){const{result:{artists:a}}=e;if(a&&a.length>0){const e=a.map((e=>{const{id:a,name:s,picUrl:l,accountId:i,albumSize:n,mvSize:t}=e;return{id:a,name:s,avatar:l,score:i,albumSize:n,mvSize:t}}));Ge.push(...e)}Ke.set("singer",0==Ge.length)}}))}catch(e){I(P.ERROR,e.message)}await N(J),Je.value=!1})(),(s,l)=>{const i=a,n=b("No"),t=e,j=w("prevent");return u(),o(t,{"max-height":c(Ee)},{default:r((()=>[m("div",ie,[p(d(c(Q),{songs:c(ea),"show-select":Ze.value,"onUpdate:showSelect":l[0]||(l[0]=e=>Ze.value=e),ref_key:"batch",ref:Qe},null,8,["songs","show-select"]),[[g,Ze.value]]),p(m("div",{class:"result-singer",onClick:l[2]||(l[2]=e=>c(Se).push({name:"artist",query:{id:c(Ve).id,score:c(Ve).score}}))},[m("img",{src:c(Ve).avatar,class:"left-singer"},null,8,ne),m("div",te,[m("h4",oe,"歌手："+v(c(Ve).name),1),m("p",re,[m("span",null,"专辑："+v(c(Ve).albumSize),1),m("span",null,"视频："+v(c(Ve).mvSize),1)])]),d(c(T),{name:c(Ve).isLove?"取消关注":"关注歌手",icon:c(Ve).isLove?"":"","icon-style":c(Ve).isLove?"color:#ff6a6a;":"",onClick:l[1]||(l[1]=h((e=>c(Le).addLove(c(Ve),c(Le).loveSinger,c(Le).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[g,c(Ve).name&&!Ze.value]]),p(d(c(le),{onGetActive:ia,active:"song",class:"search-tab"},{content:r((()=>[d(i,{label:"歌曲",name:"song"},{default:r((()=>[m("div",ce,[m("div",ue,[d(c(W),{songs:c(ea)},null,8,["songs"]),d(c(T),{icon:"",onClick:sa,name:"全部收藏"}),d(c(T),{icon:"",name:"批量操作",onClick:l[3]||(l[3]=e=>{var a;return null==(a=Qe.value)?void 0:a.openSelectBox()})})]),d(c(Z),{songs:c(ea),"page-size":c(Ye)},null,8,["songs","page-size"]),p(d(c(q),{"cur-page":Xe.value,"onUpdate:curPage":l[4]||(l[4]=e=>Xe.value=e),"page-size":c(Ye),total:c(aa)},null,8,["cur-page","page-size","total"]),[[g,c(Ye)<c(aa)]])])])),_:1}),d(i,{label:"视频",name:"video"},{default:r((()=>[d(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(d(c(se),{text:"暂无搜索结果"},null,512),[[g,Ke.get("video")]]),p(d(c(ee),{mvs:Ne,"show-pagination":!0},null,8,["mvs"]),[[g,!Ke.get("video")]])])),_:1}),d(i,{label:"MV",name:"mv"},{default:r((()=>[d(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(d(n,{text:"暂无搜索结果"},null,512),[[g,Ke.get("mv")]]),p(d(c(ee),{mvs:Te,"show-pagination":!0},null,8,["mvs"]),[[g,!Ke.get("mv")]])])),_:1}),d(i,{label:"专辑",name:"album"},{default:r((()=>[d(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(d(c(se),{text:"暂无搜索结果"},null,512),[[g,Ke.get("album")]]),p(d(c(X),{albums:qe,"show-pagination":!0},null,8,["albums"]),[[g,!Ke.get("album")]])])),_:1}),d(i,{label:"电台",name:"radio"},{default:r((()=>[d(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(d(c(se),{text:"暂无搜索结果"},null,512),[[g,Ke.get("radio")]]),p(d(c(Y),{playlists:Be,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[g,!Ke.get("radio")]])])),_:1}),d(i,{label:"歌单",name:"playList"},{default:r((()=>[d(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(d(c(se),{text:"暂无搜索结果"},null,512),[[g,Ke.get("playList")]]),p(d(c(Y),{playlists:Ae,"show-pagination":!0},null,8,["playlists"]),[[g,!Ke.get("playList")]])])),_:1}),d(i,{label:"歌手",name:"singer"},{default:r((()=>[d(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(d(c(se),{text:"暂无搜索结果"},null,512),[[g,Ke.get("singer")]]),p(d(c($),{"singer-list":Ge},null,8,["singer-list"]),[[g,!Ke.get("singer")]])])),_:1}),d(i,{label:"歌词",name:"lyric"},{default:r((()=>[d(c(ae),{"is-loading":De.value},null,8,["is-loading"]),p(d(c(se),{text:"暂无搜索结果"},null,512),[[g,Ke.get("lyric")]]),p(m("div",me,[(u(!0),y(x,null,f(c(ea),(e=>{var a;return u(),y("div",{class:"lyric",key:e.id},[m("div",pe,[p((u(),y("span",{class:"iconfont play-music",onClick:a=>c(la)(e)},[_("")],8,ge)),[[j]]),p((u(),y("span",{class:"iconfont music-info",onClick:a=>c(A)(e)},[_("")],8,de)),[[j]]),p((u(),y("span",{class:"iconfont",onClick:a=>c(B)(e)},[_("")],8,ve)),[[j]]),p((u(),y("span",{class:"open-lyric",onClick:a=>{return s=c(He).get(e.id),void(We[s]=We[s]==Fe[s].lyric.length?3:Fe[s].lyric.length);var s}},[_(v(We[c(He).get(e.id)]==(null==(a=e.lyric)?void 0:a.length)?"收起歌词":"展开歌词"),1)],8,he)),[[j]]),p((u(),y("span",{class:"copy-lyric",onClick:a=>c(G)(e.name+"\r\n"+e.lyric.join("\r\n"),"歌词复制成功！")},[_("复制歌词")],8,ye)),[[j]])]),m("div",fe,[m("p",_e,[m("span",null,v(e.name),1),p(m("span",xe,"",512),[[g,"10"==e.available||"1"==e.available]])]),(u(!0),y(x,null,f(e.lyric,((a,s)=>p((u(),y("p",{key:s},v(a.trim()),1)),[[g,s<We[c(He).get(e.id)]]]))),128))]),m("div",je,[m("span",null,v(e.singer),1)]),m("div",be,[m("span",null,v(e.album),1),m("span",null,v(c(V)(e.time)),1)])])})),128)),p(d(c(q),{class:"lyric-pagination","cur-page":Xe.value,"onUpdate:curPage":l[5]||(l[5]=e=>Xe.value=e),"page-size":c(Ye),total:c(aa)},null,8,["cur-page","page-size","total"]),[[g,c(Ye)<c(aa)]])],512),[[g,!Ke.get("lyric")]])])),_:1})])),_:1},512),[[g,!Ze.value]])])])),_:1},8,["max-height"])}}}),[["__scopeId","data-v-1fef8d0c"]]);export{we as default};
