import{g as e,e as t,c as a,b as u,i as l,_ as s}from"../../static/index-a47c3a7a.js";/* empty css                                                                                                                     */import{A as i}from"../index/index.1a5275e8.js";import{B as n}from"../index/index.c36d15e6.js";import{S as o}from"../index/index.1c83a27b.js";import{L as r}from"../index/index.4a520f69.js";/* empty css                                                                                                                     */import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../nprogress/nprogress.204a1a2a.js";import"../dplayer/dplayer.87601a3d.js";import"../lodash-es/lodash-es.8b477e85.js";/* empty css                                   */const c=e=>(Vue.pushScopeId("data-v-66410440"),e=e(),Vue.popScopeId(),e),v=["infinite-scroll-disabled"],d=c((()=>Vue.createElementVNode("h4",{class:"title video-choice"},"视频类型",-1))),V=c((()=>Vue.createElementVNode("h4",{class:"title all"},"全部视频",-1))),p=c((()=>Vue.createElementVNode("span",{class:"iconfont"},"",-1))),f=s(Vue.defineComponent({__name:"VideoView",setup(s){Vue.useCssVars((e=>({"6b39cd81":Vue.unref(c),"6b2a2e1d":Vue.unref(m),"9e3a9ef6":Vue.unref(h),"164d4010":Vue.unref(f),"6888e38d":Vue.unref(_)})));const c=e().get("fontColor"),f=e().get("shadow"),m=e().get("fontBlack"),_=e().get("themeColor"),h=Vue.inject("fontGray"),y=Vue.reactive(["全部","韩国","日本","欧美","港台","内地"]),g=Vue.reactive(["全部","官方版","现场版","网易出品"]),x=Vue.reactive(["上升最快","最新","最热"]),j=Vue.ref(0),w=Vue.ref(0),N=Vue.ref(0),C=Vue.reactive(new Map),b=Vue.reactive(new Map);let E=Vue.reactive([]),k=Vue.reactive([]);const S=Vue.ref(600),R=Vue.ref(30),G=Vue.ref(!1),A=Vue.ref(!1),B=Vue.inject("firstLoading"),D=Vue.inject("hideScroll"),I=Vue.ref(!1),T=Vue.computed((()=>k.filter((e=>e.name.includes(L.value)||e.artist.includes(L.value))))),L=Vue.ref(""),M=e=>{L.value=e},O=async(e,t)=>{b.set(j.value+""+w.value+N.value,S.value),D(),E.splice(0),k.splice(0),"视频地区"==t?j.value=e:"视频来源"==t?w.value=e:N.value=e,R.value=40;const a=b.get(j.value+""+w.value+N.value);S.value=a||1500,await Vue.nextTick();const u=C.get(j.value+""+w.value+N.value);u?(E.push(...u),k.push(...u.slice(0,R.value))):z()},q=()=>{L.value||(G.value=!0,R.value+=10,R.value<E.length?setTimeout((()=>{k.push(...E.slice(k.length,R.value)),G.value=!1}),100):S.value==E.length?(S.value*=2,I.value=!0):(k.push(...E.slice(k.length)),t(a.SUCCESS,"已经到达底部！")))},U=()=>{I.value=!1,u((async()=>{try{const e=await l(S.value,y[j.value],g[w.value],x[N.value]),{data:t}=e;t.slice(E.length).forEach((e=>{const{id:t,name:a,cover:u,playCount:l,artistName:s}=e;E.push({id:t,name:a,image:u,playCount:l,artist:s})})),C.set(j.value+""+w.value+N.value,[...E]),k.push(...E.slice(k.length,R.value))}catch(e){t(a.ERROR,e.message)}A.value=!1,G.value=!1}),A)},z=()=>{u((async()=>{try{const e=await l(S.value,y[j.value],g[w.value],x[N.value]),{data:t}=e;t.forEach((e=>{const{id:t,name:a,cover:u,playCount:l,artistName:s}=e;E.push({id:t,name:a,image:u,playCount:l,artist:s})})),C.set(j.value+""+w.value+N.value,[...E]),k.push(...E.slice(0,R.value))}catch(e){t(a.ERROR,e.message)}B.value=!1}),B)};return z(),(e,t)=>{const a=Vue.resolveDirective("infinite-scroll");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{class:"rvideo-container scroll-container","infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":G.value,style:{overflow:"auto"}},[Vue.createVNode(Vue.unref(o),{onGetContent:M}),d,Vue.createVNode(Vue.unref(n),{onGetActive:O,title:"视频地区",activeValue:0,"show-title":!1,type:y,class:"area"},null,8,["type"]),Vue.createVNode(Vue.unref(n),{onGetActive:O,title:"视频来源",activeValue:0,"show-title":!1,type:g},null,8,["type"]),Vue.createVNode(Vue.unref(n),{onGetActive:O,title:"视频排序","show-title":!1,activeValue:0,type:x},null,8,["type"]),V,Vue.createVNode(Vue.unref(i),{mvs:Vue.unref(T)},null,8,["mvs"]),Vue.createVNode(Vue.unref(r),{"is-loading":A.value},null,8,["is-loading"]),Vue.withDirectives(Vue.createElementVNode("button",{class:"more-video",onClick:U},[Vue.createTextVNode(" 更多精彩视频"),p],512),[[Vue.vShow,I.value]])],8,v)),[[a,q]])}}}),[["__scopeId","data-v-66410440"]]);export{f as default};
