import{g as a,x as e}from"../element-plus/element-plus.f4dce189.js";import{g as s,a as t,b as o,l as i,e as l,d as n,m as r,i as c,j as m,n as p,o as u,p as d,q as g,r as v,C as y,P as h,s as j,t as f,_}from"../../assets/index-831d6614.js";import{G as R,ax as k,r as x,Z as b,i as w,c as C,P as L,V as z,U,u as P,a as E,T as O,F as I,a7 as S,M,R as T,O as q,z as G,o as F}from"../@vue/@vue.59fec093.js";import{b as N}from"../vue-router/vue-router.10a7fca4.js";import{O as V}from"../index/index.c5745a43.js";import{M as $}from"../index/index.d53b09ba.js";import{P as B,_ as D}from"../index.vue_vue_type_style_index_0_scoped_2dc764e5_lang/index.vue_vue_type_style_index_0_scoped_2dc764e5_lang.ce8305d1.js";import{T as H}from"../Tab/Tab.63db5902.js";import{_ as Z}from"../NoSearch/NoSearch.4c67f0f6.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.81428a33.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";const A={class:"playlist-container scroll-container"},J={class:"header"},K=["src"],Q={class:"right"},W={class:"title"},X={class:"creator"},Y={class:"creator-name"},aa={class:"tag"},ea={class:"description"},sa={class:"header-operation"},ta=_(R({__name:"PlayListView",setup(_){k((a=>({"42d772dd":P(R),"42c7d379":P(ta),"6711f558":P(oa),e2e620ae:P(ia)})));const R=s().get("fontColor"),ta=s().get("fontBlack"),oa=s().get("shadow"),ia=G("fontGray"),la=x(!1),na=t(),ra=N(),ca=ra.query.id+"",ma=ra.query.type+"",pa=b({id:ca,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),ua=b([]),da=b([]),ga=w((()=>new Map(ua.map(((a,e)=>[a.id,e]))))),va=x(1),ya=x(30),ha=w((()=>ua.slice((va.value-1)*ya.value,va.value*ya.value))),ja=w((()=>ua.length)),fa=a=>{va.value=a},_a=G("firstLoading"),Ra=x(!1),ka=a=>{Ra.value=a},xa=a=>{Ra.value=a},ba=()=>{f("我有一个精品歌单分享给你："+pa.name+"，地址：https://www.liyinchao.cloud/#"+ra.fullPath)},wa=()=>{"playlist"==ma?na.addLove(pa,na.lovePlaylist,na.lovePlaylistId):na.addLove(pa,na.loveRadio,na.loveRadioId)};return o((async()=>{if("playlist"==ma){try{const a=await i(ca),{playlist:{name:e,coverImgUrl:s,description:t,tags:o,creator:l,playCount:n}}=a;pa.name=e,pa.image=s,pa.description=t,pa.tag=o,pa.creator.avatarUrl=l.avatarUrl,pa.creator.nickname=l.nickname,pa.playCount=n,na.initLoveStatus(pa,na.lovePlaylistId)}catch(a){l(n.ERROR,a.message)}try{const a=await r(ca),{songs:e}=a,s=[];e.forEach((a=>{c(s,ua,a)})),na.initLoveMusic(ua),m(s.join(","),ua)}catch(a){l(n.ERROR,a.message)}try{const a=await p(ca,100),{comments:e,hotComments:s}=a;u(s,da),u(e,da),la.value=0==da.length}catch(a){l(n.ERROR,a.message)}}else{try{const a=await d(ca),{data:{name:e,dj:{avatarUrl:s,nickname:t},picUrl:o,desc:i,subCount:l}}=a;pa.name=e,pa.id=ca,pa.description=i,pa.image=o,pa.playCount=l,pa.creator.nickname=t,pa.creator.avatarUrl=s,na.initLoveStatus(pa,na.loveRadioId)}catch(a){l(n.ERROR,a.message)}try{const a=await g(ca,100),{programs:e}=a,s=[];e.forEach((a=>{const{mainSong:{name:e,id:t,fee:o,artists:i,album:{name:l,picUrl:n},duration:r}}=a;s.push(t),ua.push({id:t,name:e,singer:i[0].name,songImage:n,album:l,available:o,time:r})})),na.initLoveMusic(ua),m(s.join(","),ua)}catch(a){l(n.ERROR,a.message)}v(ca,"7",da,(()=>{la.value=0==da.length}))}_a.value=!1}),_a),(s,t)=>{const o=a,i=h,l=e;return F(),C("div",A,[L(U(P(V),{"song-id-mapper":P(ga),songs:P(ha),onCloseSelect:ka},null,8,["song-id-mapper","songs"]),[[z,Ra.value]]),L(E("div",J,[E("img",{src:pa.image,class:"left-image"},null,8,K),E("div",Q,[E("p",W,O(pa.name),1),E("div",X,[U(o,{src:pa.creator.avatarUrl},null,8,["src"]),E("span",Y,O(pa.creator.nickname),1),E("div",aa,[(F(!0),C(I,null,S(pa.tag,(a=>(F(),C("span",{key:a},"#"+O(a),1)))),128))])]),E("p",ea,O(pa.description),1),E("div",sa,[U(P(B),{songs:P(ha)},null,8,["songs"]),U(P(y),{name:pa.isLove?"取消收藏":"收藏",icon:pa.isLove?"":"","icon-style":pa.isLove?"color:#ff6a6a;":"",onClick:wa},null,8,["name","icon","icon-style"]),Ra.value?T("",!0):(F(),M(P($),{key:0,"share-to":ba,onOpenSelect:xa}))])])],512),[[z,!Ra.value]]),L(U(H,{active:"song",class:"playlist-tab"},{content:q((()=>[U(l,{label:`歌曲 ${ua.length}`,name:"song"},{default:q((()=>[U(P(D),{songs:P(ha),"page-size":ya.value,"song-id-mapper":P(ga)},null,8,["songs","page-size","song-id-mapper"]),L(U(i,{"cur-page":va.value,"page-size":ya.value,total:P(ja),onPageChange:fa},null,8,["cur-page","page-size","total"]),[[z,ya.value<P(ja)]])])),_:1},8,["label"]),U(l,{label:`评论 ${da.length<10?da.length+10:da.length}`,name:"comment"},{default:q((()=>[la.value?(F(),M(Z,{key:1,size:280,text:"暂无评论数据"})):(F(),M(j,{key:0,comments:da},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[z,!Ra.value]])])}}}),[["__scopeId","data-v-4a9f2636"]]);export{ta as default};
