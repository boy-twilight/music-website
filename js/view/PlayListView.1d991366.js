import{j as a,x as e}from"../element-plus/element-plus.85c7c360.js";import{G as s,ax as t,r as o,Z as i,i as n,c as l,P as r,V as c,U as m,u as p,a as d,T as u,F as v,a7 as g,M as y,R as _,O as j,z as h,o as f}from"../@vue/@vue.59fec093.js";import{b as x}from"../vue-router/vue-router.10a7fca4.js";import{g as R,a as b,b as k,l as w,e as C,d as L,m as z,i as U,j as P,n as E,o as I,p as O,q as S,r as M,C as q,P as G,S as F,s as T,_ as V}from"../../assets/index-ae815df4.js";import{O as $}from"../index/index.0ee0497c.js";import{M as B}from"../index/index.6ee020d6.js";import{P as D,_ as H}from"../index.vue_vue_type_style_index_0_scoped_2dc764e5_lang/index.vue_vue_type_style_index_0_scoped_2dc764e5_lang.17b6b6a5.js";/* empty css                                                                                                                     */import{N}from"../index/index.0b25b9e3.js";import{T as Z}from"../index/index.aebbf3a2.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.81428a33.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";const A={class:"playlist-container scroll-container"},J={class:"header"},K=["src"],Q={class:"right"},W={class:"title"},X={class:"creator"},Y={class:"creator-name"},aa={class:"tag"},ea={class:"description"},sa={class:"header-operation"},ta=V(s({__name:"PlayListView",setup(s){t((a=>({79911154:p(V),"79b0501c":p(ta),"4cd709cd":p(oa),"064df810":p(ia)})));const V=R().get("fontColor"),ta=R().get("fontBlack"),oa=R().get("shadow"),ia=h("fontGray"),na=o(!1),la=b(),ra=x(),ca=ra.query.id+"",ma=ra.query.type+"",pa=i({id:ca,name:"",image:"",playCount:"",tag:[],description:"",creator:{nickname:"",avatarUrl:""}}),da=i([]),ua=i([]),va=n((()=>new Map(da.map(((a,e)=>[a.id,e]))))),ga=o(1),ya=o(30),_a=n((()=>da.slice((ga.value-1)*ya.value,ga.value*ya.value))),ja=n((()=>da.length)),ha=h("firstLoading"),fa=o(!1),xa=a=>{ga.value=a},Ra=a=>{fa.value=a},ba=a=>{fa.value=a},ka=()=>{T("我有一个精品歌单分享给你："+pa.name+"，地址：https://www.liyinchao.cloud/#"+ra.fullPath)},wa=()=>{"playlist"==ma?la.addLove(pa,la.lovePlaylist,la.lovePlaylistId):la.addLove(pa,la.loveRadio,la.loveRadioId)};return k((async()=>{if("playlist"==ma){try{const a=await w(ca),{playlist:{name:e,coverImgUrl:s,description:t,tags:o,creator:i,playCount:n}}=a;pa.name=e,pa.image=s,pa.description=t,pa.tag=o,pa.creator.avatarUrl=i.avatarUrl,pa.creator.nickname=i.nickname,pa.playCount=n,la.initLoveStatus(pa,la.lovePlaylistId)}catch(a){C(L.ERROR,a.message)}try{const a=await z(ca),{songs:e}=a,s=[];e.forEach((a=>{U(s,da,a)})),la.initLoveMusic(da),P(s.join(","),da)}catch(a){C(L.ERROR,a.message)}try{const a=await E(ca,100),{comments:e,hotComments:s}=a;I(s,ua),I(e,ua),na.value=0==ua.length}catch(a){C(L.ERROR,a.message)}}else{try{const a=await O(ca),{data:{name:e,dj:{avatarUrl:s,nickname:t},picUrl:o,desc:i,subCount:n}}=a;pa.name=e,pa.id=ca,pa.description=i,pa.image=o,pa.playCount=n,pa.creator.nickname=t,pa.creator.avatarUrl=s,la.initLoveStatus(pa,la.loveRadioId)}catch(a){C(L.ERROR,a.message)}try{const a=await S(ca,100),{programs:e}=a,s=[];e.forEach((a=>{const{mainSong:{name:e,id:t,fee:o,artists:i,album:{name:n,picUrl:l},duration:r}}=a;s.push(t),da.push({id:t,name:e,singer:i[0].name,songImage:l,album:n,available:o,time:r})})),la.initLoveMusic(da),P(s.join(","),da)}catch(a){C(L.ERROR,a.message)}M(ca,"7",ua,(()=>{na.value=0==ua.length}))}ha.value=!1}),ha),(s,t)=>{const o=a,i=e;return f(),l("div",A,[r(m(p($),{"song-id-mapper":p(va),songs:p(_a),onCloseSelect:Ra},null,8,["song-id-mapper","songs"]),[[c,fa.value]]),r(d("div",J,[d("img",{src:pa.image,class:"left-image"},null,8,K),d("div",Q,[d("p",W,u(pa.name),1),d("div",X,[m(o,{src:pa.creator.avatarUrl},null,8,["src"]),d("span",Y,u(pa.creator.nickname),1),d("div",aa,[(f(!0),l(v,null,g(pa.tag,(a=>(f(),l("span",{key:a},"#"+u(a),1)))),128))])]),d("p",ea,u(pa.description),1),d("div",sa,[m(p(D),{songs:p(_a)},null,8,["songs"]),m(p(q),{name:pa.isLove?"取消收藏":"收藏",icon:pa.isLove?"":"","icon-style":pa.isLove?"color:#ff6a6a;":"",onClick:wa},null,8,["name","icon","icon-style"]),fa.value?_("",!0):(f(),y(p(B),{key:0,"share-to":ka,onOpenSelect:ba}))])])],512),[[c,!fa.value]]),r(m(p(Z),{active:"song",class:"playlist-tab"},{content:j((()=>[m(i,{label:`歌曲 ${da.length}`,name:"song"},{default:j((()=>[m(p(H),{songs:p(_a),"page-size":ya.value,"song-id-mapper":p(va)},null,8,["songs","page-size","song-id-mapper"]),r(m(p(G),{"cur-page":ga.value,"page-size":ya.value,total:p(ja),onPageChange:xa},null,8,["cur-page","page-size","total"]),[[c,ya.value<p(ja)]])])),_:1},8,["label"]),m(i,{label:`评论 ${ua.length<10?ua.length+10:ua.length}`,name:"comment"},{default:j((()=>[na.value?(f(),y(p(N),{key:1,size:280,text:"暂无评论数据"})):(f(),y(p(F),{key:0,comments:ua},null,8,["comments"]))])),_:1},8,["label"])])),_:1},512),[[c,!fa.value]])])}}}),[["__scopeId","data-v-ebee336a"]]);export{ta as default};
