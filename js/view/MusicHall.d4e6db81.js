import{g as e,t as l,b as a,e as u,c as t,K as i,L as n,M as s,N as o,O as r,f as c,_ as v}from"../../static/index-a47c3a7a.js";/* empty css                                                                                                                     */import{A as d}from"../index/index.e9db409e.js";import{L as V}from"../index/index.4a520f69.js";/* empty css                                                                                                                     */import{T as p}from"../index/index.dbb8a4d6.js";import{t as m}from"../lodash-es/lodash-es.8b477e85.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../nprogress/nprogress.204a1a2a.js";import"../dplayer/dplayer.87601a3d.js";/* empty css                                   */const f={class:"music-hall-container"},h=["infinite-scroll-disabled"],g=["infinite-scroll-disabled"],y=["infinite-scroll-disabled"],_=v(Vue.defineComponent({__name:"MusicHall",setup(v){Vue.useCssVars((e=>({d7e1cdde:Vue.unref(_),cd249a16:Vue.unref(w),"1daeab88":Vue.unref(k),"8da35dac":B.value,"51bef005":Vue.unref(b),"68eac70d":E.value})));const _=e().get("fontColor"),k=e().get("shadow"),w=Vue.inject("fontGray"),x=l(),b=Vue.computed((()=>x.isFullScreen?"76.3vh":"73.3vh")),B=Vue.ref("0px"),E=Vue.ref("none"),C=()=>{E.value="none",B.value="0"};let j=0;const R=m((()=>{"block"!=E.value&&(E.value="block",B.value="6px"),j&&clearTimeout(j),j=setTimeout((()=>{"none"!=E.value&&C()}),3e3)}),600,{leading:!0,trailing:!1}),N=Vue.inject("firstLoading"),S=Vue.ref(!1),D=Vue.reactive([]),O=Vue.reactive([]),F=Vue.reactive([]),I=Vue.ref(18),L=Vue.ref(0),U=Vue.ref(!1),T=async()=>{try{const e=await r(100,F[L.value]),{playlists:l}=e;l.forEach((e=>{const{name:l,id:a,coverImgUrl:u,playCount:t}=e;D[L.value].push({name:l,id:a,image:u,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){u(t.ERROR,e.message)}0==L.value&&(O[L.value].push(...D[L.value].slice(0,I.value)),N.value=!1),S.value&&(S.value=!1)},A=()=>{U.value=!0,I.value+=12,I.value<D[L.value].length?setTimeout((()=>{O[L.value].push(...D[L.value].slice(I.value-12,I.value)),U.value=!1}),100):(S.value=!0,L.value<F.length?(I.value=0,O[L.value].push(...D[L.value].slice(O[L.value].length)),L.value++,T(),U.value=!1):(S.value=!1,u(t.INFO,"已经到底部啦！")))},G=Vue.reactive([]),M=Vue.reactive([]),q=Vue.reactive([]),H=Vue.ref(18),K=Vue.ref(0),P=Vue.ref(!1),z=async()=>{try{const e=await c(100,q[K.value]),{playlists:l}=e;l.forEach((e=>{const{name:l,id:a,coverImgUrl:u,playCount:t}=e;G[K.value].push({name:l,id:a,image:u,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){u(t.ERROR,e.message)}0==K.value&&(M[K.value].push(...G[K.value].slice(0,H.value)),N.value=!1),S.value&&(S.value=!1)},J=()=>{P.value=!0,H.value+=12,H.value<G[L.value].length?setTimeout((()=>{M[K.value].push(...G[K.value].slice(H.value-12,H.value)),P.value=!1}),100):(S.value=!0,K.value<q.length?(H.value=0,M[K.value].push(...G[K.value].slice(M[K.value].length)),K.value++,z(),P.value=!1):(S.value=!1,u(t.INFO,"已经到底部啦！")))},Q=Vue.reactive([]),W=Vue.reactive([]),X=Vue.ref(0),Y=Vue.ref(!1),Z=()=>{Y.value=!0,S.value=!0,X.value++,X.value<W.length?($(),Y.value=!1):(u(t.SUCCESS,"已经到达底部啦！"),S.value=!1)},$=async()=>{try{const e=await i(W[X.value].id),{data:{playlist:l}}=e;l.forEach((e=>{const{id:l,name:a,cover:u,playCount:t}=e;Q[X.value].push({id:l,name:a,image:u,playCount:t,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){u(t.ERROR,e.message)}0==X.value&&(N.value=!1),S.value&&(S.value=!1)},ee=e=>{C(),"rec"==e&&0==G[0].length?(N.value=!0,z()):"style"==e&&0==Q[0].length&&(N.value=!0,$())};return a((async()=>{try{(await Promise.all([n(),s(),o()])).forEach(((e,l)=>{if(0==l){const{tags:l}=e;F.push(...l.map((e=>e.name))),F.forEach((()=>{D.push([]),O.push([])}))}else if(1==l){const{sub:l}=e;q.push(...l.map((e=>e.name))),q.forEach((()=>{G.push([]),M.push([])}))}else if(2==l){const{data:l}=e;l.forEach((e=>{const{tagId:l,tagName:a}=e;W.push({id:l,name:a}),Q.push([])}))}}))}catch(e){u(t.ERROR,e.message)}await T(),N.value=!1}),N),(e,l)=>{const a=Vue.resolveComponent("el-tab-pane"),u=Vue.resolveDirective("infinite-scroll");return Vue.openBlock(),Vue.createElementBlock("div",f,[Vue.createVNode(Vue.unref(p),{active:"top",onGetActive:ee},{content:Vue.withCtx((()=>[Vue.createVNode(a,{label:"精选歌单",name:"top"},{default:Vue.withCtx((()=>[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{class:"container scroll-container",onScroll:l[0]||(l[0]=e=>Vue.unref(R)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":U.value,style:{overflow:"auto"}},[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(O,((e,l)=>Vue.withDirectives((Vue.openBlock(),Vue.createBlock(Vue.unref(d),{key:F[l],title:F[l],playlists:e},null,8,["title","playlists"])),[[Vue.vShow,e.length>0]]))),128)),Vue.createVNode(Vue.unref(V),{"is-loading":S.value},null,8,["is-loading"])],40,h)),[[u,A]])])),_:1}),Vue.createVNode(a,{label:"网友推荐",name:"rec"},{default:Vue.withCtx((()=>[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{class:"container scroll-container",onScroll:l[1]||(l[1]=e=>Vue.unref(R)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":P.value,style:{overflow:"auto"}},[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(M,((e,l)=>Vue.withDirectives((Vue.openBlock(),Vue.createBlock(Vue.unref(d),{key:q[l],title:q[l],playlists:e},null,8,["title","playlists"])),[[Vue.vShow,e.length>0]]))),128)),Vue.createVNode(Vue.unref(V),{"is-loading":S.value},null,8,["is-loading"])],40,g)),[[u,J]])])),_:1}),Vue.createVNode(a,{label:"浪漫曲风",name:"style"},{default:Vue.withCtx((()=>[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{class:"container scroll-container",onScroll:l[2]||(l[2]=e=>Vue.unref(R)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":Y.value,style:{overflow:"auto"}},[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Q,((e,l)=>Vue.withDirectives((Vue.openBlock(),Vue.createBlock(Vue.unref(d),{key:W[l].id,title:W[l].name,playlists:e},null,8,["title","playlists"])),[[Vue.vShow,e.length>0]]))),128)),Vue.createVNode(Vue.unref(V),{"is-loading":S.value},null,8,["is-loading"])],40,y)),[[u,Z]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-2b711246"]]);export{_ as default};
