import{x as e,y as a}from"../element-plus/element-plus.79622da4.js";import{G as s,ax as l,d as i,Z as n,i as t,M as o,O as r,u as c,o as u,a as m,P as p,V as g,U as d,T as v,a2 as h,c as y,a7 as f,S as _,F as x,z as j,ag as b,aq as C}from"../@vue/@vue.7ad02ad1.js";import{b as w,u as k}from"../vue-router/vue-router.53ff932e.js";import{s as R}from"../pinia/pinia.07d51cb2.js";import{u as z,i as E,a as S,r as L,t as U,e as O,f as M,m as I,h as P,C as N,P as T,v as A,w as q,s as B,x as G,O as V,y as F,_ as H}from"../../static/index-00c07d3e.js";import{P as D,_ as J}from"../index.vue_vue_type_style_index_0_scoped_f0a13ca2_lang/index.vue_vue_type_style_index_0_scoped_f0a13ca2_lang.ae5cbee5.js";import{O as K}from"../index/index.28836372.js";import{A as W}from"../index/index.f10bc782.js";import{A as Z}from"../index/index.99fcc62c.js";import{S as Q}from"../index/index.8760caad.js";import{A as X}from"../index/index.8e8a57d9.js";import{L as Y}from"../index/index.a0e338b1.js";import{N as $}from"../index/index.99d18942.js";import{T as ee}from"../index/index.6af32fa3.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";/* empty css                                                                                                                     *//* empty css                                                                                                                     */const ae={class:"search-container scroll-container"},se=["src"],le={class:"right-singer"},ie={class:"singer-name"},ne={class:"singer-info"},te={class:"song"},oe={class:"header-operation"},re={class:"lyric-container"},ce={class:"lyric-operation"},ue=["onClick"],me=["onClick"],pe=["onClick"],ge=["onClick"],de=["onClick"],ve={class:"lyric-left"},he={class:"song-name"},ye={class:"is-vip iconfont"},fe={class:"lyric-center"},_e={class:"lyric-right"},xe=H(s({__name:"SearchView",setup(s){l((e=>({a74e8dba:c(H),"5e9f3cab":c(be),"42f64eba":c(xe),"68246b1a":c(je),"968dea9c":c(Ce),"548898e8":c(we)})));const{fontGray:H,fontColor:xe,boxShadow:je,themeColor:be,singerBg:Ce,buttonBg:we,contentHeight:ke}=z(),Re=k(),ze=E(),{loveMusicId:Ee,loveSongs:Se}=R(ze),Le=w().query.keyWord+"",Ue=i("song"),Oe=n([]),Me=n([]),Ie=n([]),Pe=n([]),Ne=n([]),Te=n([]),Ae=n([]),qe=t((()=>Ae.length>0?Ae[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Be=n([]),Ge=t((()=>new Map(Be.map(((e,a)=>[e.id,a]))))),Ve=i(!1),Fe=j("firstLoading"),He=n(new Map([["video",!0],["mv",!0],["album",!0],["radio",!0],["playList",!0],["lyric",!0],["singer",!0]])),De=n([]),Je=i(!1),Ke=i(),We=i(1),Ze=t((()=>"song"==Ue.value?V:10)),Qe=t((()=>"song"==Ue.value?Oe:Be)),Xe=t((()=>Qe.value.slice((We.value-1)*Ze.value,We.value*Ze.value))),Ye=t((()=>"song"==Ue.value?Oe.length:Be.length)),$e=()=>{Oe.forEach((e=>{e.isLove=!0;null==Ee.value.get(e.id)&&Se.value.push(e)}))},{playMusic:ea}=S(),aa=async e=>{if(Ue.value=e,"video"==e){if(0!=Me.length)return;Ve.value=!0;try{const e=await L(1014,100,Le),{result:{videos:a}}=e;a&&a.length>0&&a.forEach((e=>{const{vid:a,title:s,coverUrl:l,creator:i,playTime:n}=e;Me.push({id:a,name:s,image:l,artist:i[0].userName,playCount:n})}))}catch(a){I(P.ERROR,a.message)}He.set("video",0==Me.length)}else if("mv"==e){if(0!=Ie.length)return;Ve.value=!0;try{const e=await L(1004,100,Le),{result:{mvs:a}}=e;a&&0!=a.length&&a.forEach((e=>{const{id:a,name:s,cover:l,artistName:i,playCount:n}=e;Ie.push({id:a,name:s,image:l,artist:i,playCount:n})}))}catch(a){I(P.ERROR,a.message)}He.set("mv",0==Ie.length)}else if("album"==e){if(0!=Pe.length)return;Ve.value=!0;try{const e=await L(10,60,Le),{result:{albums:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,picUrl:l,publishTime:i,artist:n}=e;Pe.push({id:a,name:s,cover:l,publishTime:F(i),artistId:n.id})}))}catch(a){I(P.ERROR,a.message)}He.set("mv",0==Pe.length)}else if("radio"==e){if(0!=Te.length)return;Ve.value=!0;try{const e=await L(1009,100,Le),{result:{djRadios:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,picUrl:l,playCount:i}=e;Te.push({name:s,id:a,image:l,playCount:i,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){I(P.ERROR,a.message)}He.set("radio",0==Te.length)}else if("playList"==e&&0==Ne.length){if(0!=Ne.length)return;Ve.value=!0;try{const e=await L(1e3,100,Le),{result:{playlists:a}}=e;a&&a.length>0&&a.forEach((e=>{const{id:a,name:s,coverImgUrl:l,playCount:i}=e;Ne.push({id:a,name:s,image:l,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){I(P.ERROR,a.message)}He.set("radio",0==Ne.length)}else if("lyric"==e){if(0!=Be.length)return;Ve.value=!0;try{const e=await L(1006,100,Le),{result:{songs:a}}=e;if(a&&a.length>0){const e=a.map((e=>e.id)).join(","),s=await U(e),{songs:l}=s;l.forEach((e=>{De.push(3),O(Be,e)})),a.forEach(((e,a)=>{const{lyrics:{txt:s}}=e;Be[a].lyric=s.split("\n")})),M(Be),ze.initLoveMusic(Oe)}}catch(a){I(P.ERROR,a.message)}He.set("lyric",0==Be.length)}Ve.value=!1};return(async()=>{Fe.value=!0;try{(await Promise.all([L(1,100,Le),L(100,100,Le)])).forEach((async(e,a)=>{if(0==a){const{result:{songs:a}}=e;if(a&&a.length>0){const e=a.map((e=>e.id)).join(","),s=await U(e),{songs:l}=s;l.forEach((e=>{O(Oe,e)})),M(Oe),ze.initLoveMusic(Oe)}}else if(1==a){const{result:{artists:a}}=e;if(a&&a.length>0){const e=a.map((e=>{const{id:a,name:s,picUrl:l,accountId:i,albumSize:n,mvSize:t}=e;return{id:a,name:s,avatar:l,score:i,albumSize:n,mvSize:t}}));Ae.push(...e)}He.set("singer",0==Ae.length)}}))}catch(e){I(P.ERROR,e.message)}Fe.value=!1})(),(s,l)=>{const i=a,n=b("No"),t=e,j=C("prevent");return u(),o(t,{"max-height":c(ke)},{default:r((()=>[m("div",ae,[p(d(c(K),{songs:c(Xe),"show-select":Je.value,"onUpdate:showSelect":l[0]||(l[0]=e=>Je.value=e),ref_key:"batch",ref:Ke},null,8,["songs","show-select"]),[[g,Je.value]]),p(m("div",{class:"result-singer",onClick:l[2]||(l[2]=e=>c(Re).push({name:"artist",query:{id:c(qe).id,score:c(qe).score}}))},[m("img",{src:c(qe).avatar,class:"left-singer"},null,8,se),m("div",le,[m("h4",ie,"歌手："+v(c(qe).name),1),m("p",ne,[m("span",null,"专辑："+v(c(qe).albumSize),1),m("span",null,"视频："+v(c(qe).mvSize),1)])]),d(c(N),{name:c(qe).isLove?"取消关注":"关注歌手",icon:c(qe).isLove?"":"","icon-style":c(qe).isLove?"color:#ff6a6a;":"",onClick:l[1]||(l[1]=h((e=>c(ze).addLove(c(qe),c(ze).loveSinger,c(ze).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[g,c(qe).name&&!Je.value]]),p(d(c(ee),{onGetActive:aa,active:"song",class:"search-tab"},{content:r((()=>[d(i,{label:"歌曲",name:"song"},{default:r((()=>[m("div",te,[m("div",oe,[d(c(D),{songs:c(Xe)},null,8,["songs"]),d(c(N),{icon:"",onClick:$e,name:"全部收藏"}),d(c(N),{icon:"",name:"批量操作",onClick:l[3]||(l[3]=e=>{var a;return null==(a=Ke.value)?void 0:a.openSelectBox()})})]),d(c(J),{songs:c(Xe),"page-size":c(Ze)},null,8,["songs","page-size"]),p(d(c(T),{"cur-page":We.value,"onUpdate:curPage":l[4]||(l[4]=e=>We.value=e),"page-size":c(Ze),total:c(Ye)},null,8,["cur-page","page-size","total"]),[[g,c(Ze)<c(Ye)]])])])),_:1}),d(i,{label:"视频",name:"video"},{default:r((()=>[d(c(Y),{"is-loading":Ve.value},null,8,["is-loading"]),p(d(c($),{text:"暂无搜索结果"},null,512),[[g,He.get("video")]]),p(d(c(X),{mvs:Me,"show-pagination":!0},null,8,["mvs"]),[[g,!He.get("video")]])])),_:1}),d(i,{label:"MV",name:"mv"},{default:r((()=>[d(c(Y),{"is-loading":Ve.value},null,8,["is-loading"]),p(d(n,{text:"暂无搜索结果"},null,512),[[g,He.get("mv")]]),p(d(c(X),{mvs:Ie,"show-pagination":!0},null,8,["mvs"]),[[g,!He.get("mv")]])])),_:1}),d(i,{label:"专辑",name:"album"},{default:r((()=>[d(c(Y),{"is-loading":Ve.value},null,8,["is-loading"]),p(d(c($),{text:"暂无搜索结果"},null,512),[[g,He.get("album")]]),p(d(c(W),{albums:Pe,"show-pagination":!0},null,8,["albums"]),[[g,!He.get("album")]])])),_:1}),d(i,{label:"电台",name:"radio"},{default:r((()=>[d(c(Y),{"is-loading":Ve.value},null,8,["is-loading"]),p(d(c($),{text:"暂无搜索结果"},null,512),[[g,He.get("radio")]]),p(d(c(Z),{playlists:Te,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[g,!He.get("radio")]])])),_:1}),d(i,{label:"歌单",name:"playList"},{default:r((()=>[d(c(Y),{"is-loading":Ve.value},null,8,["is-loading"]),p(d(c($),{text:"暂无搜索结果"},null,512),[[g,He.get("playList")]]),p(d(c(Z),{playlists:Ne,"show-pagination":!0},null,8,["playlists"]),[[g,!He.get("playList")]])])),_:1}),d(i,{label:"歌手",name:"singer"},{default:r((()=>[d(c(Y),{"is-loading":Ve.value},null,8,["is-loading"]),p(d(c($),{text:"暂无搜索结果"},null,512),[[g,He.get("singer")]]),p(d(c(Q),{"singer-list":Ae},null,8,["singer-list"]),[[g,!He.get("singer")]])])),_:1}),d(i,{label:"歌词",name:"lyric"},{default:r((()=>[d(c(Y),{"is-loading":Ve.value},null,8,["is-loading"]),p(d(c($),{text:"暂无搜索结果"},null,512),[[g,He.get("lyric")]]),p(m("div",re,[(u(!0),y(x,null,f(c(Xe),(e=>{var a;return u(),y("div",{class:"lyric",key:e.id},[m("div",ce,[p((u(),y("span",{class:"iconfont play-music",onClick:a=>c(ea)(e)},[_("")],8,ue)),[[j]]),p((u(),y("span",{class:"iconfont music-info",onClick:a=>c(A)(e)},[_("")],8,me)),[[j]]),p((u(),y("span",{class:"iconfont",onClick:a=>c(q)(e)},[_("")],8,pe)),[[j]]),p((u(),y("span",{class:"open-lyric",onClick:a=>{return s=c(Ge).get(e.id),void(De[s]=De[s]==Be[s].lyric.length?3:Be[s].lyric.length);var s}},[_(v(De[c(Ge).get(e.id)]==(null==(a=e.lyric)?void 0:a.length)?"收起歌词":"展开歌词"),1)],8,ge)),[[j]]),p((u(),y("span",{class:"copy-lyric",onClick:a=>c(B)(e.name+"\r\n"+e.lyric.join("\r\n"),"歌词复制成功！")},[_("复制歌词")],8,de)),[[j]])]),m("div",ve,[m("p",he,[m("span",null,v(e.name),1),p(m("span",ye,"",512),[[g,"10"==e.available||"1"==e.available]])]),(u(!0),y(x,null,f(e.lyric,((a,s)=>p((u(),y("p",{key:s},v(a.trim()),1)),[[g,s<De[c(Ge).get(e.id)]]]))),128))]),m("div",fe,[m("span",null,v(e.singer),1)]),m("div",_e,[m("span",null,v(e.album),1),m("span",null,v(c(G)(e.time)),1)])])})),128)),p(d(c(T),{class:"lyric-pagination","cur-page":We.value,"onUpdate:curPage":l[5]||(l[5]=e=>We.value=e),"page-size":c(Ze),total:c(Ye)},null,8,["cur-page","page-size","total"]),[[g,c(Ze)<c(Ye)]])],512),[[g,!He.get("lyric")]])])),_:1})])),_:1},512),[[g,!Je.value]])])])),_:1},8,["max-height"])}}}),[["__scopeId","data-v-1fd9268e"]]);export{xe as default};
