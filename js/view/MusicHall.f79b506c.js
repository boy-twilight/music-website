import{x as e,y as a}from"../element-plus/element-plus.70abbed3.js";import{G as l,ax as s,i as t,d as i,Z as n,c as o,U as u,O as r,u as v,o as c,P as p,F as m,a7 as d,M as h,V as y,z as g}from"../@vue/@vue.7ad02ad1.js";import{u as f,A as _,g as j,K as b,L as x,M as E,m as R,i as k,N as w,c as C,O,_ as S}from"../../static/index-a903482c.js";/* empty css                                                                                                                     */import{A as I}from"../index/index.565291c8.js";import{L as U}from"../index/index.9e14caf7.js";/* empty css                                                                                                                     */import{T as z}from"../index/index.e333f615.js";import{t as N}from"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.5f7505c4.js";import"../@element-plus/@element-plus.cef41b68.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.5953103e.js";import"../crypto-js/crypto-js.6e421324.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../vue-router/vue-router.53ff932e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../pinia/pinia.07d51cb2.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.787098c3.js";import"../lyc-storage/lyc-storage.12bb0aad.js";const T={class:"music-hall-container"},F=["infinite-scroll-disabled"],A=["infinite-scroll-disabled"],G=["infinite-scroll-disabled"],L=S(l({__name:"MusicHall",setup(l){s((e=>({"06b4dec2":v(S),"5b0ff324":v(M),df571d8e:v(L),"1e9e00d9":D.value,"336becf6":v(P),"4afdb77c":H.value})));const{fontColor:S,boxShadow:L,fontGray:M}=f(),K=_(),P=t((()=>K.isFullScreen?"76.3vh":"73.3vh")),D=i("0px"),H=i("none"),V=()=>{H.value="none",D.value="0"};let Z=0;const q=N((()=>{"block"!=H.value&&(H.value="block",D.value="6px"),Z&&clearTimeout(Z),Z=setTimeout((()=>{"none"!=H.value&&V()}),3e3)}),600,{leading:!0,trailing:!1}),B=g("firstLoading"),J=i(!1),Q=n([]),W=n([]),X=n([]),Y=i(18),$=i(0),ee=i(!1),ae=async()=>{try{const e=await w(100,X[$.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:t}=e;Q[$.value].push({name:a,id:l,image:s,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){R(k.ERROR,e.message)}0==$.value&&(W[$.value].push(...Q[$.value].slice(0,Y.value)),B.value=!1),J.value&&(J.value=!1)},le=()=>{ee.value=!0,Y.value+=12,Y.value<Q[$.value].length?setTimeout((()=>{W[$.value].push(...Q[$.value].slice(Y.value-12,Y.value)),ee.value=!1}),100):(J.value=!0,$.value<X.length?(Y.value=0,W[$.value].push(...Q[$.value].slice(W[$.value].length)),$.value++,ae(),ee.value=!1):(J.value=!1,R(k.INFO,"已经到底部啦！")))},se=n([]),te=n([]),ie=n([]),ne=i(18),oe=i(0),ue=i(!1),re=async()=>{try{const e=await C(100,ie[oe.value]),{playlists:a}=e;a.forEach((e=>{const{name:a,id:l,coverImgUrl:s,playCount:t}=e;se[oe.value].push({name:a,id:l,image:s,playCount:t,creator:{nickname:"",avatarUrl:""},description:"",tag:[]})}))}catch(e){R(k.ERROR,e.message)}0==oe.value&&(te[oe.value].push(...se[oe.value].slice(0,ne.value)),B.value=!1),J.value&&(J.value=!1)},ve=()=>{ue.value=!0,ne.value+=12,ne.value<se[$.value].length?setTimeout((()=>{te[oe.value].push(...se[oe.value].slice(ne.value-12,ne.value)),ue.value=!1}),100):(J.value=!0,oe.value<ie.length?(ne.value=0,te[oe.value].push(...se[oe.value].slice(te[oe.value].length)),oe.value++,re(),ue.value=!1):(J.value=!1,R(k.INFO,"已经到底部啦！")))},ce=n([]),pe=n([]),me=i(0),de=i(!1),he=()=>{de.value=!0,J.value=!0,me.value++,me.value<pe.length?(ye(),de.value=!1):(R(k.SUCCESS,"已经到达底部啦！"),J.value=!1)},ye=async()=>{try{const e=await O(pe[me.value].id),{data:{playlist:a}}=e;a.forEach((e=>{const{id:a,name:l,cover:s,playCount:t}=e;ce[me.value].push({id:a,name:l,image:s,playCount:t,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(e){R(k.ERROR,e.message)}0==me.value&&(B.value=!1),J.value&&(J.value=!1)},ge=e=>{V(),"rec"==e&&0==se[0].length?(B.value=!0,re()):"style"==e&&0==ce[0].length&&(B.value=!0,ye())};return j((async()=>{try{(await Promise.all([b(),x(),E()])).forEach(((e,a)=>{if(0==a){const{tags:a}=e;X.push(...a.map((e=>e.name))),X.forEach((()=>{Q.push([]),W.push([])}))}else if(1==a){const{sub:a}=e;ie.push(...a.map((e=>e.name))),ie.forEach((()=>{se.push([]),te.push([])}))}else if(2==a){const{data:a}=e;a.forEach((e=>{const{tagId:a,tagName:l}=e;pe.push({id:a,name:l}),ce.push([])}))}}))}catch(e){R(k.ERROR,e.message)}await ae(),B.value=!1}),B),(l,s)=>{const t=e,i=a;return c(),o("div",T,[u(v(z),{active:"top",onGetActive:ge},{content:r((()=>[u(t,{label:"精选歌单",name:"top"},{default:r((()=>[p((c(),o("div",{class:"container scroll-container",onScroll:s[0]||(s[0]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ee.value,style:{overflow:"auto"}},[(c(!0),o(m,null,d(W,((e,a)=>p((c(),h(v(I),{key:X[a],title:X[a],playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,F)),[[i,le]])])),_:1}),u(t,{label:"网友推荐",name:"rec"},{default:r((()=>[p((c(),o("div",{class:"container scroll-container",onScroll:s[1]||(s[1]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":ue.value,style:{overflow:"auto"}},[(c(!0),o(m,null,d(te,((e,a)=>p((c(),h(v(I),{key:ie[a],title:ie[a],playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,A)),[[i,ve]])])),_:1}),u(t,{label:"浪漫曲风",name:"style"},{default:r((()=>[p((c(),o("div",{class:"container scroll-container",onScroll:s[2]||(s[2]=e=>v(q)()),"infinite-scroll-distance":"2","infinite-scroll-immediate":!1,"infinite-scroll-disabled":de.value,style:{overflow:"auto"}},[(c(!0),o(m,null,d(ce,((e,a)=>p((c(),h(v(I),{key:pe[a].id,title:pe[a].name,playlists:e},null,8,["title","playlists"])),[[y,e.length>0]]))),128)),u(v(U),{"is-loading":J.value},null,8,["is-loading"])],40,G)),[[i,he]])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-6083715b"]]);export{L as default};
