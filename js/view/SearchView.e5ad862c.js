import{x as a}from"../element-plus/element-plus.f4dce189.js";import{G as e,ax as s,i as l,r as i,Z as n,c as t,P as o,V as r,U as c,u,a as m,T as p,a2 as g,O as d,z as v,o as h,F as y,a7 as f,S as _,n as b,aq as j}from"../@vue/@vue.59fec093.js";import{b as x,u as C}from"../vue-router/vue-router.10a7fca4.js";import{s as R}from"../pinia/pinia.81428a33.js";import{v as k,g as w,a as z,u as E,b as S,w as L,e as T,d as O,x as I,y as M,i as U,j as P,C as A,P as N,z as F,A as G,t as q,B as V,_ as B}from"../../assets/index-831d6614.js";import{P as D,_ as H}from"../index.vue_vue_type_style_index_0_scoped_2dc764e5_lang/index.vue_vue_type_style_index_0_scoped_2dc764e5_lang.ce8305d1.js";import{T as J}from"../Tab/Tab.63db5902.js";import{O as K}from"../index/index.c5745a43.js";import{A as W}from"../index/index.a6f5eda0.js";import{A as Z}from"../index/index.2d322a4f.js";import{S as Q}from"../index/index.8e8d3f1e.js";import{A as X}from"../index/index.25798000.js";import{L as Y}from"../Loading/Loading.24f30fa2.js";import{_ as $}from"../NoSearch/NoSearch.4c67f0f6.js";import"../lodash-es/lodash-es.3125e237.js";import"../@vueuse/@vueuse.c2bb539f.js";import"../@element-plus/@element-plus.189e73a2.js";import"../@popperjs/@popperjs.b78c3215.js";import"../@ctrl/@ctrl.91de2ec7.js";import"../dayjs/dayjs.c1293ab3.js";import"../async-validator/async-validator.cf877c1f.js";import"../memoize-one/memoize-one.63ab667a.js";import"../escape-html/escape-html.1935ddb3.js";import"../normalize-wheel-es/normalize-wheel-es.3222b0a2.js";import"../@floating-ui/@floating-ui.333ef71e.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../axios/axios.d4208f68.js";import"../nprogress/nprogress.9249ff62.js";/* empty css                                                                                                                     */const aa={class:"search-container scroll-container"},ea=["src"],sa={class:"right-singer"},la={class:"singer-name"},ia={class:"singer-info"},na={class:"song"},ta={class:"header-operation"},oa={class:"lyric-container"},ra={class:"lyric-operation"},ca=["onClick"],ua=["onClick"],ma=["onClick"],pa=["onClick"],ga=["onClick"],da={class:"lyric-left"},va={class:"song-name"},ha={class:"is-vip iconfont"},ya={class:"lyric-center"},fa={class:"lyric-right"},_a=B(e({__name:"SearchView",setup(e){s((a=>({"5a768cd0":u(ba),cbe61840:u(Ca),f4ce3264:u(xa),"0f387945":u(ja),"49b5e9b2":u(Ra),"7af4995d":u(ka)})));const B=k(),{bgMode:_a}=R(B),ba=v("fontGray"),ja=w().get("shadow"),xa=w().get("fontColor"),Ca=w().get("themeColor"),Ra=l((()=>"skin"==_a.value?"rgba(220, 220, 220, 0.1)":"#ffffff"==(null==xa?void 0:xa.value)?"rgba(30, 30, 30, 0.2)":"rgba(220, 220, 220, 0.25)")),ka=l((()=>"skin"==_a.value?"rgba(230, 230, 230, 0.25)":"#ffffff"==(null==xa?void 0:xa.value)?"rgba(30, 30, 30, 1)":"rgba(220, 220, 220, 0.8)")),wa=C(),za=z(),{loveMusicId:Ea,loveSongs:Sa}=R(za),La=i(!1),Ta=a=>{La.value=a},Oa=()=>{Va.forEach((a=>{a.isLove=!0;null==Ea.value.get(a.id)&&Sa.value.push(a)}))},Ia=E(),{songListId:Ma,songList:Ua,current:Pa,playProcess:Aa,playTime:Na,isPlay:Fa}=R(Ia),Ga=x().query.keyWord+"",qa=i("song"),Va=n([]),Ba=l((()=>new Map(Va.map(((a,e)=>[a.id,e]))))),Da=n([]),Ha=n([]),Ja=n([]),Ka=n([]),Wa=n([]),Za=n([]),Qa=l((()=>Za.length>0?Za[0]:{name:"",avatar:"",id:"",score:"",albumSize:"",mvSize:""})),Xa=n([]),Ya=l((()=>new Map(Xa.map(((a,e)=>[a.id,e]))))),$a=i(!1),ae=v("firstLoading"),ee=n([!1,!1,!1,!1,!1,!1,!1]),se=n([]),le=i(1),ie=l((()=>"song"==qa.value?30:10)),ne=l((()=>"song"==qa.value?Va:Xa)),te=l((()=>ne.value.slice((le.value-1)*ie.value,le.value*ie.value))),oe=l((()=>"song"==qa.value?Va.length:Xa.length)),re=a=>{le.value=a},ce=a=>{qa.value=a,"video"==a&&0==Da.length?S((async()=>{try{const a=await L(1014,100,Ga),{result:{videos:e}}=a;e&&e.length>0&&e.forEach((a=>{const{vid:e,title:s,coverUrl:l,creator:i,playTime:n}=a;Da.push({id:e,name:s,image:l,artist:i[0].userName,playCount:n})}))}catch(a){T(O.ERROR,a.message)}setTimeout((()=>{$a.value=!1}),500),ee[0]=0==Da.length}),$a):"mv"==a&&0==Ha.length?S((async()=>{try{const a=await L(1004,100,Ga),{result:{mvs:e}}=a;e&&0!=e.length&&e.forEach((a=>{const{id:e,name:s,cover:l,artistName:i,playCount:n}=a;Ha.push({id:e,name:s,image:l,artist:i,playCount:n})}))}catch(a){T(O.ERROR,a.message)}setTimeout((()=>{$a.value=!1}),500),ee[1]=0==Ha.length}),$a):"album"==a&&0==Ja.length?S((async()=>{try{const a=await L(10,60,Ga),{result:{albums:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,publishTime:i,artist:n}=a;Ja.push({id:e,name:s,cover:l,publishTime:I(i),artistId:n.id})}))}catch(a){T(O.ERROR,a.message)}setTimeout((()=>{$a.value=!1}),500),ee[2]=0==Ja.length}),$a):"radio"==a&&0==Wa.length?S((async()=>{try{const a=await L(1009,100,Ga),{result:{djRadios:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,playCount:i}=a;Wa.push({name:s,id:e,image:l,playCount:i,creator:{nickname:"",avatarUrl:""},tag:[],description:""})}))}catch(a){T(O.ERROR,a.message)}setTimeout((()=>{$a.value=!1}),500),ee[3]=0==Wa.length}),$a):"playList"==a&&0==Ka.length?S((async()=>{try{const a=await L(1e3,100,Ga),{result:{playlists:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,coverImgUrl:l,playCount:i}=a;Ka.push({id:e,name:s,image:l,playCount:i,description:"",tag:[],creator:{nickname:"",avatarUrl:""}})}))}catch(a){T(O.ERROR,a.message)}setTimeout((()=>{$a.value=!1}),500),ee[4]=0==Ka.length}),$a):"lyric"==a&&0==Xa.length&&S((async()=>{try{const a=await L(1006,100,Ga),{result:{songs:e}}=a;if(e&&e.length>0){const a=e.map((a=>a.id)).join(","),s=await M(a),{songs:l}=s;l.forEach((a=>{se.push(3),U([],Xa,a)})),e.forEach(((a,e)=>{const{lyrics:{txt:s}}=a;Xa[e].lyric=s.split("\n")})),P(a,Xa),za.initLoveMusic(Va)}}catch(a){T(O.ERROR,a.message)}setTimeout((()=>{$a.value=!1}),500),ee[6]=0==Xa.length}),$a)};return S((async()=>{try{const a=await L(1,100,Ga),{result:{songs:e}}=a;if(e&&e.length>0){const a=e.map((a=>a.id)).join(","),s=await M(a),{songs:l}=s;l.forEach((a=>{U([],Va,a)})),P(a,Va),za.initLoveMusic(Va)}}catch(a){T(O.ERROR,a.message)}try{const a=await L(100,100,Ga),{result:{artists:e}}=a;e&&e.length>0&&e.forEach((a=>{const{id:e,name:s,picUrl:l,accountId:i,albumSize:n,mvSize:t}=a;Za.push({id:e,name:s,avatar:l,score:i,albumSize:n,mvSize:t})})),ee[5]=0==Za.length}catch(a){T(O.ERROR,a.message)}ae.value=!1}),ae),(e,s)=>{const l=a,i=j("prevent");return h(),t("div",aa,[o(c(u(K),{songs:u(te),"song-id-mapper":u(Ba),onCloseSelect:Ta},null,8,["songs","song-id-mapper"]),[[r,La.value]]),o(m("div",{class:"result-singer",onClick:s[1]||(s[1]=a=>u(wa).push({name:"artist",query:{id:u(Qa).id,score:u(Qa).score}}))},[m("img",{src:u(Qa).avatar,class:"left-singer"},null,8,ea),m("div",sa,[m("h4",la,"歌手："+p(u(Qa).name),1),m("p",ia,[m("span",null,"专辑："+p(u(Qa).albumSize),1),m("span",null,"视频："+p(u(Qa).mvSize),1)])]),c(u(A),{name:u(Qa).isLove?"取消关注":"关注歌手",icon:u(Qa).isLove?"":"","icon-style":u(Qa).isLove?"color:#ff6a6a;":"",onClick:s[0]||(s[0]=g((a=>u(za).addLove(u(Qa),u(za).loveSinger,u(za).loveSingerId)),["stop"]))},null,8,["name","icon","icon-style"])],512),[[r,u(Qa).name]]),o(c(J,{onGetActive:ce,active:"song",class:"search-tab"},{content:d((()=>[c(l,{label:"歌曲",name:"song"},{default:d((()=>[m("div",na,[m("div",ta,[c(u(D),{songs:u(te)},null,8,["songs"]),c(u(A),{icon:"",onClick:Oa,name:"全部收藏"}),c(u(A),{icon:"",name:"批量操作",onClick:s[2]||(s[2]=a=>La.value=!La.value)})]),c(u(H),{songs:u(te),"page-size":u(ie),"song-id-mapper":u(Ba)},null,8,["songs","page-size","song-id-mapper"]),o(c(N,{"cur-page":le.value,"page-size":u(ie),total:u(oe),onPageChange:re},null,8,["cur-page","page-size","total"]),[[r,u(ie)<u(oe)]])])])),_:1}),c(l,{label:"视频",name:"video"},{default:d((()=>[c(Y,{"is-loading":$a.value},null,8,["is-loading"]),o(c($,{text:"暂无搜索结果"},null,512),[[r,ee[0]]]),o(c(u(X),{mvs:Da,"show-pagination":!0},null,8,["mvs"]),[[r,!ee[0]]])])),_:1}),c(l,{label:"MV",name:"mv"},{default:d((()=>[c(Y,{"is-loading":$a.value},null,8,["is-loading"]),o(c($,{text:"暂无搜索结果"},null,512),[[r,ee[1]]]),o(c(u(X),{mvs:Ha,"show-pagination":!0},null,8,["mvs"]),[[r,!ee[1]]])])),_:1}),c(l,{label:"专辑",name:"album"},{default:d((()=>[c(Y,{"is-loading":$a.value},null,8,["is-loading"]),o(c($,{text:"暂无搜索结果"},null,512),[[r,ee[2]]]),o(c(u(W),{albums:Ja,"show-pagination":!0},null,8,["albums"]),[[r,!ee[2]]])])),_:1}),c(l,{label:"电台",name:"radio"},{default:d((()=>[c(Y,{"is-loading":$a.value},null,8,["is-loading"]),o(c($,{text:"暂无搜索结果"},null,512),[[r,ee[3]]]),o(c(u(Z),{playlists:Wa,"show-pagination":!0,type:"radio"},null,8,["playlists"]),[[r,!ee[3]]])])),_:1}),c(l,{label:"歌单",name:"playList"},{default:d((()=>[c(Y,{"is-loading":$a.value},null,8,["is-loading"]),o(c($,{text:"暂无搜索结果"},null,512),[[r,ee[4]]]),o(c(u(Z),{playlists:Ka,"show-pagination":!0},null,8,["playlists"]),[[r,!ee[4]]])])),_:1}),c(l,{label:"歌手",name:"singer"},{default:d((()=>[c(Y,{"is-loading":$a.value},null,8,["is-loading"]),o(c($,{text:"暂无搜索结果"},null,512),[[r,ee[5]]]),o(c(u(Q),{"singer-list":Za},null,8,["singer-list"]),[[r,!ee[5]]])])),_:1}),c(l,{label:"歌词",name:"lyric"},{default:d((()=>[c(Y,{"is-loading":$a.value},null,8,["is-loading"]),o(c($,{text:"暂无搜索结果"},null,512),[[r,ee[6]]]),m("div",oa,[(h(!0),t(y,null,f(u(te),(a=>{var e;return h(),t("div",{class:"lyric",key:a.id},[m("div",ra,[o((h(),t("span",{class:"iconfont play-music",onClick:e=>(async a=>{if("0"==a.available||"8"==a.available){const e=Ma.value.get(a.id);null==e?(za.addRecord(a,za.songRecord,za.loveMusicId),0==Pa.value?(Fa&&(Fa.value=!1),Aa.value=0,Na.value=0,Ua.value.unshift(a),await b(),Fa.value=!0):(Ua.value.unshift(a),Pa.value=0)):Pa.value!=e?Pa.value=e:Fa.value=!0}else"1"==a.available?T(O.INFO,"此歌曲为vip专属"):"10"==a.available&&T(O.INFO,"此歌曲尚未拥有版权，请切换其它歌曲")})(a)},[_("")],8,ca)),[[i]]),o((h(),t("span",{class:"iconfont music-info",onClick:e=>u(F)(a)},[_("")],8,ua)),[[i]]),o((h(),t("span",{class:"iconfont",onClick:e=>u(G)(a)},[_("")],8,ma)),[[i]]),o((h(),t("span",{class:"open-lyric",onClick:e=>{return s=u(Ya).get(a.id),void(se[s]=se[s]==Xa[s].lyric.length?3:Xa[s].lyric.length);var s}},[_(p(se[u(Ya).get(a.id)]==(null==(e=a.lyric)?void 0:e.length)?"收起歌词":"展开歌词"),1)],8,pa)),[[i]]),o((h(),t("span",{class:"copy-lyric",onClick:e=>u(q)(a.name+"\r\n"+a.lyric.join("\r\n"),"歌词复制成功！")},[_("复制歌词")],8,ga)),[[i]])]),m("div",da,[m("p",va,[m("span",null,p(a.name),1),o(m("span",ha,"",512),[[r,"10"==a.available||"1"==a.available]])]),(h(!0),t(y,null,f(a.lyric,((e,s)=>o((h(),t("p",{key:s},p(e.trim()),1)),[[r,s<se[u(Ya).get(a.id)]]]))),128))]),m("div",ya,[m("span",null,p(a.singer),1)]),m("div",fa,[m("span",null,p(a.album),1),m("span",null,p(u(V)(a.time)),1)])])})),128)),o(c(N,{class:"lyric-pagination","cur-page":le.value,"page-size":u(ie),total:u(oe),onPageChange:re},null,8,["cur-page","page-size","total"]),[[r,u(ie)<u(oe)]])])])),_:1})])),_:1},512),[[r,!La.value]])])}}}),[["__scopeId","data-v-3aeb3767"]]);export{_a as default};
