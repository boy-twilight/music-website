import{t as e,g as t,a,b as o,C as l,S as n,s,B as u,D as i,E as r,F as c,z as d,e as V,c as m,o as p,G as v,H as f,I as y,J as h,_ as N}from"../../static/index-a47c3a7a.js";import{D as g}from"../dplayer/dplayer.87601a3d.js";/* empty css                                                                                                                     */import{A as k}from"../index/index.1a5275e8.js";import"../hotkeys-js/hotkeys-js.e364e5e1.js";import"../nprogress/nprogress.204a1a2a.js";import"../lodash-es/lodash-es.8b477e85.js";/* empty css                                   */const E=e=>(Vue.pushScopeId("data-v-dac8a296"),e=e(),Vue.popScopeId(),e),w={class:"video-container scroll-container"},C={class:"players-container"},_={class:"recommend-container"},x={class:"content"},S={class:"mask"},b=["onClick"],D=E((()=>Vue.createElementVNode("div",{class:"players"},null,-1))),R={class:"detail"},j={class:"title"},T={class:"artist-info"},B={class:"operation"},I={class:"comment-area"},L=E((()=>Vue.createElementVNode("h4",{class:"title"},"全部评论",-1))),q=E((()=>Vue.createElementVNode("span",{class:"iconfont_1"}," ",-1))),F=N(Vue.defineComponent({__name:"VideoPlayView",setup(N){Vue.useCssVars((e=>({"990bd844":Vue.unref(F),"992b170c":Vue.unref(O),"46fcaaf0":Vue.unref(U),"4598d68c":Vue.unref(z),"3d19a655":Vue.unref(P),"285168d0":Vue.unref(A)})));const E=e(),F=t().get("fontColor"),O=t().get("fontBlack"),P=t().get("shadow"),A=t().get("themeColor"),U=Vue.inject("fontGray"),z=Vue.computed((()=>E.isFullScreen?"695px":"555px")),G=a(),Z=Vue.ref(),H=VueRouter.useRoute(),J=VueRouter.useRouter(),K=H.query.id+"",M=Vue.reactive({id:K,name:"",image:"",artist:"",playCount:"",url:"",time:"",publishTime:"",available:""}),Q=Vue.reactive([]),W=Vue.computed((()=>[M,...Q])),X=Vue.inject("firstLoading"),Y=Vue.ref(!1),$=Vue.reactive([]),ee=Vue.ref(!1),te=()=>{s("我在https://www.liyinchao.cloud/#"+H.fullPath+"观看"+M.name+",快来和我一起观看把！")};return o((async()=>{if(/.*[A-Z]+.*/.test(K))try{(await Promise.all([v(K),f(K),y(K),h(K,1e3)])).forEach(((e,t)=>{if(0==t){const{data:{title:t,coverUrl:a,publishTime:o,playTime:l,creator:n}}=e;M.name=t,M.image=a,M.playCount=l,M.publishTime=d(o),M.artist=n.nickname}else if(1==t){const{urls:t}=e;t?M.url=t[0].url:V(m.INFO,"此视频暂无播放资源，请切换下一个。")}else if(2==t){const{data:t}=e;t.forEach((e=>{const{title:t,coverUrl:a,vid:o,playTime:l,creator:n}=e;Q.push({id:o,name:t,image:a,playCount:l,artist:n[0].userName})}))}else if(3==t){const{comments:t,hotComments:a}=e;p(a,$),p(t,$)}}))}catch(e){V(m.ERROR,e.message)}else try{(await Promise.all([u(K),i(K),r(K),c(K,1e3)])).forEach(((e,t)=>{if(0==t){const{data:{name:t,artistName:a,cover:o,playCount:l,duration:n,publishTime:s}}=e;M.name=t,M.playCount=l,M.image=o,M.artist=a,M.time=n,M.publishTime=d(s)}else if(1==t){const{data:{url:t,fee:a}}=e;t?(M.url=t,M.available=a):V(m.INFO,"此视频暂无播放资源，请切换下一个。")}else if(2==t){const{mvs:t}=e;t&&t.forEach((e=>{const{id:t,cover:a,name:o,artistName:l,playCount:n}=e;Q.push({id:t,image:a,name:o,artist:l,playCount:n})}))}else if(3==t){const{comments:t,hotComments:a}=e;p(a,$),p(t,$)}}))}catch(e){V(m.ERROR,e.message)}G.addRecord(M,G.videoRecord,G.videoRecordId),G.initLoveStatus(M,G.loveVideoId),(async()=>{await Vue.nextTick(),Z.value=new g({container:document.querySelector(".players"),video:{url:M.url,thumbnails:M.image,type:"video/mp4",pic:M.image},autoplay:!1,loop:!1,hotkey:!0,theme:null==A?void 0:A.value,chromecast:!0,lang:"zh-cn",screenshot:!0,preload:"auto",volume:.9,playbackSpeed:[.75,1,1.25,1.5,1.75,2],contextmenu:[{text:"下载",click:()=>{G.addVideoDownload(M)}},{text:"收藏",click:()=>{G.addLove(M,G.loveVideo,G.loveVideoId)}},{text:"分享",click:()=>{te()}}]}),document.querySelector(".dplayer-video").onended=()=>{Y.value=!0}})(),X.value=!1}),X),Vue.onBeforeUnmount((()=>{var e;document.querySelector(".dplayer-video").onended=null,null==(e=Z.value)||e.destroy()})),(e,t)=>{const a=Vue.resolveComponent("el-image"),o=Vue.resolveDirective("prevent");return Vue.openBlock(),Vue.createElementBlock("div",w,[Vue.createElementVNode("div",C,[Vue.createVNode(Vue.Transition,{name:"show"},{default:Vue.withCtx((()=>[Vue.withDirectives(Vue.createElementVNode("div",_,[Vue.withDirectives(Vue.createElementVNode("h4",null,"相关推荐",512),[[Vue.vShow,Vue.unref(W).length>1]]),Vue.createElementVNode("div",x,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(W),((e,t)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"recommend-video",key:e.id},[Vue.createVNode(a,{src:e.image,class:"image"},null,8,["src"]),Vue.createElementVNode("div",S,[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("span",{class:"iconfont play",onClick:a=>((e,t)=>{0==e?(Y.value=!1,document.querySelector(".dplayer-video").play()):J.push({name:"video",query:{id:t}})})(t,e.id)},[Vue.createTextVNode("")],8,b)),[[o]])])])))),128))])],512),[[Vue.vShow,Y.value]])])),_:1}),D]),Vue.createElementVNode("div",R,[Vue.createElementVNode("p",j,Vue.toDisplayString(M.name),1),Vue.createElementVNode("div",T,[Vue.createElementVNode("span",null,Vue.toDisplayString(/.*[A-Z]+.*/.test(K)?"创作者："+M.artist:"演唱："+M.artist),1),Vue.createElementVNode("span",null,Vue.toDisplayString(M.playCount)+"次观看",1),Vue.createElementVNode("span",null,"发布时间："+Vue.toDisplayString(M.publishTime),1)]),Vue.withDirectives(Vue.createElementVNode("div",B,[Vue.createVNode(Vue.unref(l),{name:M.isLove?"取消收藏":"收藏",icon:M.isLove?"":"","icon-style":M.isLove?"color:#ff6a6a;":"",onClick:t[0]||(t[0]=e=>Vue.unref(G).addLove(M,Vue.unref(G).loveVideo,Vue.unref(G).loveVideoId)),class:"operate"},null,8,["name","icon","icon-style"]),Vue.createVNode(Vue.unref(l),{name:"下载",onClick:t[1]||(t[1]=e=>Vue.unref(G).addVideoDownload(M)),icon:"",class:"operate"}),Vue.createVNode(Vue.unref(l),{name:"分享",icon:"",onClick:te,class:"operate"}),Vue.createVNode(Vue.unref(l),{name:"评论",icon:"",onClick:t[2]||(t[2]=e=>ee.value=!0),class:"operate"})],512),[[Vue.vShow,!ee.value]])]),Vue.withDirectives(Vue.createVNode(Vue.unref(k),{mvs:Q,title:"相关推荐"},null,8,["mvs"]),[[Vue.vShow,!ee.value&&Q.length>0]]),Vue.withDirectives(Vue.createElementVNode("div",I,[L,Vue.createElementVNode("button",{class:"exit",onClick:t[3]||(t[3]=e=>ee.value=!1)},[q,Vue.createTextVNode(" 退出 ")]),Vue.createVNode(Vue.unref(n),{comments:$},null,8,["comments"])],512),[[Vue.vShow,ee.value]])])}}}),[["__scopeId","data-v-dac8a296"]]);export{F as default};
