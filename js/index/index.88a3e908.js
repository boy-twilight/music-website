import{t as e,g as u,_ as a,a as o,C as n,P as l,e as t,c as r,u as s}from"../../static/index-a47c3a7a.js";import{P as c,_ as i}from"../index.vue_vue_type_style_index_0_scoped_2dc764e5_lang/index.vue_vue_type_style_index_0_scoped_2dc764e5_lang.fc383066.js";import{S as V}from"./index.1c83a27b.js";const d=e=>(Vue.pushScopeId("data-v-2b1a5ea0"),e=e(),Vue.popScopeId(),e),p={class:"sort-btn"},v=[d((()=>Vue.createElementVNode("span",{class:"iconfont"},"",-1))),d((()=>Vue.createElementVNode("span",null," 排序",-1)))],m=a(Vue.defineComponent({__name:"index",emits:["getSortChoice"],setup(a,{emit:o}){Vue.useCssVars((e=>({f1298b02:Vue.unref(l),d4c61bf4:Vue.unref(s),"5af5d362":Vue.unref(r)})));const n=e(),l=u().get("fontColor"),t=u().get("background"),r=u().get("themeColor"),s=Vue.computed((()=>{var e;return"color"==n.bgMode?null==(e=u().get("searchBg"))?void 0:e.value:"rgba(210,210,210,0.2)"})),c=Vue.computed((()=>"color"==n.bgMode?"#ffffff"==l.value?"dropdown-dark":"dropdown-light":"dropdown-skin")),i=Vue.reactive(["歌曲排序","歌手排序","专辑排序","时长排序"]),V=Vue.reactive([!1,!1,!1,!1]),d=Vue.ref(-1),m=Vue.computed((()=>V.map(((e,u)=>u==d.value)))),f=e=>{"歌曲排序"==e?d.value=m.value[0]?-1:0:"歌手排序"==e?d.value=m.value[1]?-1:1:"专辑排序"==e?d.value=m.value[2]?-1:2:"时长排序"==e&&(d.value=m.value[3]?-1:3),-1==d.value?o("getSortChoice",m.value,!0):o("getSortChoice",m.value,!1)},g=()=>{-1==d.value&&(d.value=0,o("getSortChoice",m.value,!1))};return(e,u)=>{const a=Vue.resolveComponent("el-dropdown-item"),o=Vue.resolveComponent("el-dropdown-menu"),n=Vue.resolveComponent("el-dropdown"),r=Vue.resolveDirective("prevent");return Vue.openBlock(),Vue.createElementBlock("div",p,[Vue.createVNode(n,{trigger:"click",onCommand:f,"popper-class":`dropdown sort-drop ${Vue.unref(c)}`},{dropdown:Vue.withCtx((()=>[Vue.createVNode(o,{style:Vue.normalizeStyle({color:Vue.unref(l),background:Vue.unref(t)})},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(i,((e,u)=>(Vue.openBlock(),Vue.createBlock(a,{key:e,command:e},{default:Vue.withCtx((()=>[Vue.createElementVNode("span",{class:Vue.normalizeClass({"is-choose":Vue.unref(m)[u]})},Vue.toDisplayString(e),3)])),_:2},1032,["command"])))),128))])),_:1},8,["style"])])),default:Vue.withCtx((()=>[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{class:"sort",onClick:g},v)),[[r]])])),_:1},8,["popper-class"])])}}}),[["__scopeId","data-v-2b1a5ea0"]]),f={class:"user-container"},g={class:"top-operation"},C=a(Vue.defineComponent({__name:"index",props:{pageName:null},emits:["openSelect"],setup(e,{emit:u}){const a=e,s=o(),{musicDownload:d,loveSongs:p,songRecord:v}=Pinia.storeToRefs(s),C=Vue.computed((()=>{let e=Vue.reactive([]);return e="LoveView"==a.pageName?p.value:"RecentPlayView"==a.pageName?v.value:d.value,e})),h=Vue.computed((()=>new Map(C.value.map(((e,u)=>[e.id,u]))))),_=Vue.ref(1),w=Vue.ref(40),N=Vue.computed((()=>C.value.slice((_.value-1)*w.value,_.value*w.value).filter((e=>e.name.includes(x.value)||e.album.includes(x.value)||e.singer.includes(x.value))))),S=Vue.computed((()=>C.value.length)),k=e=>{_.value=e},y=Vue.computed((()=>"LoveView"==a.pageName?"清空全部收藏":"RecentPlayView"==a.pageName?"清空播放记录":"清空下载记录")),x=Vue.ref(""),E=e=>{x.value=e},b=Vue.reactive([!1,!1,!1,!1]),B=Vue.ref(!1),P=(e,u)=>{for(let a=0;a<b.length;a++)b[a]=e[a];u&&(B.value=u)},I=()=>{"LoveView"==a.pageName?p.value.splice(0):"RecentPlayView"==a.pageName?v.value.splice(0):d.value.splice(0),t(r.SUCCESS,"已清空全部下载记录！")};return(e,a)=>(Vue.openBlock(),Vue.createElementBlock("div",f,[Vue.createElementVNode("div",g,[Vue.createVNode(Vue.unref(c),{songs:Vue.unref(N)},null,8,["songs"]),Vue.createVNode(Vue.unref(n),{icon:"",name:Vue.unref(y),onClick:I},null,8,["name"]),Vue.createVNode(Vue.unref(n),{icon:"",name:"批量操作",onClick:a[0]||(a[0]=e=>u("openSelect",!0))}),Vue.createVNode(Vue.unref(V),{onGetContent:E}),Vue.createVNode(Vue.unref(m),{onGetSortChoice:P})]),Vue.createVNode(Vue.unref(i),{songs:Vue.unref(N),"song-id-mapper":Vue.unref(h),sort:b,"page-size":w.value,"is-cancel-sort":B.value},null,8,["songs","song-id-mapper","sort","page-size","is-cancel-sort"]),Vue.withDirectives(Vue.createVNode(Vue.unref(l),{"cur-page":_.value,"page-size":w.value,total:Vue.unref(S),onPageChange:k},null,8,["cur-page","page-size","total"]),[[Vue.vShow,w.value<Vue.unref(S)]])]))}}),[["__scopeId","data-v-f7009bdf"]]),h={class:"batch-container"},_={class:"operation-select"},w=a(Vue.defineComponent({__name:"index",props:{pageName:null},emits:["closeSelect"],setup(e,{emit:a}){const l=e;Vue.useCssVars((e=>({"065e5764":Vue.unref(c)})));const c=u().get("themeColor"),V=s(),{isPlay:d,songList:p,songListId:v,playProcess:m,playTime:f,current:g}=Pinia.storeToRefs(V),C=o(),{songRecord:w,musicDownload:N,loveSongs:S}=Pinia.storeToRefs(C),k=Vue.inject("hideScroll"),y=Vue.computed((()=>"LoveView"==l.pageName?S.value:"RecentPlayView"==l.pageName?w.value:N.value)),x=Vue.computed((()=>new Map(y.value.map(((e,u)=>[e.id,u]))))),E=Vue.reactive([]),b=e=>{0!=E.length&&E.splice(0),E.push(...e)},B=async()=>{E.length>0?(d.value=!1,m.value=0,f.value=0,await Vue.nextTick(),E.forEach((e=>{null==v.value.get(e.id)&&p.value.unshift(e)})),g.value=v.value.get(E[0].id),d.value=!0,t(r.SUCCESS,"已添加到播放列表！")):t(r.INFO,"请添加歌曲！")},P=()=>{E.forEach((e=>{C.addMuiscDownload(e)}))},I=()=>{if(E.length>0){const e=E.map((e=>e.id)),u=y.value.filter((u=>!e.includes(u.id)));y.value.splice(0),y.value.push(...u),t(r.SUCCESS,"已清除选中的歌曲！")}else t(r.INFO,"请添加歌曲！")},R=()=>{k(),a("closeSelect",!1)};return(e,u)=>(Vue.openBlock(),Vue.createElementBlock("div",h,[Vue.createElementVNode("div",_,[Vue.createVNode(Vue.unref(n),{icon:"",name:"播放",class:"play",onClick:B}),Vue.createVNode(Vue.unref(n),{icon:"",onClick:I,name:"删除"}),Vue.createVNode(Vue.unref(n),{icon:"󰌄",onClick:P,name:"下载"}),Vue.createVNode(Vue.unref(n),{icon:"",name:"取消操作",onClick:R})]),Vue.createVNode(Vue.unref(i),{songs:Vue.unref(y),"song-id-mapper":Vue.unref(x),showSelect:!0,"show-header":!1,onGetSelectItems:b},null,8,["songs","song-id-mapper"])]))}}),[["__scopeId","data-v-2dc764e5"]]);export{w as U,C as a};
